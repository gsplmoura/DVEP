<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="S.P.L.M., Gustavo">
<meta name="dcterms.date" content="2025-05-20">

<title>Main outcomes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Results_main_outcomes_files/libs/clipboard/clipboard.min.js"></script>
<script src="Results_main_outcomes_files/libs/quarto-html/quarto.js"></script>
<script src="Results_main_outcomes_files/libs/quarto-html/popper.min.js"></script>
<script src="Results_main_outcomes_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Results_main_outcomes_files/libs/quarto-html/anchor.min.js"></script>
<link href="Results_main_outcomes_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Results_main_outcomes_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Results_main_outcomes_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Results_main_outcomes_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Results_main_outcomes_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul class="collapse">
  <li><a href="#getting-started" id="toc-getting-started" class="nav-link active" data-scroll-target="#getting-started">Getting started</a>
  <ul class="collapse">
  <li><a href="#load-data" id="toc-load-data" class="nav-link" data-scroll-target="#load-data">Load data</a></li>
  <li><a href="#variables-of-interest" id="toc-variables-of-interest" class="nav-link" data-scroll-target="#variables-of-interest">Variables of interest</a></li>
  <li><a href="#select-variables" id="toc-select-variables" class="nav-link" data-scroll-target="#select-variables">Select variables</a></li>
  <li><a href="#scaling" id="toc-scaling" class="nav-link" data-scroll-target="#scaling">Scaling</a></li>
  </ul></li>
  <li><a href="#phase-angle" id="toc-phase-angle" class="nav-link" data-scroll-target="#phase-angle">Phase angle</a>
  <ul class="collapse">
  <li><a href="#all-variables" id="toc-all-variables" class="nav-link" data-scroll-target="#all-variables">All variables</a></li>
  <li><a href="#reduce-the-model-1" id="toc-reduce-the-model-1" class="nav-link" data-scroll-target="#reduce-the-model-1">Reduce the Model</a></li>
  </ul></li>
  <li><a href="#pcr" id="toc-pcr" class="nav-link" data-scroll-target="#pcr">PCR</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="Results_main_outcomes.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Main outcomes</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>S.P.L.M., Gustavo </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 20, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="getting-started" class="level1">
<h1>Getting started</h1>
<section id="load-data" class="level2">
<h2 class="anchored" data-anchor-id="load-data">Load data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">graphics.off</span>()</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\014</span><span class="st">"</span>)  <span class="co"># Clear any pending RStudio sessions or temporary files</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div style="page-break-after: always;"></div>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load functions from external script</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"helper_functions.R"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Load necessary libraries</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>â”€â”€ Attaching core tidyverse packages â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidyverse 2.0.0 â”€â”€
âœ” dplyr     1.1.4.9000     âœ” readr     2.1.5     
âœ” forcats   1.0.0          âœ” stringr   1.5.1     
âœ” ggplot2   3.5.1          âœ” tibble    3.2.1     
âœ” lubridate 1.9.4          âœ” tidyr     1.3.1     
âœ” purrr     1.0.4          
â”€â”€ Conflicts â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidyverse_conflicts() â”€â”€
âœ– dplyr::filter() masks stats::filter()
âœ– dplyr::lag()    masks stats::lag()
â„¹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>here() starts at /Users/gustavosplmoura/Library/Mobile Documents/com~apple~CloudDocs/Medicina/Biblioteca/Data Science/Data Science/R_Projects_Research/DVEP</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: Matrix

Attaching package: 'Matrix'

The following objects are masked from 'package:tidyr':

    expand, pack, unpack</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'lmerTest'

The following object is masked from 'package:lme4':

    lmer

The following object is masked from 'package:stats':

    step</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(skimr)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Read Files ----</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Codebooks</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>codebook_dvep <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Codebooks/codebook_dvep.xlsx"</span>,</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">col_names =</span> <span class="cn">TRUE</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">col_types =</span> <span class="cn">NULL</span>,</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">na =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">"NA"</span>, <span class="st">"NI"</span>, <span class="st">"UNK"</span>, <span class="st">"NASK"</span>, <span class="st">"ASKU"</span>, <span class="st">"INV"</span>),</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">trim_ws =</span> <span class="cn">TRUE</span>,</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">skip =</span> <span class="dv">0</span>, <span class="co"># Number of lines to skip before reading data</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_max =</span> <span class="cn">Inf</span>, <span class="co"># Maximum number of lines to read.</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">guess_max =</span> <span class="dv">1000</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(index)</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>codebook_structure  <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Codebooks/codebook_structure.csv"</span>,</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">col_names =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 34 Columns: 9
â”€â”€ Column specification â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Delimiter: ","
chr (2): form_name_en, form_name_pt
dbl (7): repeating, eleg, V1, V2, V3, order, variable_count

â„¹ Use `spec()` to retrieve the full column specification for this data.
â„¹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>codebook_ncit  <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Codebooks/codebook_ncit.csv"</span>,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">col_names =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 330 Columns: 4
â”€â”€ Column specification â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Delimiter: ","
chr (2): ncit_code, descriptive
dbl (2): type, medicamentos_comorbidades_complete

â„¹ Use `spec()` to retrieve the full column specification for this data.
â„¹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>codebook_bia <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Codebooks/codebook_bia.xlsx"</span>,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">col_names =</span> <span class="cn">TRUE</span>,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">col_types =</span> <span class="cn">NULL</span>,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">na =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">"NA"</span>, <span class="st">"NI"</span>, <span class="st">"UNK"</span>, <span class="st">"NASK"</span>, <span class="st">"ASKU"</span>, <span class="st">"INV"</span>),</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">trim_ws =</span> <span class="cn">TRUE</span>,</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">skip =</span> <span class="dv">0</span>, <span class="co"># Number of lines to skip before reading data</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_max =</span> <span class="cn">Inf</span>, <span class="co"># Maximum number of lines to read.</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">guess_max =</span> <span class="dv">1000</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(index)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Data</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"Data_processed/data.rds"</span>)</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>data_bia <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"Data_processed/data_bia.rds"</span>)</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>data_bia_D1 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"Data_processed/data_bia_D1.rds"</span>)</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>data_bia_D1_mean <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"Data_processed/data_bia_D1_mean.rds"</span>)</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>data_bia_D1_raw <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"Data_processed/data_bia_D1_raw.rds"</span>)</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>data_bia_D3 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"Data_processed/data_bia_D3.rds"</span>)</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>data_bia_D3_mean <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"Data_processed/data_bia_D3_mean.rds"</span>)</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>data_bia_D3_raw <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"Data_processed/data_bia_D3_raw.rds"</span>)</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>data_bia_mean <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"Data_processed/data_bia_mean.rds"</span>)</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>data_d1_exclusive <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"Data_processed/data_d1_exclusive.rds"</span>)</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>data_filtered <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"Data_processed/data_filtered.rds"</span>)</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>data_filtered_seca <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"Data_processed/data_filtered_seca.rds"</span>)</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>I21_conditions_R <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"Data_processed/I21_conditions_R.rds"</span>)</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>I22_drugs_R <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"Data_processed/I22_drugs_R.rds"</span>)</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>I27_labs_R <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"Data_processed/I27_labs_R.rds"</span>)</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>I29_compliance_new <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"Data_processed/I29_compliance_new.rds"</span>)</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>I30_events_R <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"Data_processed/I30_events_R.rds"</span>)</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a><span class="do">## SUPERTIBBLE</span></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>data_instruments <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"Data_instruments/data_instruments.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="variables-of-interest" class="level2">
<h2 class="anchored" data-anchor-id="variables-of-interest">Variables of interest</h2>
<ul>
<li>(1 | record_id) + visit + allocation_group + age + sex + race + education +</li>
<li>Comorbidities: hypertension + hypercholesterolemia + hypertrigliceridemia + insulin + drugs_w_loss + drugs_w_gain</li>
<li>Anthro: abdomen + bmi + mean_bp_mean</li>
<li>Questionnaires: whoqol_score_overall + ecap_score + evs_score + dass_score_stress + dass_score_anxiety + dass_score_depression + alcohol_significant + smoke_history + carbs_kcal + protein_kcal + fat_kcal + drugs_dose_change_yn +</li>
<li>AdesÃ£o: completed_intervention, intervention_duration, education_years? cp_taking_as_directed_yn, cp_missed_dose_yn, cp_missed_dose_count, cp_discontinued_yn, cp_discontinued_n_days, cp_ran_out_of_drug_yn, cp_medication_confidence_sca</li>
</ul>
</section>
<section id="select-variables" class="level2">
<h2 class="anchored" data-anchor-id="select-variables">Select variables</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>data_model <span class="ot">&lt;-</span> data_filtered <span class="sc">%&gt;%</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>        record_id<span class="sc">:</span>sex,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>        hypertension<span class="sc">:</span>ecap_score,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>        abdomen, bmi, mean_bp_mean,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>        resistance<span class="sc">:</span>evs_score,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>        alcohol_dose, </span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>        carbs_kcal, protein_kcal, fat_kcal, kcal,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>        labs_crp<span class="sc">:</span>labs_alkp,</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>        labs_cholesterol<span class="sc">:</span>labs_quick_index</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    data_model,</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Data_processed/data_model.rds"</span>)</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>vars_to_keep <span class="ot">&lt;-</span> <span class="fu">names</span>(data_model)</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: filter codebook_dvep</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>codebook_data_model <span class="ot">&lt;-</span> codebook_dvep <span class="sc">%&gt;%</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(variable <span class="sc">%in%</span> vars_to_keep) <span class="sc">%&gt;%</span> </span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>        variable, label_pt, field_type, choices)</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>    codebook_data_model,</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Data_processed/codebook_data_model.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="scaling" class="level2">
<h2 class="anchored" data-anchor-id="scaling">Scaling</h2>
<p><span class="math display">\[{QUICKI} = \frac{1}{\\log(insulin) + log(glucose)}\]</span></p>
<p><span class="math display">\[
HOMA-IR = \frac{insulin * glucose}{405}
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>data_model_scaled <span class="ot">&lt;-</span> data_model <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">.cols =</span> <span class="fu">c</span>(</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>        duration_difference, age,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>        whoqol_score_overall, dass_score_depression, dass_score_anxiety,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>        dass_score_stress, ecap_score, </span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>        abdomen, bmi, mean_bp_mean,</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>        resistance, reactance, </span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>        handgrip, evs_score, alcohol_dose,</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>        carbs_kcal, protein_kcal, fat_kcal, kcal,</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>        labs_crp, labs_ast, labs_alt, labs_ggt, labs_alkp,</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>        labs_cholesterol, labs_ldl, labs_hba1c, labs_triglycerides,</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>        labs_hdl, labs_glucose, labs_insulin, labs_homa_ir</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">.fns =</span> <span class="sc">~</span> <span class="fu">as.numeric</span>(<span class="fu">scale</span>(.))</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>scaling_params <span class="ot">&lt;-</span> data_model <span class="sc">%&gt;%</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">.cols =</span> <span class="fu">c</span>(</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>      duration_difference, age,</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>      whoqol_score_overall, dass_score_depression, dass_score_anxiety,</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>      dass_score_stress, ecap_score, </span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>      abdomen, bmi, mean_bp_mean,</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>      resistance, reactance, </span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>      handgrip, evs_score, alcohol_dose,</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>      carbs_kcal, protein_kcal, fat_kcal,</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>      labs_crp, labs_ast, labs_alt, labs_ggt, labs_alkp,</span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>      labs_cholesterol, labs_ldl, labs_hba1c, labs_triglycerides,</span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>      labs_hdl, labs_glucose, labs_insulin, labs_homa_ir</span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">mean =</span> <span class="sc">~</span><span class="fu">mean</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">sd =</span> <span class="sc">~</span><span class="fu">sd</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(),</span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">"variable"</span>, <span class="st">".value"</span>),</span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_sep =</span> <span class="st">"_(?=[^_]+$)"</span>,  <span class="co"># ðŸ‘ˆ this fixes the splitting</span></span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_transform =</span> <span class="fu">list</span>(<span class="at">.value =</span> as.character))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># THEN, FOR NEW DATA</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>scale_with_params <span class="ot">&lt;-</span> <span class="cf">function</span>(new_data, params) {</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(params))) {</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    var <span class="ot">&lt;-</span> params<span class="sc">$</span>variable[i]</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    mean_val <span class="ot">&lt;-</span> params<span class="sc">$</span>mean[i]</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    sd_val <span class="ot">&lt;-</span> params<span class="sc">$</span>sd[i]</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (var <span class="sc">%in%</span> <span class="fu">names</span>(new_data)) {</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>      new_data[[var]] <span class="ot">&lt;-</span> (new_data[[var]] <span class="sc">-</span> mean_val) <span class="sc">/</span> sd_val</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(new_data)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>new_data_scaled <span class="ot">&lt;-</span> <span class="fu">scale_with_params</span>(new_data, scaling_params)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="phase-angle" class="level1">
<h1>Phase angle</h1>
<p>Filtrando D1 and D3</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>pha_redcap <span class="ot">&lt;-</span> data_model_scaled <span class="sc">%&gt;%</span> </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>        visit <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">compliance_score_visit =</span> <span class="fu">case_when</span>(</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>            visit <span class="sc">==</span> <span class="dv">3</span> <span class="sc">&amp;</span> completed_intervention <span class="sc">==</span> <span class="st">"NÃ£o"</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>            <span class="cn">TRUE</span> <span class="sc">~</span> compliance_score_visit</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="all-variables" class="level2">
<h2 class="anchored" data-anchor-id="all-variables">All variables</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest) <span class="co"># Adds p-values to summary()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>pha_1 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(phase_angle <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> record_id) <span class="sc">+</span> visit <span class="sc">+</span> allocation_group <span class="sc">+</span> completed_intervention <span class="sc">+</span> duration_difference <span class="sc">+</span> age <span class="sc">+</span> sex <span class="sc">+</span> hypertension <span class="sc">+</span> hypercholesterolemia <span class="sc">+</span> hypertrigliceridemia <span class="sc">+</span> drugs_w_loss <span class="sc">+</span> drugs_w_gain <span class="sc">+</span> mean_bp_mean <span class="sc">+</span> handgrip <span class="sc">+</span> evs_score <span class="sc">+</span> alcohol_dose <span class="sc">+</span> kcal <span class="sc">+</span> labs_crp <span class="sc">+</span> labs_alt <span class="sc">+</span> labs_ggt <span class="sc">+</span> labs_ldl <span class="sc">+</span> labs_triglycerides <span class="sc">+</span> labs_hdl <span class="sc">+</span> labs_quick_index, <span class="at">data =</span> pha_redcap)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pha_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML. t-tests use Satterthwaite's method [
lmerModLmerTest]
Formula: 
phase_angle ~ (1 | record_id) + visit + allocation_group + completed_intervention +  
    duration_difference + age + sex + hypertension + hypercholesterolemia +  
    hypertrigliceridemia + drugs_w_loss + drugs_w_gain + mean_bp_mean +  
    handgrip + evs_score + alcohol_dose + kcal + labs_crp + labs_alt +  
    labs_ggt + labs_ldl + labs_triglycerides + labs_hdl + labs_quick_index
   Data: pha_redcap

REML criterion at convergence: 267.6

Scaled residuals: 
     Min       1Q   Median       3Q      Max 
-1.56730 -0.34461 -0.02411  0.32517  2.31790 

Random effects:
 Groups    Name        Variance Std.Dev.
 record_id (Intercept) 0.7246   0.8513  
 Residual              0.1072   0.3274  
Number of obs: 111, groups:  record_id, 73

Fixed effects:
                          Estimate Std. Error       df t value Pr(&gt;|t|)    
(Intercept)                6.80702    1.14545 54.72940   5.943 2.02e-07 ***
visit                      0.04367    0.05999 39.61741   0.728 0.470955    
allocation_groupGrupo B   -0.08294    0.23322 58.16739  -0.356 0.723419    
completed_interventionSim  0.13431    0.29025 62.80942   0.463 0.645154    
duration_difference        0.06796    0.07531 35.47525   0.902 0.372926    
age                       -0.15807    0.13498 60.83001  -1.171 0.246148    
sexMasculino               0.09460    0.47396 83.73697   0.200 0.842285    
hypertension1             -0.41606    0.30355 64.58323  -1.371 0.175222    
hypercholesterolemia1      0.19062    0.27727 69.89339   0.687 0.494049    
hypertrigliceridemia1     -0.34038    0.27433 76.54222  -1.241 0.218477    
drugs_w_loss1             -0.25530    0.26664 55.83333  -0.957 0.342447    
drugs_w_gain1             -0.66202    0.56551 57.08713  -1.171 0.246602    
mean_bp_mean               0.18737    0.09217 82.46459   2.033 0.045275 *  
handgrip                   0.02906    0.12915 84.31928   0.225 0.822503    
evs_score                  0.02820    0.06771 51.41295   0.417 0.678762    
alcohol_dose               0.25024    0.06910 55.31084   3.621 0.000637 ***
kcal                       0.08493    0.07469 64.71213   1.137 0.259686    
labs_crp                   0.12545    0.05608 35.78386   2.237 0.031613 *  
labs_alt                  -0.07563    0.08133 60.52700  -0.930 0.356110    
labs_ggt                   0.02983    0.10259 78.08587   0.291 0.771980    
labs_ldl                  -0.11607    0.09391 52.71421  -1.236 0.221990    
labs_triglycerides         0.04481    0.07352 35.85978   0.610 0.545998    
labs_hdl                  -0.02374    0.08890 81.65491  -0.267 0.790104    
labs_quick_index          -1.07713    3.09369 48.37580  -0.348 0.729223    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Correlation matrix not shown by default, as p = 24 &gt; 12.
Use print(x, correlation=TRUE)  or
    vcov(x)        if you need it</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pha_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Results_main_outcomes_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>A modelagem estatÃ­stica foi realizada por meio de modelos lineares mistos com intercepto aleatÃ³rio por participante (record_id). Todas as variÃ¡veis contÃ­nuas foram previamente padronizadas (mÃ©dia = 0, desvio-padrÃ£o = 1), exceto o Ã­ndice QUICKI, mantido em sua unidade original para fins de interpretabilidade clÃ­nica. A variÃ¡vel duration_difference, que representa o desvio absoluto em dias da duraÃ§Ã£o planejada da intervenÃ§Ã£o (90 dias), foi ajustada para zero na visita basal e posteriormente padronizada. O modelo pha_2 incluiu 24 preditores fixos e foi ajustado utilizando o mÃ©todo de mÃ¡xima verossimilhanÃ§a restrita (REML), com inclusÃ£o da variÃ¢ncia intraindividual no componente aleatÃ³rio.</p>
<p>Neste modelo, observou-se que a pressÃ£o arterial mÃ©dia (mean_bp_mean) foi positivamente associada ao Ã¢ngulo de fase (Î² = 0.19, p = 0.045), sugerindo que nÃ­veis mais elevados de pressÃ£o podem estar relacionados a um melhor estado funcional da membrana celular. A dose de Ã¡lcool (alcohol_dose) foi o preditor com maior significÃ¢ncia estatÃ­stica (Î² = 0.25, p &lt; 0.001), com associaÃ§Ã£o positiva ao Ã¢ngulo de fase; esse achado deve ser interpretado com cautela, pois pode refletir fatores comportamentais ou nutricionais nÃ£o capturados diretamente no modelo. AlÃ©m disso, a proteÃ­na C reativa (labs_crp) apresentou associaÃ§Ã£o positiva marginalmente significativa (Î² = 0.13, p = 0.031), o que pode indicar uma complexa interaÃ§Ã£o entre inflamaÃ§Ã£o subclÃ­nica e integridade da membrana celular.</p>
<p>Outros preditores como visit, allocation_group, completed_intervention, duration_difference e variÃ¡veis laboratoriais como labs_ldl, labs_triglycerides e labs_quick_index nÃ£o apresentaram associaÃ§Ãµes estatisticamente significativas. A variÃ¢ncia do intercepto aleatÃ³rio por record_id permaneceu elevada (0.72), reforÃ§ando a relevÃ¢ncia da estrutura longitudinal dos dados. O critÃ©rio de REML obtido foi 267.6, indicando um ajuste superior ao modelo anterior (REML = 275), e sugerindo avanÃ§o na parcimÃ´nia e na qualidade do modelo apÃ³s a reduÃ§Ã£o de preditores.</p>
<p><strong>PrÃ³ximos passos sugeridos</strong>: - Considerar remoÃ§Ã£o de variÃ¡veis com p &gt; 0.5 e sem base teÃ³rica. - Avaliar o impacto de variÃ¡veis correlacionadas (e.g., <code>bmi</code>, <code>abdomen</code>). - Testar modelos reduzidos orientados por AIC ou p-valor.</p>
<p><em>Interpretation clarity</em> - With all predictors scaled, effect sizes are in SD units. labs_quick_index still in raw units: its coefficient = change in phase angle per unit change in QUICKI, which is very interpretable (and appropriate).</p>
<p><em>Random effects</em> - You can tell that including a random intercept was appropriate by comparing the random effect variance to the residual variance. The random intercept variance for record_id is 0.6846, which represents the variability between participants. The residual variance is 0.1188, which reflects variability within participants (i.e., unexplained by the model and random noise). Now, the random intercept variance is much larger than the residual variance. This indicates that a substantial portion of the total variance in your outcome (phase_angle) is due to differences between individuals, not just random fluctuation within the same person over time. Hence, accounting for individual-level differences via a random intercept helps the model better estimate the effects of your fixed variables by controlling for this inter-individual baseline shift. Summary: Since Var(Intercept for record_id) &gt; Var(Residual), this suggests strong subject-level variation, meaning including (1 | record_id) was a statistically sound choice.</p>
<section id="refinements" class="level3">
<h3 class="anchored" data-anchor-id="refinements">Refinements</h3>
<ol type="1">
<li><p>Check for multicollinearity</p></li>
<li><p>High number of predictors (p = 30+) vs.&nbsp;N = 111 to your sample size. This increases risk of: Overfitting, Inflated standard errors, Instability in estimates. Suggestion: Run a stepwise reduction or penalized regression (e.g., LASSO via glmnet) to select the most stable subset.</p></li>
<li><p>Check model fit and explained variance.</p>
<ul>
<li>Use performance::check_model() to assess residuals, normality, and homoscedasticity.</li>
<li>Consider using marginal and conditional RÂ² to evaluate model fit.</li>
</ul></li>
<li><p>Plot residuals and check assumptions: Homoscedasticity, Normality of residuals, Influential observations.</p></li>
<li><p>Refine the role of visit. Currently, visit is not significant, but the study is longitudinal. So ask: Is visit best treated as a linear trend (numeric)? Would a factor with interaction be more appropriate? Would a random slope for visit help capture subject-specific trajectories?</p></li>
</ol>
</section>
<section id="check-for-multicollinearity" class="level3">
<h3 class="anchored" data-anchor-id="check-for-multicollinearity">1. Check for multicollinearity</h3>
<p>Because you have many predictors (30+), and some may be redundant or highly correlated, collinearity is your first enemy. Youâ€™ve handled insulin/glucose/HOMA/QUICKI well. But still check VIFs for collinearity among other variables (like BMI and abdomen, or macronutrients - total energy intake). High collinearity can: (1) Inflate standard errors (making real effects look non-significant), (2) Obscure model interpretation, (3) Affect convergence and coefficient stability. How? Use performance::check_collinearity():</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">check_collinearity</span>(pha_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Check for Multicollinearity

Low Correlation

                   Term  VIF   VIF 95% CI Increased SE Tolerance
                  visit 2.64 [2.13, 3.38]         1.63      0.38
       allocation_group 1.24 [1.10, 1.57]         1.11      0.81
 completed_intervention 1.54 [1.31, 1.93]         1.24      0.65
    duration_difference 2.07 [1.71, 2.63]         1.44      0.48
                    age 1.67 [1.40, 2.10]         1.29      0.60
                    sex 2.41 [1.96, 3.07]         1.55      0.41
           hypertension 1.51 [1.29, 1.90]         1.23      0.66
   hypercholesterolemia 1.64 [1.39, 2.07]         1.28      0.61
   hypertrigliceridemia 1.71 [1.44, 2.15]         1.31      0.58
           drugs_w_loss 1.20 [1.08, 1.54]         1.10      0.83
           drugs_w_gain 1.13 [1.03, 1.52]         1.06      0.88
           mean_bp_mean 1.84 [1.53, 2.32]         1.36      0.54
               handgrip 1.94 [1.61, 2.46]         1.39      0.51
              evs_score 1.31 [1.15, 1.65]         1.14      0.76
           alcohol_dose 1.48 [1.27, 1.85]         1.22      0.68
                   kcal 1.67 [1.41, 2.10]         1.29      0.60
               labs_crp 1.22 [1.09, 1.56]         1.10      0.82
               labs_alt 1.48 [1.27, 1.85]         1.22      0.68
               labs_ggt 1.65 [1.39, 2.07]         1.28      0.61
               labs_ldl 1.69 [1.42, 2.12]         1.30      0.59
     labs_triglycerides 1.48 [1.27, 1.86]         1.22      0.67
               labs_hdl 1.32 [1.15, 1.66]         1.15      0.76
       labs_quick_index 1.23 [1.09, 1.56]         1.11      0.82
 Tolerance 95% CI
     [0.30, 0.47]
     [0.64, 0.91]
     [0.52, 0.76]
     [0.38, 0.59]
     [0.48, 0.71]
     [0.33, 0.51]
     [0.53, 0.77]
     [0.48, 0.72]
     [0.46, 0.70]
     [0.65, 0.93]
     [0.66, 0.97]
     [0.43, 0.65]
     [0.41, 0.62]
     [0.61, 0.87]
     [0.54, 0.79]
     [0.48, 0.71]
     [0.64, 0.92]
     [0.54, 0.79]
     [0.48, 0.72]
     [0.47, 0.70]
     [0.54, 0.79]
     [0.60, 0.87]
     [0.64, 0.92]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># r2(pha_1)  # Marginal and conditional RÂ²</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Interpretation of collinearity results:</strong> No concerning multicollinearity (all VIFs &lt; 3).</p>
<p>Variance Inflation Factor (VIF) measures how much the variance (i.e., the standard error squared) of a regression coefficient is inflated due to collinearity with other predictors. In other words, it tells you how strongly one predictor is linearly related to the others.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><strong>VIF Value</strong></th>
<th><strong>Interpretation</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>No correlation with other variables</td>
</tr>
<tr class="even">
<td>1â€“2</td>
<td>Low correlation, no concern</td>
</tr>
<tr class="odd">
<td>2â€“5</td>
<td>Moderate correlation â€” <strong>keep an eye</strong></td>
</tr>
<tr class="even">
<td>5â€“10</td>
<td>High correlation â€” <strong>potential problem</strong></td>
</tr>
<tr class="odd">
<td>&gt;10</td>
<td>Severe multicollinearity â€” <strong>likely an issue</strong></td>
</tr>
</tbody>
</table>
</section>
<section id="reduce-the-model" class="level3">
<h3 class="anchored" data-anchor-id="reduce-the-model">2. Reduce the model</h3>
<p>Your model currently includes 30 fixed effects, which may limit statistical power and interpretability due to overfitting.</p>
<p>A abordagem mais sensata para reduzir o modelo depende diretamente do seu objetivo principal.</p>
<p>Se o seu foco for <strong>prediÃ§Ã£o ou performance do modelo</strong>, entÃ£o a estratÃ©gia <strong>data-driven</strong> Ã© mais apropriada, como:</p>
<ul>
<li><strong>(1) SeleÃ§Ã£o stepwise backward</strong> com base em critÃ©rios de informaÃ§Ã£o como AIC ou BIC (AIC favorece modelos com melhor ajuste, BIC penaliza mais a complexidade).</li>
<li><strong>LASSO (via <code>glmnet</code>)</strong>, que impÃµe uma penalizaÃ§Ã£o e tende a selecionar um subconjunto estÃ¡vel de variÃ¡veis, pode ser especialmente Ãºtil quando o nÃºmero de preditores Ã© alto e hÃ¡ colinearidade moderada.</li>
</ul>
<p>Entretanto, se o objetivo for <strong>interpretaÃ§Ã£o e inferÃªncia causal ou explicativa</strong> (como Ã© comum em ensaios clÃ­nicos e estudos de intervenÃ§Ã£o), a melhor abordagem Ã©:</p>
<ul>
<li><strong>(2) SimplificaÃ§Ã£o orientada pela teoria e plausibilidade clÃ­nica</strong>, removendo variÃ¡veis que claramente nÃ£o contribuem de forma significativa, que se sobrepÃµem a outras medidas (ex: manter apenas <code>quick_index</code> e excluir glicemia/insulina), ou que apresentem comportamento instÃ¡vel nos modelos (como efeitos colineares ou variaÃ§Ãµes negativas no sinal da estimativa ao longo das versÃµes do modelo).</li>
</ul>
<p>Quando eu menciono <strong>â€œvariaÃ§Ãµes negativas no sinal da estimativa ao longo das versÃµes do modeloâ€</strong>, estou me referindo ao comportamento instÃ¡vel dos coeficientes de algumas variÃ¡veis Ã  medida que vocÃª modifica o modelo â€” por exemplo, adicionando ou removendo preditores.</p>
<p>Imagine que, em um modelo mais simples, a variÃ¡vel <code>bmi</code> tem um coeficiente <strong>positivo</strong>, sugerindo que quanto maior o IMC, maior o Ã¢ngulo de fase. Mas ao incluir outras variÃ¡veis correlacionadas (como <code>abdomen</code> ou <code>resistance</code>), o coeficiente de <code>bmi</code> se torna <strong>negativo</strong> ou <strong>nÃ£o significativo</strong>. Essa mudanÃ§a de sinal pode indicar:</p>
<ul>
<li><strong>Colinearidade</strong>: <code>bmi</code> e <code>abdomen</code>, por exemplo, podem estar explicando o mesmo componente corporal.</li>
<li><strong>Falta de robustez</strong>: a interpretaÃ§Ã£o do efeito da variÃ¡vel muda conforme outras sÃ£o incluÃ­das, dificultando conclusÃµes consistentes.</li>
<li><strong>Overfitting ou ajuste instÃ¡vel</strong>, especialmente em amostras pequenas.</li>
</ul>
<p>Detectar esse comportamento Ã© um sinal de que a variÃ¡vel pode estar redundante ou que hÃ¡ necessidade de ajustes â€” por exemplo, usar apenas uma das variÃ¡veis correlacionadas ou aplicar tÃ©cnicas de regularizaÃ§Ã£o.</p>
<p>Portanto, <strong>â€œvariaÃ§Ã£o no sinal da estimativaâ€</strong> nÃ£o Ã© sobre valor negativo em si, mas sobre <strong>mudanÃ§a de direÃ§Ã£o do efeito estimado</strong>, o que enfraquece a confianÃ§a na interpretaÃ§Ã£o daquele preditor.</p>
<p>Uma boa estratÃ©gia hÃ­brida Ã©:</p>
<ol type="1">
<li><strong>Fixar um conjunto mÃ­nimo de variÃ¡veis-chave teÃ³ricas</strong> (ex: sexo, idade, grupo, tempo).</li>
<li><strong>Aplicar reduÃ§Ã£o stepwise nos demais termos</strong>, guiando-se por BIC (se vocÃª deseja maior parcimÃ´nia) ou por LASSO.</li>
<li><strong>Comparar modelos com ANOVA</strong> e grÃ¡ficos de resÃ­duos para garantir que a simplificaÃ§Ã£o nÃ£o deteriora o ajuste.</li>
</ol>
<p>Essa abordagem permite alcanÃ§ar um equilÃ­brio entre interpretabilidade e estabilidade do modelo.</p>
</section>
<section id="check-model-fit" class="level3">
<h3 class="anchored" data-anchor-id="check-model-fit">3. Check model fit</h3>
<p>A avaliaÃ§Ã£o dos pressupostos do modelo pha_1 foi realizada por meio da funÃ§Ã£o check_model() do pacote performance, a qual indicou que, em linhas gerais, o modelo apresenta adequaÃ§Ã£o estatÃ­stica razoÃ¡vel. O grÃ¡fico de Posterior Predictive Check mostra boa sobreposiÃ§Ã£o entre a densidade dos valores observados e os valores preditos pelo modelo, indicando adequada capacidade preditiva.</p>
<p>A verificaÃ§Ã£o da linearidade dos resÃ­duos frente aos valores ajustados revelou um desvio leve da horizontalidade na extremidade superior, sugerindo possÃ­vel nÃ£o linearidade em valores mais altos do desfecho. A homogeneidade da variÃ¢ncia (homoscedasticidade) tambÃ©m apresentou leve violaÃ§Ã£o, com aumento da variÃ¢ncia dos resÃ­duos em valores preditos mais altos â€” caracterÃ­stica que pode afetar a precisÃ£o das estimativas nessas faixas.</p>
<p>A anÃ¡lise de observaÃ§Ãµes influentes (grÃ¡fico de alavancagem vs.&nbsp;resÃ­duos padronizados) identificou algumas observaÃ§Ãµes com leve influÃªncia (por exemplo, IDs 10, 69, 70, 75, 109), mas nenhuma ultrapassando os limiares clÃ¡ssicos de alavancagem ou resÃ­duos padronizados extremos.</p>
<p>A colinearidade foi considerada baixa, com todos os fatores de inflaÃ§Ã£o da variÃ¢ncia (VIF) abaixo de 5, o que indica ausÃªncia de multicolinearidade severa entre os preditores. O grÃ¡fico de normalidade dos resÃ­duos mostra aderÃªncia razoÃ¡vel Ã  distribuiÃ§Ã£o normal, com pequenas desvios nas caudas, o que Ã© aceitÃ¡vel para modelos mistos com tamanho amostral moderado. Por fim, a distribuiÃ§Ã£o dos efeitos aleatÃ³rios (record_id) se aproximou da normalidade, com leve assimetria nas extremidades, reforÃ§ando que o intercepto aleatÃ³rio foi uma escolha apropriada para capturar a variabilidade entre indivÃ­duos.</p>
</section>
<section id="refine-the-role-of-visit" class="level3">
<h3 class="anchored" data-anchor-id="refine-the-role-of-visit">5. Refine the role of visit</h3>
<p>lmer(phase_angle ~ visit + (visit | record_id) + â€¦</p>
<p>Error: number of observations (=111) &lt;= number of random effects (=146) for term (visit | record_id)</p>
<p>lmer(phase_angle ~ visit + (1 + visit || record_id) + â€¦</p>
<p>boundary (singular) fit: see help(â€˜isSingularâ€™)</p>
</section>
</section>
<section id="reduce-the-model-1" class="level2">
<h2 class="anchored" data-anchor-id="reduce-the-model-1">Reduce the Model</h2>
<section id="pha_2" class="level3">
<h3 class="anchored" data-anchor-id="pha_2">pha_2</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>pha_2 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(phase_angle <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> record_id) <span class="sc">+</span> visit <span class="sc">+</span> allocation_group <span class="sc">+</span> age <span class="sc">+</span> sex <span class="sc">+</span> bmi <span class="sc">+</span> mean_bp_mean <span class="sc">+</span> handgrip <span class="sc">+</span> evs_score <span class="sc">+</span> kcal <span class="sc">+</span> labs_crp <span class="sc">+</span> labs_alt <span class="sc">+</span> labs_ggt <span class="sc">+</span> labs_ldl <span class="sc">+</span> labs_triglycerides <span class="sc">+</span> labs_hdl <span class="sc">+</span> labs_quick_index, <span class="at">data =</span> pha_redcap)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pha_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML. t-tests use Satterthwaite's method [
lmerModLmerTest]
Formula: phase_angle ~ (1 | record_id) + visit + allocation_group + age +  
    sex + bmi + mean_bp_mean + handgrip + evs_score + kcal +  
    labs_crp + labs_alt + labs_ggt + labs_ldl + labs_triglycerides +  
    labs_hdl + labs_quick_index
   Data: pha_redcap

REML criterion at convergence: 275.6

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-2.1820 -0.3023 -0.0278  0.2559  3.6054 

Random effects:
 Groups    Name        Variance Std.Dev.
 record_id (Intercept) 0.5811   0.7623  
 Residual              0.1780   0.4219  
Number of obs: 111, groups:  record_id, 73

Fixed effects:
                         Estimate Std. Error        df t value Pr(&gt;|t|)    
(Intercept)              7.082490   1.176374 77.136367   6.021 5.51e-08 ***
visit                   -0.004178   0.060460 47.468510  -0.069   0.9452    
allocation_groupGrupo B -0.252382   0.214787 64.288710  -1.175   0.2443    
age                     -0.187470   0.105337 65.806508  -1.780   0.0797 .  
sexMasculino             0.335406   0.456188 84.261799   0.735   0.4642    
bmi                      0.010733   0.097621 89.559042   0.110   0.9127    
mean_bp_mean             0.174320   0.096937 93.792525   1.798   0.0753 .  
handgrip                 0.077031   0.130670 92.345158   0.590   0.5570    
evs_score                0.035996   0.073279 74.994735   0.491   0.6247    
kcal                     0.026568   0.080627 77.299814   0.330   0.7427    
labs_crp                 0.080876   0.065164 51.402275   1.241   0.2202    
labs_alt                -0.001230   0.085298 88.062468  -0.014   0.9885    
labs_ggt                 0.026733   0.096885 82.285184   0.276   0.7833    
labs_ldl                -0.064943   0.090663 92.475432  -0.716   0.4756    
labs_triglycerides       0.015440   0.079832 62.011443   0.193   0.8473    
labs_hdl                 0.002898   0.092120 93.997884   0.031   0.9750    
labs_quick_index        -1.886146   3.435802 75.554696  -0.549   0.5846    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Correlation matrix not shown by default, as p = 17 &gt; 12.
Use print(x, correlation=TRUE)  or
    vcov(x)        if you need it</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>AIC(pha_1, pha_2) df AIC pha_1 26 319.5554 pha_2 19 313.6283</p>
</blockquote>
<blockquote class="blockquote">
<p>BIC(pha_1, pha_2) df BIC pha_1 26 390.0032 pha_2 19 365.1094</p>
</blockquote>
<p>A comparaÃ§Ã£o entre os modelos pelo critÃ©rio de informaÃ§Ã£o de Akaike (AIC) e o critÃ©rio bayesiano de informaÃ§Ã£o (BIC) favoreceu o modelo reduzido (pha_2), que apresentou valores mais baixos de AIC (313,6 vs.&nbsp;319,6) e BIC (365,1 vs.&nbsp;390,0) em relaÃ§Ã£o ao modelo completo (pha_1). Isso sugere que a simplificaÃ§Ã£o do modelo resultou em melhor equilÃ­brio entre ajuste e complexidade, mesmo com a perda de significÃ¢ncia estatÃ­stica de algumas covariÃ¡veis previamente relevantes.</p>
</section>
<section id="pha_3" class="level3">
<h3 class="anchored" data-anchor-id="pha_3">pha_3</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>pha_3 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(phase_angle <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> record_id) <span class="sc">+</span> visit <span class="sc">+</span> allocation_group <span class="sc">+</span> completed_intervention <span class="sc">+</span> duration_difference <span class="sc">+</span> age <span class="sc">+</span> sex <span class="sc">+</span> hypertension <span class="sc">+</span> hypercholesterolemia <span class="sc">+</span> hypertrigliceridemia <span class="sc">+</span> drugs_w_loss <span class="sc">+</span> drugs_w_gain <span class="sc">+</span> mean_bp_mean <span class="sc">+</span> handgrip <span class="sc">+</span> evs_score <span class="sc">+</span> alcohol_dose <span class="sc">+</span> kcal <span class="sc">+</span> labs_crp <span class="sc">+</span> labs_ldl <span class="sc">+</span> labs_quick_index, <span class="at">data =</span> pha_redcap)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pha_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML. t-tests use Satterthwaite's method [
lmerModLmerTest]
Formula: 
phase_angle ~ (1 | record_id) + visit + allocation_group + completed_intervention +  
    duration_difference + age + sex + hypertension + hypercholesterolemia +  
    hypertrigliceridemia + drugs_w_loss + drugs_w_gain + mean_bp_mean +  
    handgrip + evs_score + alcohol_dose + kcal + labs_crp + labs_ldl +  
    labs_quick_index
   Data: pha_redcap

REML criterion at convergence: 256.2

Scaled residuals: 
     Min       1Q   Median       3Q      Max 
-1.67542 -0.37054 -0.01038  0.28131  2.47511 

Random effects:
 Groups    Name        Variance Std.Dev.
 record_id (Intercept) 0.6800   0.8246  
 Residual              0.1089   0.3300  
Number of obs: 111, groups:  record_id, 73

Fixed effects:
                          Estimate Std. Error       df t value Pr(&gt;|t|)    
(Intercept)                6.73199    1.12618 62.54202   5.978 1.18e-07 ***
visit                      0.04629    0.05831 39.70014   0.794  0.43198    
allocation_groupGrupo B   -0.08824    0.22558 60.66392  -0.391  0.69704    
completed_interventionSim  0.09468    0.27813 63.80928   0.340  0.73466    
duration_difference        0.06221    0.07418 37.43891   0.839  0.40701    
age                       -0.14627    0.13082 63.16447  -1.118  0.26776    
sexMasculino               0.05360    0.44022 84.14001   0.122  0.90339    
hypertension1             -0.37768    0.29365 65.31066  -1.286  0.20294    
hypercholesterolemia1      0.13976    0.26480 72.33121   0.528  0.59926    
hypertrigliceridemia1     -0.21111    0.23292 62.70194  -0.906  0.36822    
drugs_w_loss1             -0.25216    0.25896 58.72682  -0.974  0.33419    
drugs_w_gain1             -0.64500    0.54712 60.02599  -1.179  0.24308    
mean_bp_mean               0.18141    0.08674 82.54798   2.092  0.03955 *  
handgrip                   0.04801    0.12342 88.77623   0.389  0.69823    
evs_score                  0.03655    0.06602 54.80914   0.554  0.58207    
alcohol_dose               0.24846    0.06783 59.87919   3.663  0.00053 ***
kcal                       0.09010    0.07346 72.69290   1.227  0.22393    
labs_crp                   0.11992    0.05502 40.88103   2.180  0.03509 *  
labs_ldl                  -0.09732    0.08787 60.12632  -1.108  0.27247    
labs_quick_index          -0.90144    3.03633 57.49316  -0.297  0.76762    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Correlation matrix not shown by default, as p = 20 &gt; 12.
Use print(x, correlation=TRUE)  or
    vcov(x)        if you need it</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_collinearity</span>(pha_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Check for Multicollinearity

Low Correlation

                   Term  VIF   VIF 95% CI Increased SE Tolerance
                  visit 2.46 [1.98, 3.18]         1.57      0.41
       allocation_group 1.22 [1.08, 1.58]         1.11      0.82
 completed_intervention 1.49 [1.27, 1.89]         1.22      0.67
    duration_difference 1.99 [1.63, 2.54]         1.41      0.50
                    age 1.65 [1.39, 2.11]         1.29      0.60
                    sex 2.20 [1.79, 2.83]         1.48      0.45
           hypertension 1.50 [1.27, 1.90]         1.22      0.67
   hypercholesterolemia 1.58 [1.34, 2.02]         1.26      0.63
   hypertrigliceridemia 1.30 [1.14, 1.67]         1.14      0.77
           drugs_w_loss 1.20 [1.07, 1.57]         1.10      0.83
           drugs_w_gain 1.12 [1.03, 1.56]         1.06      0.89
           mean_bp_mean 1.65 [1.39, 2.10]         1.29      0.61
               handgrip 1.84 [1.52, 2.35]         1.36      0.54
              evs_score 1.25 [1.11, 1.62]         1.12      0.80
           alcohol_dose 1.44 [1.23, 1.83]         1.20      0.69
                   kcal 1.62 [1.36, 2.06]         1.27      0.62
               labs_crp 1.17 [1.05, 1.55]         1.08      0.86
               labs_ldl 1.50 [1.28, 1.91]         1.23      0.67
       labs_quick_index 1.19 [1.07, 1.56]         1.09      0.84
 Tolerance 95% CI
     [0.31, 0.51]
     [0.63, 0.92]
     [0.53, 0.79]
     [0.39, 0.61]
     [0.48, 0.72]
     [0.35, 0.56]
     [0.53, 0.78]
     [0.50, 0.75]
     [0.60, 0.88]
     [0.64, 0.93]
     [0.64, 0.98]
     [0.48, 0.72]
     [0.42, 0.66]
     [0.62, 0.90]
     [0.55, 0.81]
     [0.48, 0.73]
     [0.65, 0.95]
     [0.52, 0.78]
     [0.64, 0.94]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(pha_1, pha_2, pha_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      df      AIC
pha_1 26 319.5554
pha_2 19 313.6283
pha_3 22 300.2185</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">BIC</span>(pha_1, pha_2, pha_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      df      BIC
pha_1 26 390.0032
pha_2 19 365.1094
pha_3 22 359.8281</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">r2</span>(pha_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># R2 for Mixed Models

  Conditional R2: 0.896
     Marginal R2: 0.250</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>plots <span class="ot">&lt;-</span> performance<span class="sc">::</span><span class="fu">check_model</span>(pha_3)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plots)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Results_main_outcomes_files/figure-html/check-model-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>TrÃªs modelos hierÃ¡rquicos foram comparados utilizando os critÃ©rios de informaÃ§Ã£o AIC e BIC. O modelo pha_3, contendo 22 preditores fixos, apresentou os menores valores de AIC (300,2) e BIC (359,8), superando tanto o modelo completo pha_1 (AIC = 319,6; BIC = 390,0) quanto o modelo reduzido pha_2 (AIC = 313,6; BIC = 365,1). Esses resultados indicam que pha_3 oferece o melhor equilÃ­brio entre qualidade de ajuste e complexidade do modelo, sendo, portanto, o modelo preferido para interpretaÃ§Ã£o final dos resultados.</p>
<p>Uma versÃ£o reduzida do modelo foi desenvolvida com o objetivo de aprimorar o equilÃ­brio entre parcimÃ´nia e desempenho preditivo. A seleÃ§Ã£o das variÃ¡veis foi orientada tanto por critÃ©rios teÃ³ricos quanto estatÃ­sticos, priorizando preditores com plausibilidade clÃ­nica e contribuiÃ§Ãµes informativas nas versÃµes anteriores. O novo modelo (pha_final) manteve o intercepto aleatÃ³rio por participante (record_id) e incluiu 20 preditores fixos, resultando em um critÃ©rio de mÃ¡xima verossimilhanÃ§a restrita (REML) inferior ao dos modelos anteriores (REML = 256,2), indicando melhora no ajuste.</p>
<p>As variÃ¡veis mean_bp_mean (p = 0.040), alcohol_dose (p &lt; 0.001) e labs_crp (p = 0.035) mantiveram associaÃ§Ã£o estatisticamente significativa com o Ã¢ngulo de fase, mesmo apÃ³s o ajuste multivariado, o que reforÃ§a a robustez dessas associaÃ§Ãµes. A variÃ¡vel visit foi mantida como efeito fixo para controle do efeito temporal, embora nÃ£o tenha mostrado significÃ¢ncia estatÃ­stica (p = 0.432). A variÃ¢ncia do intercepto aleatÃ³rio (ÏƒÂ² = 0.68) permaneceu relevante, o que confirma a presenÃ§a de heterogeneidade entre os participantes e a adequaÃ§Ã£o do uso de um modelo misto.</p>
<p>A anÃ¡lise multicolinearidade mostrou valores de VIF &lt; 3 para todos os preditores, descartando problemas relevantes de colinearidade. Os diagnÃ³sticos do modelo indicaram distribuiÃ§Ã£o adequada dos resÃ­duos, ausÃªncia de observaÃ§Ãµes altamente influentes e normalidade satisfatÃ³ria dos efeitos aleatÃ³rios, corroborando a adequaÃ§Ã£o do modelo ajustado.</p>
<p>A avaliaÃ§Ã£o dos pressupostos do modelo pha_final foi realizada com base em grÃ¡ficos diagnÃ³sticos. O grÃ¡fico de densidade (â€œPosterior Predictive Checkâ€) indicou que os valores preditos se alinharam adequadamente com a distribuiÃ§Ã£o observada do Ã¢ngulo de fase. Os resÃ­duos padronizados apresentaram distribuiÃ§Ã£o aproximadamente normal, conforme demonstrado no grÃ¡fico de quantis teÃ³ricos dos efeitos aleatÃ³rios e no grÃ¡fico de normalidade dos resÃ­duos, reforÃ§ando a adequaÃ§Ã£o do modelo misto com intercepto aleatÃ³rio por participante.</p>
<p>A homogeneidade da variÃ¢ncia apresentou leve tendÃªncia de heterocedasticidade nas extremidades do ajuste, mas sem padrÃ£o grave de violaÃ§Ã£o. A linearidade foi, em geral, respeitada, embora a tendÃªncia suavizada indique alguma curvatura para valores mais altos do desfecho. O grÃ¡fico de observaÃ§Ãµes influentes mostrou que todos os pontos estÃ£o dentro dos limites de influÃªncia padronizada, indicando ausÃªncia de outliers com alavancagem elevada.</p>
<p>Por fim, a anÃ¡lise de colinearidade mostrou que todos os preditores apresentaram VIF abaixo de 3, descartando preocupaÃ§Ãµes com multicolinearidade. Dessa forma, os pressupostos do modelo foram globalmente atendidos, validando a interpretaÃ§Ã£o dos coeficientes estimados.</p>
<p>O modelo apresentou RÂ² marginal de 0,250, indicando que as variÃ¡veis fixas explicam 25% da variÃ¢ncia do desfecho, e RÂ² condicional de 0,896, refletindo a alta variabilidade explicada quando se considera a estrutura aleatÃ³ria intra-individual, compatÃ­vel com o delineamento longitudinal do estudo.</p>
</section>
</section>
</section>
<section id="pcr" class="level1">
<h1>PCR</h1>
<section id="section" class="level3">
<h3 class="anchored" data-anchor-id="section">1</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>model3 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(labs_crp <span class="sc">~</span> visit <span class="sc">+</span> allocation_group <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> record_id), <span class="at">data =</span> data_filtered)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML. t-tests use Satterthwaite's method [
lmerModLmerTest]
Formula: labs_crp ~ visit + allocation_group + (1 | record_id)
   Data: data_filtered

REML criterion at convergence: 1163.3

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-2.8000 -0.3580 -0.1254  0.2196  7.5431 

Random effects:
 Groups    Name        Variance Std.Dev.
 record_id (Intercept) 27.00    5.196   
 Residual              30.73    5.544   
Number of obs: 174, groups:  record_id, 75

Fixed effects:
                        Estimate Std. Error       df t value Pr(&gt;|t|)    
(Intercept)               8.2417     1.4442 159.2172   5.707 5.48e-08 ***
visit                    -1.0011     0.5504 109.9562  -1.819   0.0716 .  
allocation_groupGrupo B   0.4793     1.4930  68.5534   0.321   0.7492    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) visit 
visit       -0.689       
allctn_grGB -0.543  0.051</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model3)  <span class="co"># Residuals vs. fitted</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Results_main_outcomes_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(model3)); <span class="fu">qqline</span>(<span class="fu">resid</span>(model3))  <span class="co"># Normality check</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Results_main_outcomes_files/figure-html/unnamed-chunk-11-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>model3_log <span class="ot">&lt;-</span> <span class="fu">lmer</span>(<span class="fu">log1p</span>(labs_crp) <span class="sc">~</span> visit <span class="sc">+</span> allocation_group <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> record_id), <span class="at">data =</span> data_filtered)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model3_log)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML. t-tests use Satterthwaite's method [
lmerModLmerTest]
Formula: log1p(labs_crp) ~ visit + allocation_group + (1 | record_id)
   Data: data_filtered

REML criterion at convergence: 356.4

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.1250 -0.4690  0.0144  0.4178  4.7068 

Random effects:
 Groups    Name        Variance Std.Dev.
 record_id (Intercept) 0.4128   0.6425  
 Residual              0.2156   0.4643  
Number of obs: 174, groups:  record_id, 75

Fixed effects:
                         Estimate Std. Error        df t value Pr(&gt;|t|)    
(Intercept)               1.82377    0.14420 134.87011  12.647   &lt;2e-16 ***
visit                    -0.09940    0.04678 106.74492  -2.125   0.0359 *  
allocation_groupGrupo B   0.13948    0.16652  72.04671   0.838   0.4050    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) visit 
visit       -0.580       
allctn_grGB -0.598  0.040</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model3_log)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Results_main_outcomes_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(model3_log)); <span class="fu">qqline</span>(<span class="fu">resid</span>(model3_log))  <span class="co"># Normality check</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Results_main_outcomes_files/figure-html/unnamed-chunk-12-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>log+1 transformation</strong> to the skewed CRP variable, and the results show clear improvement.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 21%">
<col style="width: 21%">
<col style="width: 21%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Term</strong></th>
<th><strong>Estimate</strong></th>
<th><strong>p-value</strong></th>
<th><strong>Interpretation</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Intercept</strong></td>
<td>1.82</td>
<td>&lt;0.001</td>
<td>Mean <strong>log(CRP + 1)</strong> at baseline in Grupo A</td>
</tr>
<tr class="even">
<td><strong>Visit</strong></td>
<td>â€“0.099</td>
<td>0.036</td>
<td><strong>CRP decreases significantly over time</strong></td>
</tr>
<tr class="odd">
<td><strong>Grupo B (vs A)</strong></td>
<td>+0.139</td>
<td>0.405</td>
<td>No significant difference at baseline</td>
</tr>
</tbody>
</table>
<p>The <strong>effect of visit became statistically significant</strong> (p = 0.036), whereas it was borderline before (p = 0.072).</p>
<p><strong>Diagnostic Plots</strong> <strong>Residuals vs.&nbsp;Fitted</strong></p>
<ul>
<li><p>More <strong>symmetrical and homoscedastic</strong> than before.</p></li>
<li><p>No clear fan shape or funnel â€” much better than untransformed.</p></li>
</ul>
<p><strong>Q-Q Plot</strong></p>
<ul>
<li><p><strong>Much closer to the line</strong>, indicating that residuals are approximately <strong>normally distributed</strong>.</p></li>
<li><p>A few expected mild deviations at the tails, but very acceptable.</p></li>
</ul>
<p><strong>What does this mean in original CRP scale?</strong></p>
<p>Letâ€™s back-transform the time effect:</p>
<ul>
<li><p>Estimate for visit = â€“0.099</p></li>
<li><p>Since youâ€™re modeling log1p(CRP), to interpret in original scale:</p></li>
</ul>
<p><span class="math display">\[\\text{exp}(-0.099) = 0.9056\]</span></p>
<p>This means: <strong>each visit is associated with ~9.4% decrease</strong> in CRP over time, <strong>on average</strong>.</p>
<p><strong>Summary</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><strong>Point</strong></th>
<th><strong>Result</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Residuals</td>
<td>Look better: less heteroscedasticity</td>
</tr>
<tr class="even">
<td>Q-Q plot</td>
<td>Much closer to normal</td>
</tr>
<tr class="odd">
<td>Time effect</td>
<td>Now statistically significant (p = 0.036)</td>
</tr>
<tr class="even">
<td>Log transformation</td>
<td>Successfully improved model performance</td>
</tr>
</tbody>
</table>
<p>The idea is to explore the antiinflamatory effect of the intervention. Currently, the model assumes parallel time trends for both groups, i.e., it estimates:</p>
<ul>
<li><p>A main effect of time (CRP changes over time),</p></li>
<li><p>A main effect of group (baseline difference),</p></li>
<li><p>But no interaction (i.e., it assumes both groups change equally over time).</p></li>
</ul>
<p><em>Why this is not enough</em></p>
<p>If the intervention is effective, we expect:</p>
<ul>
<li><p>CRP to decrease faster in the intervention group (Grupo B),</p></li>
<li><p>Which means there should be a significant interaction between visit and allocation_group.</p></li>
</ul>
<p><em>Model with interaction:</em></p>
<ul>
<li><p>Adds visit:allocation_groupGrupo B as an interaction term,</p></li>
<li><p>Tests whether CRP changes differently over time in Grupo B vs Grupo A.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>model3_log_inter <span class="ot">&lt;-</span> <span class="fu">lmer</span>(<span class="fu">log1p</span>(labs_crp) <span class="sc">~</span> visit <span class="sc">*</span> allocation_group <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> record_id), <span class="at">data =</span> data_filtered)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model3_log_inter)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML. t-tests use Satterthwaite's method [
lmerModLmerTest]
Formula: log1p(labs_crp) ~ visit * allocation_group + (1 | record_id)
   Data: data_filtered

REML criterion at convergence: 359

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.0555 -0.4762 -0.0015  0.4387  4.6384 

Random effects:
 Groups    Name        Variance Std.Dev.
 record_id (Intercept) 0.413    0.6426  
 Residual              0.217    0.4658  
Number of obs: 174, groups:  record_id, 75

Fixed effects:
                               Estimate Std. Error        df t value Pr(&gt;|t|)
(Intercept)                     1.78653    0.16260 162.42929  10.987   &lt;2e-16
visit                          -0.07858    0.06281 103.85234  -1.251    0.214
allocation_groupGrupo B         0.21990    0.23207 164.19818   0.948    0.345
visit:allocation_groupGrupo B  -0.04706    0.09450 106.26543  -0.498    0.620
                                 
(Intercept)                   ***
visit                            
allocation_groupGrupo B          
visit:allocation_groupGrupo B    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) visit  all_GB
visit       -0.691              
allctn_grGB -0.701  0.484       
vst:llct_GB  0.459 -0.665 -0.696</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model3_log_inter)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Results_main_outcomes_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(model3_log_inter)); <span class="fu">qqline</span>(<span class="fu">resid</span>(model3_log_inter))  <span class="co"># Normality check</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Results_main_outcomes_files/figure-html/unnamed-chunk-13-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Key Result: No Significant Interaction â€¢ The term visit:allocation_groupGrupo B has p = 0.620, meaning: There is no statistical evidence that the intervention led to a greater reduction in CRP over time compared to control. â€¢ The trend for CRP decrease over time is similar in both groups.</p>
<p>Interpretation</p>
<p>Despite applying a more appropriate transformation and including the interaction: â€¢ Time still shows a mild (non-significant) decreasing trend in CRP. â€¢ No baseline difference between groups. â€¢ No enhanced effect in the intervention group.</p>
<p>This means that, based on your data, the intervention did not show a measurable anti-inflammatory effect on CRP.</p>
<p><em>PLOT</em> plot shows: â€¢ Predicted log(CRP + 1) at each visit for each group. â€¢ Makes it easy to compare time trends across intervention and control groups on the same scale used in the model. â€¢ Useful for statistical interpretation and checking for meaningful differences.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new data frame for prediction: all combinations of visit Ã— group</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>new_data <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">visit =</span> <span class="fu">unique</span>(data_filtered<span class="sc">$</span>visit),</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">allocation_group =</span> <span class="fu">unique</span>(data_filtered<span class="sc">$</span>allocation_group)</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict fixed effects (marginal means, no random effects)</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>new_data<span class="sc">$</span>pred_log_crp <span class="ot">&lt;-</span> <span class="fu">predict</span>(model3_log_inter, <span class="at">newdata =</span> new_data, <span class="at">re.form =</span> <span class="cn">NA</span>)</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot predicted log(CRP + 1)</span></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(new_data, <span class="fu">aes</span>(<span class="at">x =</span> visit, <span class="at">y =</span> pred_log_crp, <span class="at">color =</span> allocation_group, <span class="at">group =</span> allocation_group)) <span class="sc">+</span></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Predicted CRP over Time (log scale)"</span>,</span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Predicted log(CRP + 1)"</span>,</span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Visit"</span>,</span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Group"</span></span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
â„¹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Results_main_outcomes_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><em>Visual Insights</em></p>
<ul>
<li><p>Both groups show a downward trend in CRP over time, suggesting a general anti-inflammatory progression.</p></li>
<li><p>Grupo B starts at a higher baseline and appears to have a slightly steeper decline in log(CRP), although the interaction term was not statistically significant (p = 0.620).</p></li>
</ul>
<p>This means that although Grupo B appears to improve more, this difference in slopes is not statistically supported.</p>
<p><em>Grupo Bâ€™s Higher Baseline</em></p>
<p>Baseline imbalance may be a concern, particularly when:</p>
<ol type="1">
<li><p>The groups were supposed to be randomized and equivalent at baseline, and</p></li>
<li><p>The outcome variable (CRP, in this case) is already higher in one group before the intervention starts.</p></li>
</ol>
<p>If Grupo B starts with higher CRP, then:</p>
<ul>
<li><p>Any greater absolute reduction over time may be due to regression to the mean, not the intervention.</p></li>
<li><p>It violates the assumption that both groups are comparable at baseline, which undermines causal inference.</p></li>
</ul>
<p><em>Adjust for baseline differences:</em></p>
<p>What this model does:</p>
<ul>
<li><p>Adjusts for baseline CRP directly, reducing bias from initial imbalance.</p></li>
<li><p>The coefficient for allocation_groupGrupo B now reflects the difference at follow-up, controlling for baseline.</p></li>
<li><p>The time effect (visit) still captures change over time.</p></li>
<li><p>The model tests whether the intervention group had lower CRP over time than expected based on their higher starting levels.</p></li>
</ul>
<p>If log1p_baseline_crp is significant, it means initial inflammation strongly predicts future levels â€” expected in longitudinal biomarkers.</p>
<p>If allocation_groupGrupo B or the visit:group interaction becomes significant after adjustment, that strengthens the case for a true treatment effect.</p>
<p>Let me know if youâ€™d like to: â€¢ Visualize adjusted predictions â€¢ Back-transform to original CRP scale â€¢ Handle this in a subset of visits (e.g.&nbsp;only V1 and V3)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusting for Baseline CRP in the Mixed Model (on log scale)</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Create a baseline CRP variable (log-transformed)</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="co"># You should ensure that baseline CRP is correctly identified from your data</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: assuming visit 1 is baseline</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>data_filtered <span class="ot">&lt;-</span> data_filtered <span class="sc">%&gt;%</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(record_id) <span class="sc">%&gt;%</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">log1p_baseline_crp =</span> <span class="fu">first</span>(<span class="fu">log1p</span>(labs_crp[visit <span class="sc">==</span> <span class="dv">1</span>]))) <span class="sc">%&gt;%</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Fit the adjusted model</span></span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>model3_log_adj <span class="ot">&lt;-</span> <span class="fu">lmer</span>(</span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">log1p</span>(labs_crp) <span class="sc">~</span> visit <span class="sc">+</span> allocation_group <span class="sc">+</span> log1p_baseline_crp <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> record_id),</span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_filtered</span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Summarize the results</span></span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model3_log_adj)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML. t-tests use Satterthwaite's method [
lmerModLmerTest]
Formula: log1p(labs_crp) ~ visit + allocation_group + log1p_baseline_crp +  
    (1 | record_id)
   Data: data_filtered

REML criterion at convergence: 250.9

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-5.6658 -0.3818 -0.0163  0.4173  3.2431 

Random effects:
 Groups    Name        Variance Std.Dev.
 record_id (Intercept) 0.03532  0.1879  
 Residual              0.19927  0.4464  
Number of obs: 174, groups:  record_id, 75

Fixed effects:
                          Estimate Std. Error         df t value Pr(&gt;|t|)    
(Intercept)               0.529463   0.128682 138.565919   4.114 6.62e-05 ***
visit                    -0.105934   0.043048 129.081368  -2.461   0.0152 *  
allocation_groupGrupo B  -0.008376   0.082322  75.417846  -0.102   0.9192    
log1p_baseline_crp        0.771625   0.050795  76.008799  15.191  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) visit  all_GB
visit       -0.595              
allctn_grGB -0.264  0.069       
lg1p_bsln_c -0.653 -0.035 -0.118</code></pre>
</div>
</div>
<p>This model directly controls for <strong>baseline differences in CRP</strong>, correcting the bias introduced by the fact that <strong>Grupo B started with higher inflammation</strong>.</p>
<p><strong>Fixed Effects Summary</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 38%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Term</strong></th>
<th><strong>Estimate</strong></th>
<th><strong>p-value</strong></th>
<th><strong>Interpretation</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>(Intercept)</strong></td>
<td>0.529</td>
<td>&lt;0.001</td>
<td>Estimated log(CRP+1) for Grupo A at baseline when baseline CRP is 0</td>
</tr>
<tr class="even">
<td><strong>visit</strong></td>
<td>â€“0.106</td>
<td><strong>0.015</strong></td>
<td>CRP significantly <strong>decreases over time</strong></td>
</tr>
<tr class="odd">
<td><strong>Grupo B (vs Grupo A)</strong></td>
<td>â€“0.008</td>
<td>0.919</td>
<td>No difference between groups <strong>after adjusting for baseline</strong></td>
</tr>
<tr class="even">
<td><strong>log1p_baseline_crp</strong></td>
<td>+0.772</td>
<td>&lt;0.001</td>
<td>Strong predictor: higher baseline CRP leads to higher follow-up CRP</td>
</tr>
</tbody>
</table>
<p><strong>Key Takeaways</strong></p>
<ul>
<li><p><strong>Time effect (visit) is now significant (p = 0.015)</strong>:</p>
<blockquote class="blockquote">
<p>CRP decreases over time <strong>even after accounting for baseline</strong>.</p>
</blockquote></li>
<li><p><strong>Grupo B effect disappears (p = 0.919)</strong>:</p>
<blockquote class="blockquote">
<p>Once you adjust for baseline CRP, thereâ€™s <strong>no evidence the intervention had a distinct effect</strong> on CRP reduction compared to control.</p>
</blockquote></li>
<li><p><strong>Baseline CRP is a major driver</strong> of later CRP (Î² = 0.77, p &lt; 0.001).</p></li>
</ul>
<p><strong>Interpretation</strong></p>
<p>The original difference in CRP trends between groups was likely due to <strong>baseline imbalance</strong>, not the intervention itself.</p>
<p>This adjusted model is <strong>more reliable</strong>, and the results suggest:</p>
<ul>
<li><p>CRP decreases over time for all participants,</p></li>
<li><p>But the intervention <strong>did not produce a differential anti-inflammatory effect</strong>.</p></li>
</ul>
<p><strong>Dropout Influence</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Step 1: Check the distribution of visits per subject</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Count number of observations per subject</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>dropout_check <span class="ot">&lt;-</span> data_filtered <span class="sc">%&gt;%</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(record_id) <span class="sc">%&gt;%</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n_visits =</span> <span class="fu">n_distinct</span>(visit)) <span class="sc">%&gt;%</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(n_visits)</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Step 2: Compare dropout by group</span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Last visit per subject</span></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>last_visit_by_group <span class="ot">&lt;-</span> data_filtered <span class="sc">%&gt;%</span></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(record_id, allocation_group) <span class="sc">%&gt;%</span></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">last_visit =</span> <span class="fu">max</span>(visit)) <span class="sc">%&gt;%</span></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'record_id'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Table: proportion reaching visit 3</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(last_visit_by_group<span class="sc">$</span>allocation_group, last_visit_by_group<span class="sc">$</span>last_visit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         
           1  2  3
  Grupo A  6  4 27
  Grupo B  8  4 26</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This checks whether Grupo B had more missing data at later visits than Grupo A â€” which could confound the CRP trajectory comparison.</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Step 3: Is dropout related to baseline CRP?</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="co"># If participants who dropped out had higher baseline CRP, your results may be biased due to non-random missingness (MNAR).</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the baseline CRP and check whether it's different in dropouts</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>baseline_dropout <span class="ot">&lt;-</span> data_filtered <span class="sc">%&gt;%</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(record_id) <span class="sc">%&gt;%</span></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">last_visit =</span> <span class="fu">max</span>(visit)) <span class="sc">%&gt;%</span></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(visit <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dropped_out =</span> last_visit <span class="sc">&lt;</span> <span class="dv">3</span>)</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare baseline CRP by dropout status</span></span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(<span class="fu">log1p</span>(labs_crp) <span class="sc">~</span> dropped_out, <span class="at">data =</span> baseline_dropout)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  log1p(labs_crp) by dropped_out
t = 1.3607, df = 39.345, p-value = 0.1813
alternative hypothesis: true difference in means between group FALSE and group TRUE is not equal to 0
95 percent confidence interval:
 -0.1355451  0.6932685
sample estimates:
mean in group FALSE  mean in group TRUE 
           1.867912            1.589051 </code></pre>
</div>
</div>
<pre><code>â€¢   Participants who dropped out had slightly lower CRP at baseline, but the difference is not statistically significant.
â€¢   Thereâ€™s no evidence that dropout was related to baseline inflammation.
â€¢   Dropout appears to be random with respect to baseline CRP, which supports the Missing at Random (MAR) assumption.</code></pre>
<p>Because: â€¢ The mixed-effects model (LMM) is valid under MAR, â€¢ Thereâ€™s no significant baseline CRP difference between those who stayed and those who dropped out,</p>
<p>Your model results are likely unbiased with respect to dropout.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Back-transforming predicted log(CRP + 1) values to CRP (mg/L)</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Create a prediction grid for all combinations of visit Ã— group</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the median baseline CRP for prediction (in log1p scale)</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>baseline_crp_median <span class="ot">&lt;-</span> <span class="fu">median</span>(<span class="fu">log1p</span>(baseline_dropout<span class="sc">$</span>labs_crp), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create grid of new data</span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>new_data <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">visit =</span> <span class="fu">unique</span>(data_filtered<span class="sc">$</span>visit),</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">allocation_group =</span> <span class="fu">unique</span>(data_filtered<span class="sc">$</span>allocation_group)</span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">log1p_baseline_crp =</span> baseline_crp_median)</span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Predict from the adjusted model (fixed effects only)</span></span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a>new_data<span class="sc">$</span>pred_log <span class="ot">&lt;-</span> <span class="fu">predict</span>(model3_log_adj, <span class="at">newdata =</span> new_data, <span class="at">re.form =</span> <span class="cn">NA</span>)</span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Back-transform</span></span>
<span id="cb65-18"><a href="#cb65-18" aria-hidden="true" tabindex="-1"></a>new_data<span class="sc">$</span>pred_crp <span class="ot">&lt;-</span> <span class="fu">exp</span>(new_data<span class="sc">$</span>pred_log) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb65-19"><a href="#cb65-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-20"><a href="#cb65-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Plot back-transformed predictions</span></span>
<span id="cb65-21"><a href="#cb65-21" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(new_data, <span class="fu">aes</span>(<span class="at">x =</span> visit, <span class="at">y =</span> pred_crp, <span class="at">color =</span> allocation_group, <span class="at">group =</span> allocation_group)) <span class="sc">+</span></span>
<span id="cb65-22"><a href="#cb65-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb65-23"><a href="#cb65-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb65-24"><a href="#cb65-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb65-25"><a href="#cb65-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Predicted CRP Levels Over Time (Back-Transformed)"</span>,</span>
<span id="cb65-26"><a href="#cb65-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Visit"</span>,</span>
<span id="cb65-27"><a href="#cb65-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Predicted CRP (mg/L)"</span>,</span>
<span id="cb65-28"><a href="#cb65-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Group"</span></span>
<span id="cb65-29"><a href="#cb65-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb65-30"><a href="#cb65-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Results_main_outcomes_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>What this plot shows</p>
<pre><code>â€¢   Predicted CRP levels in mg/L, adjusted for the median baseline CRP.
â€¢   Makes the model output clinically interpretable.</code></pre>
<p>You can clearly see: â€¢ The overall downward trend in CRP over time. â€¢ That Grupo B does not differ from Grupo A in rate of CRP decline after adjusting for baseline.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add confidence intervals to predicted CRP plot (back-transformed)</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Load required packages</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(merTools)  <span class="co"># for predictInterval</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: arm</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: MASS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'MASS'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    select</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
arm (Version 1.14-4, built: 2024-4-1)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Working directory is /Users/gustavosplmoura/Library/Mobile Documents/com~apple~CloudDocs/Medicina/Biblioteca/Data Science/Data Science/R_Projects_Research/DVEP</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'arm'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:performance':

    display</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Create new data with baseline CRP held at median</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>baseline_crp_median <span class="ot">&lt;-</span> <span class="fu">median</span>(<span class="fu">log1p</span>(baseline_dropout<span class="sc">$</span>labs_crp), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>new_data <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">visit =</span> <span class="fu">unique</span>(data_filtered<span class="sc">$</span>visit),</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">allocation_group =</span> <span class="fu">unique</span>(data_filtered<span class="sc">$</span>allocation_group)</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">log1p_baseline_crp =</span> baseline_crp_median,</span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">record_id =</span> <span class="st">"dummy"</span>  <span class="co"># Add a dummy ID to match model's grouping variable</span></span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Get prediction intervals on log scale (includes uncertainty)</span></span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># for reproducibility</span></span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a>pred_int <span class="ot">&lt;-</span> <span class="fu">predictInterval</span>(</span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a>  model3_log_adj,</span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> new_data,</span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">level =</span> <span class="fl">0.95</span>,</span>
<span id="cb76-19"><a href="#cb76-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">n.sims =</span> <span class="dv">1000</span>,</span>
<span id="cb76-20"><a href="#cb76-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">stat =</span> <span class="st">"mean"</span>,</span>
<span id="cb76-21"><a href="#cb76-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"linear.prediction"</span>,</span>
<span id="cb76-22"><a href="#cb76-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">include.resid.var =</span> <span class="cn">FALSE</span></span>
<span id="cb76-23"><a href="#cb76-23" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning:      The following levels of record_id from newdata 
 -- dummy -- are not in the model data. 
     Currently, predictions for these values are based only on the 
 fixed coefficients and the observation-level error.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine with original new_data</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>new_data <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(new_data, pred_int)</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Back-transform</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>new_data <span class="ot">&lt;-</span> new_data <span class="sc">%&gt;%</span></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">fit =</span> <span class="fu">exp</span>(fit) <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">lwr =</span> <span class="fu">exp</span>(lwr) <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">upr =</span> <span class="fu">exp</span>(upr) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Plot with ribbons (CI)</span></span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(new_data, <span class="fu">aes</span>(<span class="at">x =</span> visit, <span class="at">y =</span> fit, <span class="at">color =</span> allocation_group, <span class="at">group =</span> allocation_group)) <span class="sc">+</span></span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lwr, <span class="at">ymax =</span> upr, <span class="at">fill =</span> allocation_group), <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Predicted CRP Levels with 95% CI (Back-Transformed)"</span>,</span>
<span id="cb78-19"><a href="#cb78-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Predicted CRP (mg/L)"</span>,</span>
<span id="cb78-20"><a href="#cb78-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Visit"</span>,</span>
<span id="cb78-21"><a href="#cb78-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Group"</span>,</span>
<span id="cb78-22"><a href="#cb78-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Group"</span></span>
<span id="cb78-23"><a href="#cb78-23" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb78-24"><a href="#cb78-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Results_main_outcomes_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Optional: Line plot of individual trajectories</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_filtered, <span class="fu">aes</span>(<span class="at">x =</span> visit, <span class="at">y =</span> labs_crp, <span class="at">group =</span> record_id, <span class="at">color =</span> allocation_group)) <span class="sc">+</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Individual CRP Trajectories (Raw Data)"</span>,</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Observed CRP (mg/L)"</span>,</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Visit"</span>,</span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Group"</span></span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 12 rows containing missing values or values outside the scale range
(`geom_line()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 15 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Results_main_outcomes_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="section-1" class="level3">
<h3 class="anchored" data-anchor-id="section-1">2</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>data_filtered_lmm <span class="ot">&lt;-</span> data_filtered <span class="sc">%&gt;%</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(record_id) <span class="sc">%&gt;%</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>model4_log <span class="ot">&lt;-</span> <span class="fu">lmer</span>(<span class="fu">log1p</span>(labs_crp) <span class="sc">~</span> visit <span class="sc">+</span> bmi <span class="sc">+</span> age <span class="sc">+</span> sex <span class="sc">+</span> dass_score_stress <span class="sc">+</span> </span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>     labs_hba1c <span class="sc">+</span> labs_ggt <span class="sc">+</span> labs_triglycerides <span class="sc">+</span> allocation_group <span class="sc">+</span> </span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>     (<span class="dv">1</span> <span class="sc">|</span> record_id), <span class="at">data =</span> data_filtered_lmm)</span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model4_log)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML. t-tests use Satterthwaite's method [
lmerModLmerTest]
Formula: log1p(labs_crp) ~ visit + bmi + age + sex + dass_score_stress +  
    labs_hba1c + labs_ggt + labs_triglycerides + allocation_group +  
    (1 | record_id)
   Data: data_filtered_lmm

REML criterion at convergence: 260.1

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.0965 -0.4761  0.0079  0.4576  3.9622 

Random effects:
 Groups    Name        Variance Std.Dev.
 record_id (Intercept) 0.3083   0.5553  
 Residual              0.2502   0.5002  
Number of obs: 103, groups:  record_id, 61

Fixed effects:
                          Estimate Std. Error         df t value Pr(&gt;|t|)   
(Intercept)             -2.9172883  1.4955248 81.3986059  -1.951  0.05454 . 
visit                   -0.1034030  0.0550179 41.8942409  -1.879  0.06715 . 
bmi                      0.1130495  0.0410467 79.3316852   2.754  0.00729 **
age                     -0.0148058  0.0106836 59.1960337  -1.386  0.17099   
sexMasculino            -0.5116809  0.2786086 54.6626748  -1.837  0.07172 . 
dass_score_stress        0.0001941  0.0081992 89.7066088   0.024  0.98117   
labs_hba1c               0.3224812  0.1110692 68.3963949   2.903  0.00496 **
labs_ggt                 0.0001671  0.0035339 75.5998101   0.047  0.96241   
labs_triglycerides      -0.0007923  0.0013128 91.8399906  -0.604  0.54766   
allocation_groupGrupo B  0.2106135  0.1802660 49.7850831   1.168  0.24823   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) visit  bmi    age    sxMscl dss_s_ lbs_h1 lbs_gg lbs_tr
visit       -0.150                                                        
bmi         -0.896  0.111                                                 
age          0.028 -0.042 -0.227                                          
sexMasculin -0.080  0.064  0.036 -0.056                                   
dss_scr_str -0.045  0.212 -0.134  0.287  0.160                            
labs_hba1c  -0.477 -0.045  0.218 -0.342  0.122 -0.033                     
labs_ggt     0.056 -0.015 -0.143  0.177 -0.177  0.065 -0.094              
lbs_trglycr  0.143 -0.003 -0.135 -0.059 -0.166  0.030 -0.252 -0.151       
allctn_grGB -0.067  0.041 -0.005 -0.139  0.156 -0.021  0.152 -0.095 -0.031</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model3_log)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Results_main_outcomes_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(model3_log)); <span class="fu">qqline</span>(<span class="fu">resid</span>(model3_log))  <span class="co"># Normality check```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Results_main_outcomes_files/figure-html/unnamed-chunk-20-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>