<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="S.P.L.M., Gustavo">
<meta name="dcterms.date" content="2025-05-21">

<title>Main outcomes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Results_main_outcomes_files/libs/clipboard/clipboard.min.js"></script>
<script src="Results_main_outcomes_files/libs/quarto-html/quarto.js"></script>
<script src="Results_main_outcomes_files/libs/quarto-html/popper.min.js"></script>
<script src="Results_main_outcomes_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Results_main_outcomes_files/libs/quarto-html/anchor.min.js"></script>
<link href="Results_main_outcomes_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Results_main_outcomes_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Results_main_outcomes_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Results_main_outcomes_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Results_main_outcomes_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul class="collapse">
  <li><a href="#getting-started" id="toc-getting-started" class="nav-link active" data-scroll-target="#getting-started">Getting started</a>
  <ul class="collapse">
  <li><a href="#load-data" id="toc-load-data" class="nav-link" data-scroll-target="#load-data">Load data</a></li>
  <li><a href="#variables-of-interest" id="toc-variables-of-interest" class="nav-link" data-scroll-target="#variables-of-interest">Variables of interest</a></li>
  <li><a href="#select-variables" id="toc-select-variables" class="nav-link" data-scroll-target="#select-variables">Select variables</a></li>
  <li><a href="#scaling" id="toc-scaling" class="nav-link" data-scroll-target="#scaling">Scaling</a></li>
  </ul></li>
  <li><a href="#phase-angle" id="toc-phase-angle" class="nav-link" data-scroll-target="#phase-angle">Phase angle</a>
  <ul class="collapse">
  <li><a href="#modelo-1" id="toc-modelo-1" class="nav-link" data-scroll-target="#modelo-1">Modelo 1</a></li>
  <li><a href="#modelo-2" id="toc-modelo-2" class="nav-link" data-scroll-target="#modelo-2">Modelo 2</a></li>
  <li><a href="#modelo-3" id="toc-modelo-3" class="nav-link" data-scroll-target="#modelo-3">Modelo 3</a></li>
  </ul></li>
  <li><a href="#pcr" id="toc-pcr" class="nav-link" data-scroll-target="#pcr">PCR</a>
  <ul class="collapse">
  <li><a href="#per-protocol" id="toc-per-protocol" class="nav-link" data-scroll-target="#per-protocol">Per protocol</a></li>
  </ul></li>
  <li><a href="#pam" id="toc-pam" class="nav-link" data-scroll-target="#pam">PAM</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="Results_main_outcomes.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Main outcomes</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>S.P.L.M., Gustavo </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 21, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="getting-started" class="level1">
<h1>Getting started</h1>
<section id="load-data" class="level2">
<h2 class="anchored" data-anchor-id="load-data">Load data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">graphics.off</span>()</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\014</span><span class="st">"</span>)  <span class="co"># Clear any pending RStudio sessions or temporary files</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div style="page-break-after: always;"></div>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load functions from external script</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"helper_functions.R"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Load necessary libraries</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>â”€â”€ Attaching core tidyverse packages â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidyverse 2.0.0 â”€â”€
âœ” dplyr     1.1.4.9000     âœ” readr     2.1.5     
âœ” forcats   1.0.0          âœ” stringr   1.5.1     
âœ” ggplot2   3.5.1          âœ” tibble    3.2.1     
âœ” lubridate 1.9.4          âœ” tidyr     1.3.1     
âœ” purrr     1.0.4          
â”€â”€ Conflicts â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidyverse_conflicts() â”€â”€
âœ– dplyr::filter() masks stats::filter()
âœ– dplyr::lag()    masks stats::lag()
â„¹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>here() starts at /Users/gustavosplmoura/Library/Mobile Documents/com~apple~CloudDocs/Medicina/Biblioteca/Data Science/Data Science/R_Projects_Research/DVEP</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: Matrix

Attaching package: 'Matrix'

The following objects are masked from 'package:tidyr':

    expand, pack, unpack</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'lmerTest'

The following object is masked from 'package:lme4':

    lmer

The following object is masked from 'package:stats':

    step</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(skimr)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Read Files ----</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Codebooks</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>codebook_dvep <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Codebooks/codebook_dvep.xlsx"</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">col_names =</span> <span class="cn">TRUE</span>,</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">col_types =</span> <span class="cn">NULL</span>,</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">na =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">"NA"</span>, <span class="st">"NI"</span>, <span class="st">"UNK"</span>, <span class="st">"NASK"</span>, <span class="st">"ASKU"</span>, <span class="st">"INV"</span>),</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">trim_ws =</span> <span class="cn">TRUE</span>,</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">skip =</span> <span class="dv">0</span>, <span class="co"># Number of lines to skip before reading data</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_max =</span> <span class="cn">Inf</span>, <span class="co"># Maximum number of lines to read.</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">guess_max =</span> <span class="dv">1000</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(index)</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>codebook_structure  <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Codebooks/codebook_structure.csv"</span>,</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">col_names =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 34 Columns: 9
â”€â”€ Column specification â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Delimiter: ","
chr (2): form_name_en, form_name_pt
dbl (7): repeating, eleg, V1, V2, V3, order, variable_count

â„¹ Use `spec()` to retrieve the full column specification for this data.
â„¹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>codebook_ncit  <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Codebooks/codebook_ncit.csv"</span>,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">col_names =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 330 Columns: 4
â”€â”€ Column specification â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Delimiter: ","
chr (2): ncit_code, descriptive
dbl (2): type, medicamentos_comorbidades_complete

â„¹ Use `spec()` to retrieve the full column specification for this data.
â„¹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>codebook_bia <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Codebooks/codebook_bia.xlsx"</span>,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">col_names =</span> <span class="cn">TRUE</span>,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">col_types =</span> <span class="cn">NULL</span>,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">na =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">"NA"</span>, <span class="st">"NI"</span>, <span class="st">"UNK"</span>, <span class="st">"NASK"</span>, <span class="st">"ASKU"</span>, <span class="st">"INV"</span>),</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">trim_ws =</span> <span class="cn">TRUE</span>,</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">skip =</span> <span class="dv">0</span>, <span class="co"># Number of lines to skip before reading data</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_max =</span> <span class="cn">Inf</span>, <span class="co"># Maximum number of lines to read.</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">guess_max =</span> <span class="dv">1000</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(index)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Data</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"Data_processed/data.rds"</span>)</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>data_bia <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"Data_processed/data_bia.rds"</span>)</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>data_bia_D1 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"Data_processed/data_bia_D1.rds"</span>)</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>data_bia_D1_mean <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"Data_processed/data_bia_D1_mean.rds"</span>)</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>data_bia_D1_raw <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"Data_processed/data_bia_D1_raw.rds"</span>)</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>data_bia_D3 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"Data_processed/data_bia_D3.rds"</span>)</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>data_bia_D3_mean <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"Data_processed/data_bia_D3_mean.rds"</span>)</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>data_bia_D3_raw <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"Data_processed/data_bia_D3_raw.rds"</span>)</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>data_bia_mean <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"Data_processed/data_bia_mean.rds"</span>)</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>data_d1_exclusive <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"Data_processed/data_d1_exclusive.rds"</span>)</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>data_filtered <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"Data_processed/data_filtered.rds"</span>)</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>data_filtered_seca <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"Data_processed/data_filtered_seca.rds"</span>)</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>I21_conditions_R <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"Data_processed/I21_conditions_R.rds"</span>)</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>I22_drugs_R <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"Data_processed/I22_drugs_R.rds"</span>)</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>I27_labs_R <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"Data_processed/I27_labs_R.rds"</span>)</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>I29_compliance_new <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"Data_processed/I29_compliance_new.rds"</span>)</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>I30_events_R <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"Data_processed/I30_events_R.rds"</span>)</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a><span class="do">## SUPERTIBBLE</span></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>data_instruments <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"Data_instruments/data_instruments.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="variables-of-interest" class="level2">
<h2 class="anchored" data-anchor-id="variables-of-interest">Variables of interest</h2>
<ul>
<li>(1 | record_id) + visit + allocation_group + age + sex + race + education +</li>
<li>Comorbidities: hypertension + hypercholesterolemia + hypertrigliceridemia + insulin + drugs_w_loss + drugs_w_gain</li>
<li>Anthro: abdomen + bmi + mean_bp_mean</li>
<li>Questionnaires: whoqol_score_overall + ecap_score + evs_score + dass_score_stress + dass_score_anxiety + dass_score_depression + alcohol_significant + smoke_history + carbs_kcal + protein_kcal + fat_kcal + drugs_dose_change_yn +</li>
<li>AdesÃ£o: completed_intervention, intervention_duration, education_years? cp_taking_as_directed_yn, cp_missed_dose_yn, cp_missed_dose_count, cp_discontinued_yn, cp_discontinued_n_days, cp_ran_out_of_drug_yn, cp_medication_confidence_sca</li>
</ul>
</section>
<section id="select-variables" class="level2">
<h2 class="anchored" data-anchor-id="select-variables">Select variables</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>data_model <span class="ot">&lt;-</span> data_filtered <span class="sc">%&gt;%</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>        record_id<span class="sc">:</span>sex,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>        hypertension<span class="sc">:</span>ecap_score,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>        abdomen, bmi, mean_bp_mean,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>        resistance<span class="sc">:</span>evs_score,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>        alcohol_dose, </span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>        carbs_kcal, protein_kcal, fat_kcal, kcal,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>        labs_crp<span class="sc">:</span>labs_alkp,</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>        labs_cholesterol<span class="sc">:</span>labs_quick_index</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    data_model,</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Data_processed/data_model.rds"</span>)</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>vars_to_keep <span class="ot">&lt;-</span> <span class="fu">names</span>(data_model)</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: filter codebook_dvep</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>codebook_data_model <span class="ot">&lt;-</span> codebook_dvep <span class="sc">%&gt;%</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(variable <span class="sc">%in%</span> vars_to_keep) <span class="sc">%&gt;%</span> </span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>        variable, label_pt, field_type, choices)</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>    codebook_data_model,</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Data_processed/codebook_data_model.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="scaling" class="level2">
<h2 class="anchored" data-anchor-id="scaling">Scaling</h2>
<p><span class="math display">\[{QUICKI} = \frac{1}{\\log(insulin) + log(glucose)}\]</span></p>
<p><span class="math display">\[
HOMA-IR = \frac{insulin * glucose}{405}
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>data_model_scaled <span class="ot">&lt;-</span> data_model <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">.cols =</span> <span class="fu">c</span>(</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>        duration_difference, age,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>        whoqol_score_overall, dass_score_depression, dass_score_anxiety,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>        dass_score_stress, ecap_score, </span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>        abdomen, bmi, mean_bp_mean,</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>        resistance, reactance, </span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>        handgrip, evs_score, alcohol_dose,</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>        carbs_kcal, protein_kcal, fat_kcal, kcal,</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>        labs_crp, labs_ast, labs_alt, labs_ggt, labs_alkp,</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>        labs_cholesterol, labs_ldl, labs_hba1c, labs_triglycerides,</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>        labs_hdl, labs_glucose, labs_insulin, labs_homa_ir</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">.fns =</span> <span class="sc">~</span> <span class="fu">as.numeric</span>(<span class="fu">scale</span>(.))</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>scaling_params <span class="ot">&lt;-</span> data_model <span class="sc">%&gt;%</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">.cols =</span> <span class="fu">c</span>(</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>      duration_difference, age,</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>      whoqol_score_overall, dass_score_depression, dass_score_anxiety,</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>      dass_score_stress, ecap_score, </span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>      abdomen, bmi, mean_bp_mean,</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>      resistance, reactance, </span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>      handgrip, evs_score, alcohol_dose,</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>      carbs_kcal, protein_kcal, fat_kcal,</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>      labs_crp, labs_ast, labs_alt, labs_ggt, labs_alkp,</span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>      labs_cholesterol, labs_ldl, labs_hba1c, labs_triglycerides,</span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>      labs_hdl, labs_glucose, labs_insulin, labs_homa_ir</span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">mean =</span> <span class="sc">~</span><span class="fu">mean</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">sd =</span> <span class="sc">~</span><span class="fu">sd</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(),</span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">"variable"</span>, <span class="st">".value"</span>),</span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_sep =</span> <span class="st">"_(?=[^_]+$)"</span>,  <span class="co"># ðŸ‘ˆ this fixes the splitting</span></span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_transform =</span> <span class="fu">list</span>(<span class="at">.value =</span> as.character))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># THEN, FOR NEW DATA</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>scale_with_params <span class="ot">&lt;-</span> <span class="cf">function</span>(new_data, params) {</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(params))) {</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    var <span class="ot">&lt;-</span> params<span class="sc">$</span>variable[i]</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    mean_val <span class="ot">&lt;-</span> params<span class="sc">$</span>mean[i]</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    sd_val <span class="ot">&lt;-</span> params<span class="sc">$</span>sd[i]</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (var <span class="sc">%in%</span> <span class="fu">names</span>(new_data)) {</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>      new_data[[var]] <span class="ot">&lt;-</span> (new_data[[var]] <span class="sc">-</span> mean_val) <span class="sc">/</span> sd_val</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(new_data)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>new_data_scaled <span class="ot">&lt;-</span> <span class="fu">scale_with_params</span>(new_data, scaling_params)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="phase-angle" class="level1">
<h1>Phase angle</h1>
<p>Filtrando os dados da primeira e terceira visitas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>pha_redcap <span class="ot">&lt;-</span> data_model_scaled <span class="sc">%&gt;%</span> </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>        visit <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">compliance_score_visit =</span> <span class="fu">case_when</span>(</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>            visit <span class="sc">==</span> <span class="dv">3</span> <span class="sc">&amp;</span> completed_intervention <span class="sc">==</span> <span class="st">"NÃ£o"</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>            <span class="cn">TRUE</span> <span class="sc">~</span> compliance_score_visit</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="modelo-1" class="level2">
<h2 class="anchored" data-anchor-id="modelo-1">Modelo 1</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>pha_1 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(phase_angle <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> record_id) <span class="sc">+</span> visit <span class="sc">+</span> allocation_group <span class="sc">+</span> completed_intervention <span class="sc">+</span> duration_difference <span class="sc">+</span> age <span class="sc">+</span> sex <span class="sc">+</span> hypertension <span class="sc">+</span> hypercholesterolemia <span class="sc">+</span> hypertrigliceridemia <span class="sc">+</span> drugs_w_loss <span class="sc">+</span> drugs_w_gain <span class="sc">+</span> mean_bp_mean <span class="sc">+</span> handgrip <span class="sc">+</span> evs_score <span class="sc">+</span> alcohol_dose <span class="sc">+</span> kcal <span class="sc">+</span> labs_crp <span class="sc">+</span> labs_alt <span class="sc">+</span> labs_ggt <span class="sc">+</span> labs_ldl <span class="sc">+</span> labs_triglycerides <span class="sc">+</span> labs_hdl <span class="sc">+</span> labs_quick_index, <span class="at">data =</span> pha_redcap)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pha_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML. t-tests use Satterthwaite's method [
lmerModLmerTest]
Formula: 
phase_angle ~ (1 | record_id) + visit + allocation_group + completed_intervention +  
    duration_difference + age + sex + hypertension + hypercholesterolemia +  
    hypertrigliceridemia + drugs_w_loss + drugs_w_gain + mean_bp_mean +  
    handgrip + evs_score + alcohol_dose + kcal + labs_crp + labs_alt +  
    labs_ggt + labs_ldl + labs_triglycerides + labs_hdl + labs_quick_index
   Data: pha_redcap

REML criterion at convergence: 267.6

Scaled residuals: 
     Min       1Q   Median       3Q      Max 
-1.56730 -0.34461 -0.02411  0.32517  2.31790 

Random effects:
 Groups    Name        Variance Std.Dev.
 record_id (Intercept) 0.7246   0.8513  
 Residual              0.1072   0.3274  
Number of obs: 111, groups:  record_id, 73

Fixed effects:
                          Estimate Std. Error       df t value Pr(&gt;|t|)    
(Intercept)                6.80702    1.14545 54.72940   5.943 2.02e-07 ***
visit                      0.04367    0.05999 39.61741   0.728 0.470955    
allocation_groupGrupo B   -0.08294    0.23322 58.16739  -0.356 0.723419    
completed_interventionSim  0.13431    0.29025 62.80942   0.463 0.645154    
duration_difference        0.06796    0.07531 35.47525   0.902 0.372926    
age                       -0.15807    0.13498 60.83001  -1.171 0.246148    
sexMasculino               0.09460    0.47396 83.73697   0.200 0.842285    
hypertension1             -0.41606    0.30355 64.58323  -1.371 0.175222    
hypercholesterolemia1      0.19062    0.27727 69.89339   0.687 0.494049    
hypertrigliceridemia1     -0.34038    0.27433 76.54222  -1.241 0.218477    
drugs_w_loss1             -0.25530    0.26664 55.83333  -0.957 0.342447    
drugs_w_gain1             -0.66202    0.56551 57.08713  -1.171 0.246602    
mean_bp_mean               0.18737    0.09217 82.46459   2.033 0.045275 *  
handgrip                   0.02906    0.12915 84.31928   0.225 0.822503    
evs_score                  0.02820    0.06771 51.41295   0.417 0.678762    
alcohol_dose               0.25024    0.06910 55.31084   3.621 0.000637 ***
kcal                       0.08493    0.07469 64.71213   1.137 0.259686    
labs_crp                   0.12545    0.05608 35.78386   2.237 0.031613 *  
labs_alt                  -0.07563    0.08133 60.52700  -0.930 0.356110    
labs_ggt                   0.02983    0.10259 78.08587   0.291 0.771980    
labs_ldl                  -0.11607    0.09391 52.71421  -1.236 0.221990    
labs_triglycerides         0.04481    0.07352 35.85978   0.610 0.545998    
labs_hdl                  -0.02374    0.08890 81.65491  -0.267 0.790104    
labs_quick_index          -1.07713    3.09369 48.37580  -0.348 0.729223    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Correlation matrix not shown by default, as p = 24 &gt; 12.
Use print(x, correlation=TRUE)  or
    vcov(x)        if you need it</code></pre>
</div>
</div>
<p>A modelagem estatÃ­stica foi conduzida por meio de um modelo linear misto, com intercepto aleatÃ³rio por participante (record_id), ajustado pelo mÃ©todo de mÃ¡xima verossimilhanÃ§a restrita (REML). O desfecho avaliado foi o Ã¢ngulo de fase, e todas as variÃ¡veis contÃ­nuas foram previamente padronizadas (mÃ©dia = 0; desvio padrÃ£o = 1), com exceÃ§Ã£o do Ã­ndice QUICKI, mantido em sua unidade original para favorecer a interpretabilidade clÃ­nica. A variÃ¡vel duration_difference representa o desvio absoluto (em dias) da duraÃ§Ã£o planejada da intervenÃ§Ã£o (90 dias), sendo ajustada para zero na linha de base e posteriormente padronizada.</p>
<p>O modelo incluiu 24 preditores fixos e apresentou bom ajuste, com critÃ©rio REML igual a 267,6 [um valor inferior ao do modelo anterior (REML = 275)], indicando melhora na parcimÃ´nia e qualidade do ajuste apÃ³s a reduÃ§Ã£o de variÃ¡veis.</p>
<p><strong>Efeitos fixos</strong></p>
<p>TrÃªs variÃ¡veis demonstraram associaÃ§Ã£o estatisticamente significativa com o desfecho:</p>
<ul>
<li>PressÃ£o arterial mÃ©dia (mean_bp_mean): apresentou associaÃ§Ã£o positiva com o Ã¢ngulo de fase (Î² = 0,19; p = 0,045), sugerindo que nÃ­veis mais elevados de pressÃ£o arterial podem estar relacionados a melhor integridade funcional da membrana celular.</li>
<li>Dose de Ã¡lcool (alcohol_dose): foi o preditor com maior significÃ¢ncia estatÃ­stica (Î² = 0,25; p &lt; 0,001), com associaÃ§Ã£o positiva ao Ã¢ngulo de fase. Este achado deve ser interpretado com cautela, podendo refletir fatores comportamentais, sociais ou nutricionais nÃ£o diretamente capturados no modelo.</li>
<li>ProteÃ­na C reativa (labs_crp): demonstrou associaÃ§Ã£o positiva marginalmente significativa (Î² = 0,13; p = 0,032), o que pode sugerir uma relaÃ§Ã£o complexa entre inflamaÃ§Ã£o subclÃ­nica e alteraÃ§Ãµes na composiÃ§Ã£o ou integridade celular.</li>
</ul>
<p>As demais variÃ¡veis â€” incluindo visit, allocation_group, completed_intervention, duration_difference, alÃ©m de variÃ¡veis laboratoriais como labs_ldl, labs_triglycerides e labs_quick_index â€” nÃ£o apresentaram associaÃ§Ãµes estatisticamente significativas com o desfecho.</p>
<p><strong>Efeitos aleatÃ³rios</strong></p>
<p>A variÃ¢ncia associada ao intercepto aleatÃ³rio por participante foi de 0,72, enquanto a variÃ¢ncia residual foi de 0,11. Esse achado demonstra que hÃ¡ considerÃ¡vel variabilidade entre os indivÃ­duos, reforÃ§ando a pertinÃªncia da inclusÃ£o do componente aleatÃ³rio no modelo. Em outras palavras, parte substancial da variabilidade total no Ã¢ngulo de fase Ã© explicada por diferenÃ§as interindividuais, o que justifica o uso de modelos mistos para melhor estimar os efeitos fixos, controlando tais variaÃ§Ãµes basais.</p>
<p><strong>ConsideraÃ§Ãµes metodolÃ³gicas</strong></p>
<ol type="1">
<li>Multicolinearidade: Dada a inclusÃ£o de 24 preditores em um modelo com 111 observaÃ§Ãµes, recomenda-se avaliar a presenÃ§a de colinearidade, especialmente entre variÃ¡veis clÃ­nicas e laboratoriais potencialmente redundantes. Sugere-se a aplicaÃ§Ã£o da funÃ§Ã£o performance::check_collinearity() para investigar VIFs elevados, que podem inflar erros padrÃ£o e comprometer a interpretaÃ§Ã£o dos coeficientes.</li>
<li>ReduÃ§Ã£o de preditores: A elevada razÃ£o entre o nÃºmero de preditores e o tamanho da amostra (p &gt; n/4) pode levar a sobreajuste (overfitting) e instabilidade nos coeficientes. Uma abordagem sugerida Ã© a reduÃ§Ã£o guiada por critÃ©rios de informaÃ§Ã£o (AIC) ou penalizaÃ§Ã£o via regressÃ£o LASSO (glmnet), com o objetivo de selecionar subconjuntos mais estÃ¡veis de variÃ¡veis.</li>
<li>AvaliaÃ§Ã£o da qualidade do ajuste: Recomenda-se utilizar a funÃ§Ã£o performance::check_model() para verificar a normalidade dos resÃ­duos, homocedasticidade e presenÃ§a de observaÃ§Ãµes influentes. AlÃ©m disso, a obtenÃ§Ã£o dos valores de RÂ² marginal e condicional pode auxiliar na compreensÃ£o da proporÃ§Ã£o da variÃ¢ncia explicada pelo modelo fixo e pelo modelo completo (incluindo os efeitos aleatÃ³rios).</li>
<li>Tratamento da variÃ¡vel visit: Embora visit nÃ£o tenha apresentado significÃ¢ncia estatÃ­stica no modelo atual, trata-se de uma variÃ¡vel importante, dado o delineamento longitudinal do estudo. Deve-se avaliar se o uso de visit como variÃ¡vel contÃ­nua linear Ã© adequado ou se uma estrutura categÃ³rica com interaÃ§Ã£o (e.g., visit*allocation_group) ou a inclusÃ£o de um termo de inclinaÃ§Ã£o aleatÃ³ria por visita ((visit | record_id)) poderia capturar melhor as trajetÃ³rias individuais ao longo do tempo.</li>
</ol>
<p><strong>AvaliaÃ§Ã£o da Multicolinearidade</strong></p>
<p>Dada a inclusÃ£o de um nÃºmero elevado de preditores no modelo (n = 24), avaliou-se a presenÃ§a de multicolinearidade utilizando o Fator de InflaÃ§Ã£o da VariÃ¢ncia (VIF) por meio da funÃ§Ã£o performance::check_collinearity().</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">check_collinearity</span>(pha_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Check for Multicollinearity

Low Correlation

                   Term  VIF   VIF 95% CI Increased SE Tolerance
                  visit 2.64 [2.13, 3.38]         1.63      0.38
       allocation_group 1.24 [1.10, 1.57]         1.11      0.81
 completed_intervention 1.54 [1.31, 1.93]         1.24      0.65
    duration_difference 2.07 [1.71, 2.63]         1.44      0.48
                    age 1.67 [1.40, 2.10]         1.29      0.60
                    sex 2.41 [1.96, 3.07]         1.55      0.41
           hypertension 1.51 [1.29, 1.90]         1.23      0.66
   hypercholesterolemia 1.64 [1.39, 2.07]         1.28      0.61
   hypertrigliceridemia 1.71 [1.44, 2.15]         1.31      0.58
           drugs_w_loss 1.20 [1.08, 1.54]         1.10      0.83
           drugs_w_gain 1.13 [1.03, 1.52]         1.06      0.88
           mean_bp_mean 1.84 [1.53, 2.32]         1.36      0.54
               handgrip 1.94 [1.61, 2.46]         1.39      0.51
              evs_score 1.31 [1.15, 1.65]         1.14      0.76
           alcohol_dose 1.48 [1.27, 1.85]         1.22      0.68
                   kcal 1.67 [1.41, 2.10]         1.29      0.60
               labs_crp 1.22 [1.09, 1.56]         1.10      0.82
               labs_alt 1.48 [1.27, 1.85]         1.22      0.68
               labs_ggt 1.65 [1.39, 2.07]         1.28      0.61
               labs_ldl 1.69 [1.42, 2.12]         1.30      0.59
     labs_triglycerides 1.48 [1.27, 1.86]         1.22      0.67
               labs_hdl 1.32 [1.15, 1.66]         1.15      0.76
       labs_quick_index 1.23 [1.09, 1.56]         1.11      0.82
 Tolerance 95% CI
     [0.30, 0.47]
     [0.64, 0.91]
     [0.52, 0.76]
     [0.38, 0.59]
     [0.48, 0.71]
     [0.33, 0.51]
     [0.53, 0.77]
     [0.48, 0.72]
     [0.46, 0.70]
     [0.65, 0.93]
     [0.66, 0.97]
     [0.43, 0.65]
     [0.41, 0.62]
     [0.61, 0.87]
     [0.54, 0.79]
     [0.48, 0.71]
     [0.64, 0.92]
     [0.54, 0.79]
     [0.48, 0.72]
     [0.47, 0.70]
     [0.54, 0.79]
     [0.60, 0.87]
     [0.64, 0.92]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># r2(pha_1)  # Marginal and conditional RÂ²</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Resultados:</p>
<p>Todos os preditores apresentaram VIFs inferiores a 3, indicando ausÃªncia de multicolinearidade preocupante. Os valores variaram entre 1,13 e 2,64, o que representa correlaÃ§Ãµes lineares fracas a moderadas entre os preditores, sem risco aparente de distorÃ§Ãµes nas estimativas dos coeficientes.</p>
<p>Abaixo, apresenta-se a interpretaÃ§Ã£o convencional dos valores de VIF:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 74%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Valor de VIF</strong></th>
<th><strong>InterpretaÃ§Ã£o</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>AusÃªncia de correlaÃ§Ã£o com outras variÃ¡veis</td>
</tr>
<tr class="even">
<td>1â€“2</td>
<td>CorrelaÃ§Ã£o baixa â€” sem motivo de preocupaÃ§Ã£o</td>
</tr>
<tr class="odd">
<td>2â€“5</td>
<td>CorrelaÃ§Ã£o moderada â€” acompanhar com atenÃ§Ã£o</td>
</tr>
<tr class="even">
<td>5â€“10</td>
<td>CorrelaÃ§Ã£o elevada â€” risco de instabilidade</td>
</tr>
<tr class="odd">
<td>&gt; 10</td>
<td>Multicolinearidade severa â€” intervenÃ§Ã£o necessÃ¡ria</td>
</tr>
</tbody>
</table>
<ol start="2" type="1">
<li>ReduÃ§Ã£o do Modelo</li>
</ol>
<p>O modelo atual inclui 24 preditores fixos, o que, diante de uma amostra com 111 observaÃ§Ãµes, pode comprometer o poder estatÃ­stico e a interpretabilidade dos resultados devido ao risco de sobreajuste (overfitting).</p>
<p>A escolha da melhor abordagem para simplificar o modelo depende do objetivo central da anÃ¡lise:</p>
<ol type="a">
<li>Modelos orientados por desempenho (prediÃ§Ã£o)</li>
</ol>
<p>Caso o foco seja a performance preditiva, o uso de estratÃ©gias orientadas por dados Ã© mais apropriado:</p>
<ul>
<li><p>SeleÃ§Ã£o stepwise (backward) com base em critÃ©rios de informaÃ§Ã£o como AIC ou BIC. O AIC favorece modelos com melhor ajuste (ainda que mais complexos), enquanto o BIC impÃµe maior penalidade Ã  complexidade, favorecendo modelos mais parcimoniosos.</p></li>
<li><p>RegressÃ£o penalizada via LASSO (glmnet), que tende a selecionar subconjuntos estÃ¡veis de variÃ¡veis ao impor penalizaÃ§Ãµes sobre os coeficientes, sendo especialmente Ãºtil em situaÃ§Ãµes com colinearidade moderada e alta dimensionalidade de preditores.</p></li>
</ul>
<ol start="2" type="a">
<li>Modelos orientados por inferÃªncia e explicaÃ§Ã£o</li>
</ol>
<p>Quando o objetivo principal Ã© a interpretaÃ§Ã£o causal ou explicativa, como em estudos clÃ­nicos e intervenÃ§Ãµes, a estratÃ©gia mais robusta Ã© a reduÃ§Ã£o teÃ³rica guiada por plausibilidade clÃ­nica. Essa abordagem inclui:</p>
<ul>
<li><p>RemoÃ§Ã£o de variÃ¡veis com baixa significÃ¢ncia estatÃ­stica e sem fundamento teÃ³rico forte;</p></li>
<li><p>ExclusÃ£o de variÃ¡veis redundantes ou fortemente correlacionadas (ex.: manter labs_quick_index e excluir glicemia/insulina);</p></li>
<li><p>AtenÃ§Ã£o a comportamentos instÃ¡veis dos coeficientes â€” por exemplo, quando a direÃ§Ã£o (sinal) de um coeficiente muda com a inclusÃ£o de outras variÃ¡veis, indicando colinearidade ou sobreposiÃ§Ã£o de efeitos.</p></li>
</ul>
<ol start="3" type="a">
<li>EstratÃ©gia hÃ­brida recomendada</li>
</ol>
<p>Uma estratÃ©gia combinada, adequada ao contexto de ensaio clÃ­nico com mÃºltiplas covariÃ¡veis, pode envolver: 1. Fixar um conjunto mÃ­nimo de variÃ¡veis-chave (ex.: idade, sexo, grupo de intervenÃ§Ã£o, tempo); 2. Aplicar reduÃ§Ã£o stepwise ou LASSO nas demais covariÃ¡veis; 3. Comparar modelos reduzidos com o modelo completo utilizando ANOVA (anova()), grÃ¡ficos de resÃ­duos e critÃ©rios de ajuste (REML, AIC, BIC), assegurando que a simplificaÃ§Ã£o nÃ£o comprometa o desempenho do modelo.</p>
<ol start="3" type="1">
<li>AvaliaÃ§Ã£o do Ajuste do Modelo</li>
</ol>
<p>A verificaÃ§Ã£o dos pressupostos estatÃ­sticos do modelo pha_1 foi realizada com a funÃ§Ã£o performance::check_model(). Os principais achados foram:</p>
<ul>
<li><p>Ajuste geral: Os grÃ¡ficos de verificaÃ§Ã£o preditiva (posterior predictive checks) mostraram boa sobreposiÃ§Ã£o entre os valores observados e os preditos, indicando adequaÃ§Ã£o geral do modelo.</p></li>
<li><p>ResÃ­duos vs.&nbsp;valores ajustados: Foi observado leve desvio da horizontalidade nas faixas mais altas do desfecho, sugerindo possÃ­vel violaÃ§Ã£o da linearidade para valores elevados do Ã¢ngulo de fase.</p></li>
<li><p>Homoscedasticidade: Detectou-se aumento da variÃ¢ncia dos resÃ­duos com o aumento dos valores preditos, caracterizando uma leve violaÃ§Ã£o da homocedasticidade.</p></li>
<li><p>Normalidade dos resÃ­duos: Os resÃ­duos apresentaram distribuiÃ§Ã£o aproximadamente normal, com pequenas assimetrias nas caudas â€” aceitÃ¡veis em modelos mistos com amostras de tamanho moderado.</p></li>
<li><p>InfluÃªncia de observaÃ§Ãµes: Algumas observaÃ§Ãµes apresentaram leve influÃªncia (IDs 10, 69, 70, 75, 109), mas nenhuma ultrapassou os limiares crÃ­ticos para alavancagem ou resÃ­duos padronizados extremos.</p></li>
<li><p>Colinearidade: Todos os VIFs estiveram abaixo de 3, indicando ausÃªncia de multicolinearidade significativa.</p></li>
<li><p>Efeitos aleatÃ³rios: A distribuiÃ§Ã£o dos interceptos aleatÃ³rios (por record_id) se aproximou da normalidade, reforÃ§ando a adequaÃ§Ã£o da estrutura hierÃ¡rquica adotada.</p></li>
</ul>
<ol start="5" type="1">
<li>Refinamento da VariÃ¡vel visit</li>
</ol>
<p>Dado o delineamento longitudinal do estudo, a variÃ¡vel visit merece atenÃ§Ã£o especial. No modelo atual, visit foi incluÃ­da como efeito fixo com estrutura linear. No entanto, isso pode ser subÃ³timo caso o efeito do tempo varie entre participantes.</p>
<p>Tentativas de incorporar uma inclinaÃ§Ã£o aleatÃ³ria por visit resultaram em:</p>
<pre><code>lmer(phase_angle ~ visit + (visit | record_id), data = ...)
# Erro: nÃºmero de observaÃ§Ãµes (=111) â‰¤ nÃºmero de efeitos aleatÃ³rios (=146)</code></pre>
<p>Isso indica que hÃ¡ insuficiÃªncia de dados para estimar uma estrutura tÃ£o complexa. A alternativa:</p>
<pre><code>lmer(phase_angle ~ visit + (1 + visit || record_id), data = ...)
# Resultado: ajuste singular (boundary (singular) fit)</code></pre>
<p>Esse ajuste singular significa que o modelo nÃ£o consegue estimar a variÃ¢ncia da inclinaÃ§Ã£o aleatÃ³ria para visit de forma confiÃ¡vel, sugerindo ausÃªncia de variaÃ§Ã£o individual suficiente ou tamanho amostral limitado para suportar tal estrutura.</p>
<p>ConclusÃ£o:</p>
<p>No momento, manter visit como efeito fixo linear Ã© estatisticamente mais robusto. Caso haja interesse em investigar mudanÃ§as especÃ­ficas ao longo das visitas, uma abordagem alternativa seria tratar visit como variÃ¡vel categÃ³rica e incluir interaÃ§Ãµes com allocation_group, por exemplo:</p>
<pre><code>phase_angle ~ allocation_group * factor(visit) + ...</code></pre>
<p>Essa estrutura permite verificar se a evoluÃ§Ã£o do Ã¢ngulo de fase ao longo do tempo difere entre os grupos, sem sobrecarregar o modelo com componentes aleatÃ³rios instÃ¡veis.</p>
</section>
<section id="modelo-2" class="level2">
<h2 class="anchored" data-anchor-id="modelo-2">Modelo 2</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>pha_2 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(phase_angle <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> record_id) <span class="sc">+</span> visit <span class="sc">+</span> allocation_group <span class="sc">+</span> age <span class="sc">+</span> sex <span class="sc">+</span> bmi <span class="sc">+</span> mean_bp_mean <span class="sc">+</span> handgrip <span class="sc">+</span> evs_score <span class="sc">+</span> kcal <span class="sc">+</span> labs_crp <span class="sc">+</span> labs_alt <span class="sc">+</span> labs_ggt <span class="sc">+</span> labs_ldl <span class="sc">+</span> labs_triglycerides <span class="sc">+</span> labs_hdl <span class="sc">+</span> labs_quick_index, <span class="at">data =</span> pha_redcap)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pha_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML. t-tests use Satterthwaite's method [
lmerModLmerTest]
Formula: phase_angle ~ (1 | record_id) + visit + allocation_group + age +  
    sex + bmi + mean_bp_mean + handgrip + evs_score + kcal +  
    labs_crp + labs_alt + labs_ggt + labs_ldl + labs_triglycerides +  
    labs_hdl + labs_quick_index
   Data: pha_redcap

REML criterion at convergence: 275.6

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-2.1820 -0.3023 -0.0278  0.2559  3.6054 

Random effects:
 Groups    Name        Variance Std.Dev.
 record_id (Intercept) 0.5811   0.7623  
 Residual              0.1780   0.4219  
Number of obs: 111, groups:  record_id, 73

Fixed effects:
                         Estimate Std. Error        df t value Pr(&gt;|t|)    
(Intercept)              7.082490   1.176374 77.136367   6.021 5.51e-08 ***
visit                   -0.004178   0.060460 47.468510  -0.069   0.9452    
allocation_groupGrupo B -0.252382   0.214787 64.288710  -1.175   0.2443    
age                     -0.187470   0.105337 65.806508  -1.780   0.0797 .  
sexMasculino             0.335406   0.456188 84.261799   0.735   0.4642    
bmi                      0.010733   0.097621 89.559042   0.110   0.9127    
mean_bp_mean             0.174320   0.096937 93.792525   1.798   0.0753 .  
handgrip                 0.077031   0.130670 92.345158   0.590   0.5570    
evs_score                0.035996   0.073279 74.994735   0.491   0.6247    
kcal                     0.026568   0.080627 77.299814   0.330   0.7427    
labs_crp                 0.080876   0.065164 51.402275   1.241   0.2202    
labs_alt                -0.001230   0.085298 88.062468  -0.014   0.9885    
labs_ggt                 0.026733   0.096885 82.285184   0.276   0.7833    
labs_ldl                -0.064943   0.090663 92.475432  -0.716   0.4756    
labs_triglycerides       0.015440   0.079832 62.011443   0.193   0.8473    
labs_hdl                 0.002898   0.092120 93.997884   0.031   0.9750    
labs_quick_index        -1.886146   3.435802 75.554696  -0.549   0.5846    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Correlation matrix not shown by default, as p = 17 &gt; 12.
Use print(x, correlation=TRUE)  or
    vcov(x)        if you need it</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>AIC(pha_1, pha_2) df AIC pha_1 26 319.5554 pha_2 19 313.6283</p>
</blockquote>
<blockquote class="blockquote">
<p>BIC(pha_1, pha_2) df BIC pha_1 26 390.0032 pha_2 19 365.1094</p>
</blockquote>
<p>A comparaÃ§Ã£o entre os modelos pelo critÃ©rio de informaÃ§Ã£o de Akaike (AIC) e o critÃ©rio bayesiano de informaÃ§Ã£o (BIC) favoreceu o modelo reduzido (pha_2), que apresentou valores mais baixos de AIC (313,6 vs.&nbsp;319,6) e BIC (365,1 vs.&nbsp;390,0) em relaÃ§Ã£o ao modelo completo (pha_1). Isso sugere que a simplificaÃ§Ã£o do modelo resultou em melhor equilÃ­brio entre ajuste e complexidade, mesmo com a perda de significÃ¢ncia estatÃ­stica de algumas covariÃ¡veis previamente relevantes. No entanto, vÃ¡rias variÃ¡veis de relevÃ¢ncia clÃ­nica foram eliminadas neste modelo. Por este motivo, um terceiro modelo foi criado, incluindo as variÃ¡veis de relevÃ¢ncia clÃ­nica que nÃ£o foram incluÃ­das no modelo 2.</p>
</section>
<section id="modelo-3" class="level2">
<h2 class="anchored" data-anchor-id="modelo-3">Modelo 3</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>pha_3 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(phase_angle <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> record_id) <span class="sc">+</span> visit <span class="sc">+</span> allocation_group <span class="sc">+</span> completed_intervention <span class="sc">+</span> duration_difference <span class="sc">+</span> age <span class="sc">+</span> sex <span class="sc">+</span> hypertension <span class="sc">+</span> hypercholesterolemia <span class="sc">+</span> hypertrigliceridemia <span class="sc">+</span> drugs_w_loss <span class="sc">+</span> drugs_w_gain <span class="sc">+</span> mean_bp_mean <span class="sc">+</span> handgrip <span class="sc">+</span> evs_score <span class="sc">+</span> alcohol_dose <span class="sc">+</span> kcal <span class="sc">+</span> labs_crp <span class="sc">+</span> labs_ldl <span class="sc">+</span> labs_quick_index, <span class="at">data =</span> pha_redcap)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pha_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML. t-tests use Satterthwaite's method [
lmerModLmerTest]
Formula: 
phase_angle ~ (1 | record_id) + visit + allocation_group + completed_intervention +  
    duration_difference + age + sex + hypertension + hypercholesterolemia +  
    hypertrigliceridemia + drugs_w_loss + drugs_w_gain + mean_bp_mean +  
    handgrip + evs_score + alcohol_dose + kcal + labs_crp + labs_ldl +  
    labs_quick_index
   Data: pha_redcap

REML criterion at convergence: 256.2

Scaled residuals: 
     Min       1Q   Median       3Q      Max 
-1.67542 -0.37054 -0.01038  0.28131  2.47511 

Random effects:
 Groups    Name        Variance Std.Dev.
 record_id (Intercept) 0.6800   0.8246  
 Residual              0.1089   0.3300  
Number of obs: 111, groups:  record_id, 73

Fixed effects:
                          Estimate Std. Error       df t value Pr(&gt;|t|)    
(Intercept)                6.73199    1.12618 62.54202   5.978 1.18e-07 ***
visit                      0.04629    0.05831 39.70014   0.794  0.43198    
allocation_groupGrupo B   -0.08824    0.22558 60.66392  -0.391  0.69704    
completed_interventionSim  0.09468    0.27813 63.80928   0.340  0.73466    
duration_difference        0.06221    0.07418 37.43891   0.839  0.40701    
age                       -0.14627    0.13082 63.16447  -1.118  0.26776    
sexMasculino               0.05360    0.44022 84.14001   0.122  0.90339    
hypertension1             -0.37768    0.29365 65.31066  -1.286  0.20294    
hypercholesterolemia1      0.13976    0.26480 72.33121   0.528  0.59926    
hypertrigliceridemia1     -0.21111    0.23292 62.70194  -0.906  0.36822    
drugs_w_loss1             -0.25216    0.25896 58.72682  -0.974  0.33419    
drugs_w_gain1             -0.64500    0.54712 60.02599  -1.179  0.24308    
mean_bp_mean               0.18141    0.08674 82.54798   2.092  0.03955 *  
handgrip                   0.04801    0.12342 88.77623   0.389  0.69823    
evs_score                  0.03655    0.06602 54.80914   0.554  0.58207    
alcohol_dose               0.24846    0.06783 59.87919   3.663  0.00053 ***
kcal                       0.09010    0.07346 72.69290   1.227  0.22393    
labs_crp                   0.11992    0.05502 40.88103   2.180  0.03509 *  
labs_ldl                  -0.09732    0.08787 60.12632  -1.108  0.27247    
labs_quick_index          -0.90144    3.03633 57.49316  -0.297  0.76762    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Correlation matrix not shown by default, as p = 20 &gt; 12.
Use print(x, correlation=TRUE)  or
    vcov(x)        if you need it</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_collinearity</span>(pha_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Check for Multicollinearity

Low Correlation

                   Term  VIF   VIF 95% CI Increased SE Tolerance
                  visit 2.46 [1.98, 3.18]         1.57      0.41
       allocation_group 1.22 [1.08, 1.58]         1.11      0.82
 completed_intervention 1.49 [1.27, 1.89]         1.22      0.67
    duration_difference 1.99 [1.63, 2.54]         1.41      0.50
                    age 1.65 [1.39, 2.11]         1.29      0.60
                    sex 2.20 [1.79, 2.83]         1.48      0.45
           hypertension 1.50 [1.27, 1.90]         1.22      0.67
   hypercholesterolemia 1.58 [1.34, 2.02]         1.26      0.63
   hypertrigliceridemia 1.30 [1.14, 1.67]         1.14      0.77
           drugs_w_loss 1.20 [1.07, 1.57]         1.10      0.83
           drugs_w_gain 1.12 [1.03, 1.56]         1.06      0.89
           mean_bp_mean 1.65 [1.39, 2.10]         1.29      0.61
               handgrip 1.84 [1.52, 2.35]         1.36      0.54
              evs_score 1.25 [1.11, 1.62]         1.12      0.80
           alcohol_dose 1.44 [1.23, 1.83]         1.20      0.69
                   kcal 1.62 [1.36, 2.06]         1.27      0.62
               labs_crp 1.17 [1.05, 1.55]         1.08      0.86
               labs_ldl 1.50 [1.28, 1.91]         1.23      0.67
       labs_quick_index 1.19 [1.07, 1.56]         1.09      0.84
 Tolerance 95% CI
     [0.31, 0.51]
     [0.63, 0.92]
     [0.53, 0.79]
     [0.39, 0.61]
     [0.48, 0.72]
     [0.35, 0.56]
     [0.53, 0.78]
     [0.50, 0.75]
     [0.60, 0.88]
     [0.64, 0.93]
     [0.64, 0.98]
     [0.48, 0.72]
     [0.42, 0.66]
     [0.62, 0.90]
     [0.55, 0.81]
     [0.48, 0.73]
     [0.65, 0.95]
     [0.52, 0.78]
     [0.64, 0.94]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(pha_1, pha_2, pha_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      df      AIC
pha_1 26 319.5554
pha_2 19 313.6283
pha_3 22 300.2185</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">BIC</span>(pha_1, pha_2, pha_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      df      BIC
pha_1 26 390.0032
pha_2 19 365.1094
pha_3 22 359.8281</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">r2</span>(pha_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># R2 for Mixed Models

  Conditional R2: 0.896
     Marginal R2: 0.250</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>pha_3_plots <span class="ot">&lt;-</span> performance<span class="sc">::</span><span class="fu">check_model</span>(pha_3)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pha_3_plots)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Results_main_outcomes_files/figure-html/pha_3_check-model-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p><strong>ComparaÃ§Ã£o entre Modelos e AvaliaÃ§Ã£o do Ajuste Final</strong></p>
<p>TrÃªs modelos hierÃ¡rquicos foram comparados utilizando os critÃ©rios de informaÃ§Ã£o de Akaike (AIC) e Bayesiano (BIC). O modelo pha_3, contendo 22 preditores fixos e intercepto aleatÃ³rio por participante (record_id), apresentou os menores valores de AIC (300,2) e BIC (359,8), superando o modelo completo pha_1 (AIC = 319,6; BIC = 390,0) e o modelo intermediÃ¡rio pha_2 (AIC = 313,6; BIC = 365,1). Esses resultados indicam que pha_3 representa o melhor equilÃ­brio entre qualidade de ajuste e parcimÃ´nia, sendo selecionado como modelo final para interpretaÃ§Ã£o dos achados.</p>
<p>A construÃ§Ã£o do modelo pha_3 foi guiada por critÃ©rios estatÃ­sticos e clÃ­nicos, priorizando variÃ¡veis com significÃ¢ncia nas versÃµes anteriores, plausibilidade teÃ³rica e estabilidade das estimativas. O modelo manteve 22 preditores e apresentou um critÃ©rio de mÃ¡xima verossimilhanÃ§a restrita (REML) igual a 256,2, inferior ao dos modelos anteriores, reforÃ§ando a melhoria no ajuste.</p>
<p>Entre os preditores avaliados, trÃªs variÃ¡veis mantiveram associaÃ§Ã£o estatisticamente significativa com o desfecho:</p>
<ul>
<li><p>PressÃ£o arterial mÃ©dia (mean_bp_mean): Î² = 0,18; p = 0,040</p></li>
<li><p>Dose de Ã¡lcool (alcohol_dose): Î² = 0,25; p &lt; 0,001</p></li>
<li><p>ProteÃ­na C reativa (labs_crp): Î² = 0,12; p = 0,035</p></li>
</ul>
<p>Essas associaÃ§Ãµes permaneceram robustas mesmo apÃ³s ajuste multivariado, sugerindo que nÃ­veis mais elevados de pressÃ£o arterial, maior consumo de Ã¡lcool e nÃ­veis mais altos de inflamaÃ§Ã£o subclÃ­nica estÃ£o positivamente relacionados ao Ã¢ngulo de fase. A variÃ¡vel visit foi mantida no modelo como controle temporal, apesar de nÃ£o apresentar significÃ¢ncia estatÃ­stica (p = 0,432).</p>
<p>A variÃ¢ncia do intercepto aleatÃ³rio por participante permaneceu elevada (ÏƒÂ² = 0,68), corroborando a presenÃ§a de heterogeneidade individual e justificando a estrutura mista do modelo. O RÂ² marginal foi de 0,250, indicando que 25% da variÃ¢ncia total do desfecho Ã© explicada pelas variÃ¡veis fixas. JÃ¡ o RÂ² condicional foi de 0,896, refletindo a alta proporÃ§Ã£o da variÃ¢ncia explicada ao considerar a estrutura de efeitos aleatÃ³rios, em consonÃ¢ncia com o delineamento longitudinal do estudo.</p>
<p>A anÃ¡lise de multicolinearidade mostrou valores de VIF menor que trÃªs para todos os preditores, descartando problemas relevantes de colinearidade. Os diagnÃ³sticos do modelo indicaram distribuiÃ§Ã£o adequada dos resÃ­duos, ausÃªncia de observaÃ§Ãµes altamente influentes e normalidade satisfatÃ³ria dos efeitos aleatÃ³rios, corroborando a adequaÃ§Ã£o do modelo ajustado.</p>
<p><strong>VerificaÃ§Ã£o dos Pressupostos do Modelo Final</strong></p>
<p>A avaliaÃ§Ã£o dos pressupostos do modelo pha_3 foi realizada com auxÃ­lio da funÃ§Ã£o performance::check_model(), cujos grÃ¡ficos diagnÃ³sticos estÃ£o apresentados na Figura X.</p>
<ul>
<li><p>Posterior Predictive Check: Houve boa sobreposiÃ§Ã£o entre os dados observados e os valores preditos pelo modelo, sugerindo adequada capacidade preditiva.</p></li>
<li><p>Linearidade: Os resÃ­duos apresentaram tendÃªncia de curvatura em valores mais altos do desfecho, o que pode indicar leve violaÃ§Ã£o do pressuposto de linearidade, mas sem evidÃªncias de distorÃ§Ã£o grave.</p></li>
<li><p>Homoscedasticidade: Detectou-se discreto aumento da variabilidade dos resÃ­duos em faixas mais altas dos valores ajustados, sugerindo leve heterocedasticidade.</p></li>
<li><p>Normalidade dos resÃ­duos: A distribuiÃ§Ã£o dos resÃ­duos foi aproximadamente normal, com desvios leves nas caudas, aceitÃ¡veis para modelos mistos em amostras moderadas.</p></li>
<li><p>ObservaÃ§Ãµes influentes: Algumas observaÃ§Ãµes foram marcadas com leve alavancagem (IDs 10, 69, 70, 75, 109), mas todas permaneceram dentro dos limites aceitÃ¡veis de influÃªncia.</p></li>
<li><p>Multicolinearidade: Todos os preditores apresentaram valores de VIF inferiores a 3, afastando preocupaÃ§Ãµes com colinearidade.</p></li>
<li><p>Normalidade dos efeitos aleatÃ³rios (record_id): A distribuiÃ§Ã£o dos interceptos aleatÃ³rios foi prÃ³xima da normal, com leve assimetria nas extremidades, validando a escolha do modelo com intercepto aleatÃ³rio.</p></li>
</ul>
</section>
</section>
<section id="pcr" class="level1">
<h1>PCR</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>data_model_scaled <span class="ot">&lt;-</span> data_model_scaled <span class="sc">%&gt;%</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">compliance_score_adjusted =</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>      visit <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> compliance_score_visit</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">relocate</span>(compliance_score_adjusted, <span class="at">.after =</span> compliance_score_visit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="per-protocol" class="level2">
<h2 class="anchored" data-anchor-id="per-protocol">Per protocol</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>pcr_1 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(<span class="fu">log1p</span>(labs_crp) <span class="sc">~</span> allocation_group <span class="sc">+</span> compliance_score_adjusted <span class="sc">+</span> duration_difference <span class="sc">+</span> completed_intervention <span class="sc">+</span> visit <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> record_id) <span class="sc">+</span> age <span class="sc">+</span> sex <span class="sc">+</span> hypertension <span class="sc">+</span> hypercholesterolemia <span class="sc">+</span> hypertrigliceridemia <span class="sc">+</span> drugs_w_loss <span class="sc">+</span> drugs_w_gain <span class="sc">+</span> mean_bp_mean <span class="sc">+</span> handgrip <span class="sc">+</span> evs_score <span class="sc">+</span> alcohol_dose <span class="sc">+</span> kcal <span class="sc">+</span> labs_alt <span class="sc">+</span> labs_ggt <span class="sc">+</span> labs_ldl <span class="sc">+</span> labs_triglycerides <span class="sc">+</span> labs_hdl <span class="sc">+</span> labs_quick_index, <span class="at">data =</span> data_model_scaled)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pcr_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML. t-tests use Satterthwaite's method [
lmerModLmerTest]
Formula: log1p(labs_crp) ~ allocation_group + compliance_score_adjusted +  
    duration_difference + completed_intervention + visit + (1 |  
    record_id) + age + sex + hypertension + hypercholesterolemia +  
    hypertrigliceridemia + drugs_w_loss + drugs_w_gain + mean_bp_mean +  
    handgrip + evs_score + alcohol_dose + kcal + labs_alt + labs_ggt +  
    labs_ldl + labs_triglycerides + labs_hdl + labs_quick_index
   Data: data_model_scaled

REML criterion at convergence: 270.9

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-1.9776 -0.4639  0.0440  0.4031  3.5646 

Random effects:
 Groups    Name        Variance Std.Dev.
 record_id (Intercept) 0.1726   0.4155  
 Residual              0.3655   0.6045  
Number of obs: 113, groups:  record_id, 73

Fixed effects:
                           Estimate Std. Error        df t value Pr(&gt;|t|)  
(Intercept)                2.051125   1.517983 88.997704   1.351   0.1801  
allocation_groupGrupo B    0.114669   0.177214 57.177922   0.647   0.5202  
compliance_score_adjusted -0.070675   0.760803 67.594288  -0.093   0.9263  
duration_difference       -0.289432   0.109647 70.086341  -2.640   0.0102 *
completed_interventionSim  0.253108   0.236851 75.248146   1.069   0.2886  
visit                      0.000996   0.118454 63.311332   0.008   0.9933  
age                       -0.075131   0.104952 61.040681  -0.716   0.4768  
sexMasculino              -0.189106   0.422447 71.272412  -0.448   0.6558  
hypertension1             -0.008656   0.241732 58.135649  -0.036   0.9716  
hypercholesterolemia1      0.084838   0.225766 59.462524   0.376   0.7084  
hypertrigliceridemia1      0.070291   0.239187 71.888504   0.294   0.7697  
drugs_w_loss1              0.236064   0.199825 56.103355   1.181   0.2424  
drugs_w_gain1              0.342935   0.433023 60.225788   0.792   0.4315  
mean_bp_mean              -0.045777   0.089134 75.839062  -0.514   0.6090  
handgrip                  -0.093359   0.120776 69.249473  -0.773   0.4422  
evs_score                  0.159249   0.079025 87.342114   2.015   0.0470 *
alcohol_dose              -0.034472   0.076281 78.540726  -0.452   0.6526  
kcal                       0.086488   0.084040 87.352683   1.029   0.3063  
labs_alt                  -0.083255   0.086720 78.075422  -0.960   0.3400  
labs_ggt                   0.065429   0.088333 76.825805   0.741   0.4611  
labs_ldl                   0.169339   0.105159 80.809313   1.610   0.1112  
labs_triglycerides        -0.089454   0.100145 83.813542  -0.893   0.3743  
labs_hdl                   0.037371   0.086516 76.750336   0.432   0.6670  
labs_quick_index          -8.513751   3.610444 87.156639  -2.358   0.0206 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Correlation matrix not shown by default, as p = 24 &gt; 12.
Use print(x, correlation=TRUE)  or
    vcov(x)        if you need it</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_collinearity</span>(pcr_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Check for Multicollinearity

Low Correlation

                      Term  VIF   VIF 95% CI Increased SE Tolerance
          allocation_group 1.36 [1.18, 1.71]         1.17      0.73
 compliance_score_adjusted 3.13 [2.50, 4.02]         1.77      0.32
       duration_difference 1.69 [1.42, 2.13]         1.30      0.59
    completed_intervention 1.70 [1.43, 2.14]         1.30      0.59
                     visit 3.66 [2.90, 4.73]         1.91      0.27
                       age 1.87 [1.56, 2.36]         1.37      0.53
                       sex 3.61 [2.86, 4.66]         1.90      0.28
              hypertension 1.92 [1.59, 2.43]         1.39      0.52
      hypercholesterolemia 2.01 [1.66, 2.55]         1.42      0.50
      hypertrigliceridemia 2.48 [2.02, 3.17]         1.58      0.40
              drugs_w_loss 1.29 [1.14, 1.63]         1.14      0.77
              drugs_w_gain 1.18 [1.06, 1.52]         1.09      0.85
              mean_bp_mean 1.54 [1.32, 1.94]         1.24      0.65
                  handgrip 2.64 [2.14, 3.38]         1.63      0.38
                 evs_score 1.39 [1.20, 1.74]         1.18      0.72
              alcohol_dose 1.64 [1.39, 2.06]         1.28      0.61
                      kcal 1.53 [1.30, 1.92]         1.24      0.65
                  labs_alt 1.64 [1.39, 2.07]         1.28      0.61
                  labs_ggt 1.67 [1.41, 2.11]         1.29      0.60
                  labs_ldl 2.11 [1.73, 2.67]         1.45      0.47
        labs_triglycerides 2.13 [1.75, 2.70]         1.46      0.47
                  labs_hdl 1.33 [1.16, 1.67]         1.15      0.75
          labs_quick_index 1.46 [1.26, 1.83]         1.21      0.68
 Tolerance 95% CI
     [0.58, 0.84]
     [0.25, 0.40]
     [0.47, 0.70]
     [0.47, 0.70]
     [0.21, 0.34]
     [0.42, 0.64]
     [0.21, 0.35]
     [0.41, 0.63]
     [0.39, 0.60]
     [0.32, 0.50]
     [0.61, 0.88]
     [0.66, 0.94]
     [0.52, 0.76]
     [0.30, 0.47]
     [0.57, 0.83]
     [0.48, 0.72]
     [0.52, 0.77]
     [0.48, 0.72]
     [0.48, 0.71]
     [0.37, 0.58]
     [0.37, 0.57]
     [0.60, 0.86]
     [0.54, 0.80]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(pcr_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 322.8749</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">BIC</span>(pcr_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 393.787</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">r2</span>(pcr_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># R2 for Mixed Models

  Conditional R2: 0.513
     Marginal R2: 0.283</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>pcr_1_plots <span class="ot">&lt;-</span> performance<span class="sc">::</span><span class="fu">check_model</span>(pcr_1)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pcr_1_plots)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Results_main_outcomes_files/figure-html/pcr_1_check-model-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>Since the goal is to evaluate whether the intervention (allocation_group) reduces inflammation (log1p(labs_crp)), then how compliance-related variables are handled â€” completed_intervention, compliance_score_adjusted, and duration_difference â€” fundamentally changes what question the model is answering.</p>
<p><strong>Key Conceptual Framework</strong></p>
<p>If we adjust for compliance variables, then we are answering the question: Among those who complied (to varying degrees), does the assigned intervention have an effect on inflammation?â€. This estimates the â€œEffect of Treatment on the Treatedâ€ (ETT) or per-protocol effect, rather than the intention-to-treat (ITT) effect. The interpretation shifts towards whether the efficacy of the treatment holds after accounting for how well participants adhered. If participants in the intervention group did not comply, the model adjusts for that, isolating the treatment effect conditional on compliance. However, if compliance is strongly influenced by the intervention (as is common), adjusting for it may introduce <strong>post-treatment bias (collider bias)</strong>, because youâ€™re conditioning on a variable that is downstream of the allocation.</p>
<p>If we do not adjust for compliance, then we are estimating the intention-to-treat (ITT) effect: â€œDoes being assigned to the intervention reduce inflammation, regardless of whether participants fully complied?â€. This reflects the real-world effectiveness including factors like dropout, low adherence, etc. This is the primary approach in most randomized trials because it preserves the randomization balance and avoids bias introduced by post-treatment variables.</p>
<p>In the current model, we are conditioning the effect of allocation_group on adherence. The coefficient for allocation_group in this case answers: â€œGiven the same level of adherence (completion, dose, duration), is the intervention effective in reducing inflammation?â€ In other words, weâ€™re stripping out the pathway by which poor adherence could dilute the intervention effect. If these variables are strong mediators of the interventionâ€™s effect, you are blocking part of the effect of allocation_group, and this might explain why allocation_group is not significant.</p>
<p><strong>Correct Modeling Strategy</strong></p>
<p>Depends on our goal:</p>
<ol type="1">
<li><p>To estimate the pure biological effect of the intervention (conditional on adherence):</p>
<ul>
<li>Keep compliance_score_adjusted, completed_intervention, and duration_difference in the model.</li>
<li>Interpret the effect of allocation_group as the effect assuming equal adherence across groups.</li>
</ul></li>
<li><p>To estimate the real-world effectiveness (intention-to-treat):</p>
<ul>
<li>Remove the compliance-related variables from the model.</li>
<li>The coefficient for allocation_group will capture the total effect, including any dilution due to poor adherence.</li>
</ul></li>
</ol>
<p><img src="images/DAG:%20Relationship%20between%20Intervention,%20Compliance,%20and%20Inflammation.png" class="img-fluid"></p>
<p>The DAG (Directed Acyclic Graph) represents the causal relationships between the intervention, adherence, and inflammation. In this structure, Allocation Group has a direct effect on Inflammation (labs_crp) and also influences Compliance, Completed Intervention, and Duration Difference, which are measures of adherence. These adherence-related variables, in turn, affect Inflammation, indicating that part of the interventionâ€™s effect is mediated through adherence. Additionally, a hypothetical Unmeasured Factors node, representing elements such as motivation, health status, or life circumstances, influences both Compliance and Inflammation. This creates a potential collider if the analysis conditions on adherence-related variables.</p>
<p>The DAG highlights that adjusting for compliance, completion, or duration blocks part of the natural causal pathway through which the intervention affects inflammation. Moreover, conditioning on these variables opens a backdoor path through Unmeasured Factors, introducing potential collider bias.</p>
<p>This structure demonstrates that the choice between intention-to-treat (ITT) and per-protocol (PP) analysis changes the research question. In ITT analysis, the effect of the Allocation Group on inflammation is estimated without conditioning on adherence, capturing the total effect, including both direct and adherence-mediated pathways. This approach preserves the benefits of randomization and estimates the real-world effectiveness of the intervention. In contrast, per-protocol analysis includes adherence-related variables in the model. This blocks the indirect pathways through adherence and estimates the effect of the intervention among participants with comparable adherence. While this approach can answer questions about biological efficacy conditional on adherence, it carries a higher risk of bias due to conditioning on post-randomization variables.</p>
<p><strong>Suggested Dual Approach (Best Practice in Clinical Research)</strong></p>
<ol type="1">
<li>Primary Model (ITT) without compliance variables. This estimates whether the offer of the intervention reduces inflammation.</li>
</ol>
<pre><code>log1p(labs_crp) \~ allocation_group + visit + (1 \| record_id) + covariates</code></pre>
<ol start="2" type="1">
<li>Secondary Model (Per-Protocol Sensitivity Analysis) with compliance variables. This estimates whether the intervention works among those who actually adhered to it, or to account for variability in exposure.</li>
</ol>
<pre><code>log1p(labs_crp) \~ allocation_group + compliance_score_adjusted + duration_difference + completed_intervention + visit + (1 \| record_id) + covariates</code></pre>
<p><strong>Important Note on Mediation vs.&nbsp;Confounding:</strong></p>
<ul>
<li>Compliance is not a confounder â€” it occurs after randomization.</li>
<li>Conditioning on it changes the causal question.</li>
<li>Including post-randomization variables risks collider bias if those variables are influenced by both the intervention and unmeasured factors affecting inflammation.</li>
</ul>
<p><strong>Final Recommendation for Writing in Thesis:</strong></p>
<p>The primary analysis was conducted under the intention-to-treat principle, evaluating the effect of the randomized intervention on inflammation regardless of adherence. A secondary model adjusted for adherence-related variables (completed_intervention, compliance_score_adjusted, and duration_difference) to explore whether the intervention had an effect among those who maintained adequate compliance. These models capture complementary aspects of intervention effectiveness: the former reflects real-world applicability, while the latter reflects efficacy conditional on adequate adherence.</p>
<section id="ideal-condition" class="level3">
<h3 class="anchored" data-anchor-id="ideal-condition">Ideal condition</h3>
<p>The first model (pcr_1) represents a per-protocol-type model, where the effect of the intervention (allocation_group) is estimated conditional on compliance (through compliance_score_adjusted, completed_intervention, and duration_difference). However, there are other methods that can estimate the effect of the intervention in an ideal condition, where adherence is perfect. These methods go beyond simply conditioning in regression and attempt to more rigorously isolate the causal effect.</p>
<p><strong>Alternative and Complementary Strategies to Per-Protocol Modeling</strong></p>
<p><em>1. Restricting the Dataset (Complete Compliers Only)</em></p>
<p>One simple but crude way to perform a per-protocol analysis is to exclude participants who did not complete the intervention or had poor compliance. This creates a model within a population that fully adhered. The limitations are: reduces sample size and breaks randomization, leading to confounding.</p>
<pre><code>data_pp &lt;- data_model_scaled %&gt;%
  filter(completed_intervention == "Yes", compliance_score_adjusted &gt;= threshold)

pcr_pp &lt;- lmer(log1p(labs_crp) ~ allocation_group + visit + (1 | record_id) + covariates, data = data_pp)</code></pre>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>data_pp <span class="ot">&lt;-</span> data_model_scaled <span class="sc">%&gt;%</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>    completed_intervention <span class="sc">==</span> <span class="st">"Sim"</span> <span class="sc">&amp;</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>      (compliance_score_adjusted <span class="sc">&gt;</span> <span class="fl">0.6</span> <span class="sc">|</span> <span class="fu">is.na</span>(compliance_score_adjusted))</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="restrict-dataset" class="level4">
<h4 class="anchored" data-anchor-id="restrict-dataset">Restrict dataset</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>pcr_pp <span class="ot">&lt;-</span> <span class="fu">lmer</span>(<span class="fu">log1p</span>(labs_crp) <span class="sc">~</span> allocation_group <span class="sc">+</span> duration_difference <span class="sc">+</span> visit <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> record_id) <span class="sc">+</span> age <span class="sc">+</span> sex <span class="sc">+</span> hypertension <span class="sc">+</span> hypercholesterolemia <span class="sc">+</span> hypertrigliceridemia <span class="sc">+</span> drugs_w_loss <span class="sc">+</span> drugs_w_gain <span class="sc">+</span> mean_bp_mean <span class="sc">+</span> handgrip <span class="sc">+</span> evs_score <span class="sc">+</span> alcohol_dose <span class="sc">+</span> kcal <span class="sc">+</span> labs_alt <span class="sc">+</span> labs_ggt <span class="sc">+</span> labs_ldl <span class="sc">+</span> labs_triglycerides <span class="sc">+</span> labs_hdl <span class="sc">+</span> labs_quick_index, <span class="at">data =</span> data_pp)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pcr_pp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML. t-tests use Satterthwaite's method [
lmerModLmerTest]
Formula: log1p(labs_crp) ~ allocation_group + duration_difference + visit +  
    (1 | record_id) + age + sex + hypertension + hypercholesterolemia +  
    hypertrigliceridemia + drugs_w_loss + drugs_w_gain + mean_bp_mean +  
    handgrip + evs_score + alcohol_dose + kcal + labs_alt + labs_ggt +  
    labs_ldl + labs_triglycerides + labs_hdl + labs_quick_index
   Data: data_pp

REML criterion at convergence: 211.7

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-1.8596 -0.4588 -0.0302  0.4374  3.4390 

Random effects:
 Groups    Name        Variance Std.Dev.
 record_id (Intercept) 0.1825   0.4272  
 Residual              0.3910   0.6253  
Number of obs: 87, groups:  record_id, 52

Fixed effects:
                        Estimate Std. Error       df t value Pr(&gt;|t|)  
(Intercept)              1.30114    1.51620 59.82978   0.858   0.3942  
allocation_groupGrupo B -0.14874    0.22985 34.14011  -0.647   0.5219  
duration_difference     -0.33950    0.12820 55.59097  -2.648   0.0105 *
visit                    0.03397    0.09415 47.60058   0.361   0.7198  
age                     -0.09053    0.13425 37.86134  -0.674   0.5042  
sexMasculino            -0.18518    0.54147 43.04241  -0.342   0.7340  
hypertension1           -0.01098    0.27901 39.95460  -0.039   0.9688  
hypercholesterolemia1    0.13700    0.26340 35.97741   0.520   0.6062  
hypertrigliceridemia1    0.23126    0.29100 48.64692   0.795   0.4306  
drugs_w_loss1            0.33798    0.23290 35.20711   1.451   0.1556  
drugs_w_gain1           -0.43200    0.63860 54.38832  -0.676   0.5016  
mean_bp_mean             0.06963    0.11975 52.39903   0.581   0.5634  
handgrip                -0.18485    0.15881 46.02477  -1.164   0.2504  
evs_score                0.07079    0.10204 63.29260   0.694   0.4904  
alcohol_dose            -0.08050    0.08772 56.88145  -0.918   0.3626  
kcal                     0.07599    0.09918 60.05920   0.766   0.4466  
labs_alt                -0.18510    0.11358 59.17774  -1.630   0.1085  
labs_ggt                 0.25029    0.19634 51.20579   1.275   0.2081  
labs_ldl                 0.06425    0.12440 56.51527   0.516   0.6075  
labs_triglycerides      -0.09268    0.11221 63.29037  -0.826   0.4119  
labs_hdl                 0.09603    0.11454 53.33588   0.838   0.4056  
labs_quick_index        -5.82536    4.27972 60.08405  -1.361   0.1785  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Correlation matrix not shown by default, as p = 22 &gt; 12.
Use print(x, correlation=TRUE)  or
    vcov(x)        if you need it</code></pre>
</div>
</div>
<p><em>2. Instrumental Variable (IV) Approach or Complier Average Causal Effect (CACE)</em></p>
<p>Use allocation_group as an instrument for treatment receipt/adherence, under the assumption that randomization affects inflammation only via the intervention. This estimates the effect among compliers, without the collider bias introduced by directly conditioning on post-randomization variables. This estimates the effect of actually completing the intervention, using random allocation as an instrument. In R, this can be implemented using <code>ivreg()</code> from the {AER} package or {ivtools}. The syntax is: outcome ~ endogenous + exogenous | instrument + exogenous. However, ivreg does not handle random effects. It assumes independent observations. Since our data has repeated measures (record_id), we should either use only one observation per subject (e.g., endpoint value) or use cluster-robust standard errors to account for within-subject correlation.</p>
<p>Collapsing longitudinal data to one observation per subject for instrumental variable (IV) analysis can be done in multiple ways, each answering a slightly different causal question. The gold standard in biostatistics is the ANCOVA approach, which models the outcome at the final time point while adjusting for the baseline value. This has been shown to be statistically more powerful and less biased than simple change scores when baseline and outcome are correlated. Like in the example:</p>
<pre><code>iv_model &lt;- ivreg(
  log1p(crp_final) ~ completed_intervention + log1p(crp_baseline) + covariates |
  allocation_group + log1p(crp_baseline) + covariates,
  data = data_final
)</code></pre>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract CRP at baseline</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>data_baseline <span class="ot">&lt;-</span> data_model_scaled <span class="sc">%&gt;%</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(visit <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(record_id, labs_crp) <span class="sc">%&gt;%</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">crp_baseline =</span> labs_crp)</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract CRP at final visit</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>data_final <span class="ot">&lt;-</span> data_model_scaled <span class="sc">%&gt;%</span></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(record_id) <span class="sc">%&gt;%</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(visit <span class="sc">==</span> <span class="fu">max</span>(visit)) <span class="sc">%&gt;%</span>  <span class="co"># This selects the final visit for each participant</span></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>    record_id, labs_crp, completed_intervention, compliance_score_adjusted,</span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>    duration_difference, allocation_group, age, sex, hypertension, hypercholesterolemia,</span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a>    hypertrigliceridemia, drugs_w_loss, drugs_w_gain, mean_bp_mean, handgrip, evs_score,</span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>    alcohol_dose, kcal, labs_alt, labs_ggt, labs_ldl, labs_triglycerides, labs_hdl, labs_quick_index</span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">crp_final =</span> labs_crp)</span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a>data_iv <span class="ot">&lt;-</span> data_final <span class="sc">%&gt;%</span></span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(data_baseline, <span class="at">by =</span> <span class="st">"record_id"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Primary IV model that estimates the total effect</strong></p>
<p>The primary IV model that estimates the total effect is designed to evaluate the causal impact of the intervention on inflammation (CRP) as a whole, capturing both the direct effects and any indirect effects mediated by changes in other physiological or metabolic parameters. This model uses random assignment (allocation_group) as an instrument for actual participation or completion of the intervention (completed_intervention), allowing for the estimation of the Complier Average Causal Effect (CACE).</p>
<p>The intent is to answer whether the intervention, when adhered to, leads to a reduction in inflammation, regardless of the biological pathways involved. It reflects the overall therapeutic effect, incorporating all mechanisms through which the intervention may influence CRP. This approach does not adjust for variables that could be affected by the intervention itself (such as blood pressure, lipid levels, or liver enzymes), ensuring that the total causal effect is not inadvertently blocked or biased by post-treatment variables.</p>
</section>
<section id="iv" class="level4">
<h4 class="anchored" data-anchor-id="iv">IV</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: car</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: carData</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'car'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    recode</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:purrr':

    some</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: lmtest</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: zoo</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'zoo'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    as.Date, as.Date.numeric</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: sandwich</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: survival</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>iv_model_total <span class="ot">&lt;-</span> <span class="fu">ivreg</span>(</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">log1p</span>(crp_final) <span class="sc">~</span> compliance_score_adjusted <span class="sc">+</span> <span class="fu">log1p</span>(crp_baseline) <span class="sc">+</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>    age <span class="sc">+</span> sex <span class="sc">+</span> hypertension <span class="sc">+</span> hypercholesterolemia <span class="sc">+</span> hypertrigliceridemia <span class="sc">|</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>  allocation_group <span class="sc">+</span> <span class="fu">log1p</span>(crp_baseline) <span class="sc">+</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>    age <span class="sc">+</span> sex <span class="sc">+</span> hypertension <span class="sc">+</span> hypercholesterolemia <span class="sc">+</span> hypertrigliceridemia,</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_iv</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(iv_model_total)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
ivreg(formula = log1p(crp_final) ~ compliance_score_adjusted + 
    log1p(crp_baseline) + age + sex + hypertension + hypercholesterolemia + 
    hypertrigliceridemia | allocation_group + log1p(crp_baseline) + 
    age + sex + hypertension + hypercholesterolemia + hypertrigliceridemia, 
    data = data_iv)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.1840 -0.3743  0.1873  0.5627  1.7212 

Coefficients:
                          Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)                3.43808    8.23969   0.417    0.678  
compliance_score_adjusted -4.58554    9.74641  -0.470    0.640  
log1p(crp_baseline)        0.67793    0.27287   2.484    0.016 *
age                       -0.39213    0.52078  -0.753    0.455  
sexMasculino              -0.06743    0.44889  -0.150    0.881  
hypertension1              0.48559    0.63892   0.760    0.450  
hypercholesterolemia1     -0.01473    0.66669  -0.022    0.982  
hypertrigliceridemia1     -0.06847    0.39551  -0.173    0.863  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9618 on 55 degrees of freedom
Multiple R-Squared: -0.3381,    Adjusted R-squared: -0.5084 
Wald test: 2.685 on 7 and 55 DF,  p-value: 0.01821 </code></pre>
</div>
</div>
<p><em>3. G-Computation / G-Formula</em></p>
<p>Simulate the outcome under a hypothetical scenario where everyone perfectly adheres to the intervention. This provides an estimate of the expected outcome if all participants had fully complied. R packages: {gfoRmula}, {ltmle}.</p>
<p><em>4. Marginal Structural Models (MSMs) with Inverse Probability Weighting (IPW)</em></p>
<p>Weight participants based on their probability of adhering, creating a pseudo-population where adherence is independent of confounders. This corrects for time-varying confounding affected by prior treatment. This gives an estimate of the intervention effect had everyone adhered as expected. Basic structure using {ipw}:</p>
</section>
<section id="ipw" class="level4">
<h4 class="anchored" data-anchor-id="ipw">IPW</h4>
<p>Complete case analysis (default approach in IPW):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ipw)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>data_model_ipw <span class="ot">&lt;-</span> data_model_scaled <span class="sc">%&gt;%</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>    completed_intervention,</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>    age, sex, hypertension, hypercholesterolemia, hypertrigliceridemia,</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>    drugs_w_loss, drugs_w_gain, mean_bp_mean, handgrip, evs_score,</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>    alcohol_dose, kcal, labs_alt, labs_ggt, labs_ldl, labs_triglycerides,</span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>    labs_hdl, labs_quick_index</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>model_weights <span class="ot">&lt;-</span> <span class="fu">ipwpoint</span>(</span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">exposure =</span> completed_intervention,</span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">"binomial"</span>,</span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">link =</span> <span class="st">"logit"</span>,</span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">denominator =</span> <span class="sc">~</span> </span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a>    age <span class="sc">+</span> sex <span class="sc">+</span> hypertension <span class="sc">+</span> hypercholesterolemia <span class="sc">+</span> hypertrigliceridemia <span class="sc">+</span></span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a>    drugs_w_loss <span class="sc">+</span> drugs_w_gain <span class="sc">+</span> mean_bp_mean <span class="sc">+</span> handgrip <span class="sc">+</span> evs_score <span class="sc">+</span></span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a>    alcohol_dose <span class="sc">+</span> kcal <span class="sc">+</span> labs_alt <span class="sc">+</span> labs_ggt <span class="sc">+</span> labs_ldl <span class="sc">+</span> labs_triglycerides <span class="sc">+</span></span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true" tabindex="-1"></a>    labs_hdl <span class="sc">+</span> labs_quick_index,</span>
<span id="cb79-21"><a href="#cb79-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_model_ipw</span>
<span id="cb79-22"><a href="#cb79-22" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Use simple imputation (if appropriate for your data). Be cautious: imputation is a valid strategy if missingness is assumed to be Missing At Random (MAR) and the variables used for imputation are adequate.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mice)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'mice'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:stats':

    filter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    cbind, rbind</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>data_model_ipw <span class="ot">&lt;-</span> mice<span class="sc">::</span><span class="fu">complete</span>(<span class="fu">mice</span>(data_model_scaled, <span class="at">m =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 iter imp variable
  1   1  compliance_score_adjusted  duration_difference  whoqol_score_overall  dass_score_depression  dass_score_anxiety  dass_score_stress  ecap_score  abdomen  bmi  mean_bp_mean  resistance  reactance  phase_angle  handgrip  evs_score  carbs_kcal  protein_kcal  fat_kcal  kcal  labs_crp  labs_ast  labs_alt  labs_ggt  labs_alkp  labs_cholesterol  labs_ldl  labs_hba1c  labs_triglycerides  labs_hdl  labs_glucose  labs_insulin  labs_homa_ir  labs_quick_index
  2   1  compliance_score_adjusted  duration_difference  whoqol_score_overall  dass_score_depression  dass_score_anxiety  dass_score_stress  ecap_score  abdomen  bmi  mean_bp_mean  resistance  reactance  phase_angle  handgrip  evs_score  carbs_kcal  protein_kcal  fat_kcal  kcal  labs_crp  labs_ast  labs_alt  labs_ggt  labs_alkp  labs_cholesterol  labs_ldl  labs_hba1c  labs_triglycerides  labs_hdl  labs_glucose  labs_insulin  labs_homa_ir  labs_quick_index
  3   1  compliance_score_adjusted  duration_difference  whoqol_score_overall  dass_score_depression  dass_score_anxiety  dass_score_stress  ecap_score  abdomen  bmi  mean_bp_mean  resistance  reactance  phase_angle  handgrip  evs_score  carbs_kcal  protein_kcal  fat_kcal  kcal  labs_crp  labs_ast  labs_alt  labs_ggt  labs_alkp  labs_cholesterol  labs_ldl  labs_hba1c  labs_triglycerides  labs_hdl  labs_glucose  labs_insulin  labs_homa_ir  labs_quick_index
  4   1  compliance_score_adjusted  duration_difference  whoqol_score_overall  dass_score_depression  dass_score_anxiety  dass_score_stress  ecap_score  abdomen  bmi  mean_bp_mean  resistance  reactance  phase_angle  handgrip  evs_score  carbs_kcal  protein_kcal  fat_kcal  kcal  labs_crp  labs_ast  labs_alt  labs_ggt  labs_alkp  labs_cholesterol  labs_ldl  labs_hba1c  labs_triglycerides  labs_hdl  labs_glucose  labs_insulin  labs_homa_ir  labs_quick_index
  5   1  compliance_score_adjusted  duration_difference  whoqol_score_overall  dass_score_depression  dass_score_anxiety  dass_score_stress  ecap_score  abdomen  bmi  mean_bp_mean  resistance  reactance  phase_angle  handgrip  evs_score  carbs_kcal  protein_kcal  fat_kcal  kcal  labs_crp  labs_ast  labs_alt  labs_ggt  labs_alkp  labs_cholesterol  labs_ldl  labs_hba1c  labs_triglycerides  labs_hdl  labs_glucose  labs_insulin  labs_homa_ir  labs_quick_index</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Number of logged events: 75</code></pre>
</div>
</div>
<p><em>5. Bayesian Models with Compliance Modeling</em></p>
<p>Build a hierarchical Bayesian model that explicitly includes a latent compliance variable. Allows direct modeling of counterfactual scenarios under perfect adherence. Add prior distributions reflecting assumptions about compliance mechanisms. Packages: {brms}, {rstanarm}.</p>
<p>Example idea:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">brm</span>(<span class="fu">log1p</span>(labs_crp) <span class="sc">~</span> allocation_group <span class="sc">+</span> compliance_score_adjusted <span class="sc">+</span> visit <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> record_id) <span class="sc">+</span> covariates,</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> data_model_scaled,</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">gaussian</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>Ways to Make Your Current Model More Sensitive to the Intervention</em></p>
<ul>
<li>Focus the population: subset to high compliers or exclude partial compliers.</li>
<li>Model interactions: for example, allocation_group * compliance_score_adjusted to see whether the effect of the intervention depends on levels of compliance.</li>
<li>Use longitudinal modeling more fully: include random slopes for visit to capture differential trajectories over time.</li>
<li>Explore dose-response: instead of binary completed_intervention, use a continuous adherence measure (compliance_score_adjusted) to model the dose-response effect of adherence.</li>
<li>Consider transforming the outcome if distributional assumptions are strained (though log1p() is already a robust choice for skewed variables like CRP).</li>
</ul>
</section>
</section>
</section>
</section>
<section id="pam" class="level1">
<h1>PAM</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>pam_1 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(mean_bp_mean <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> record_id) <span class="sc">+</span> visit <span class="sc">+</span> allocation_group <span class="sc">+</span> completed_intervention <span class="sc">+</span> duration_difference <span class="sc">+</span> age <span class="sc">+</span> sex <span class="sc">+</span> hypertension <span class="sc">+</span> hypercholesterolemia <span class="sc">+</span> hypertrigliceridemia <span class="sc">+</span> drugs_w_loss <span class="sc">+</span> drugs_w_gain <span class="sc">+</span> mean_bp_mean <span class="sc">+</span> handgrip <span class="sc">+</span> evs_score <span class="sc">+</span> alcohol_dose <span class="sc">+</span> kcal <span class="sc">+</span> labs_crp <span class="sc">+</span> labs_alt <span class="sc">+</span> labs_ggt <span class="sc">+</span> labs_ldl <span class="sc">+</span> labs_triglycerides <span class="sc">+</span> labs_hdl <span class="sc">+</span> labs_quick_index, <span class="at">data =</span> data_model_scaled)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in model.matrix.default(fixedform, fr, contrasts): the response
appeared on the right-hand side and was dropped</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in model.matrix.default(fixedform, fr, contrasts): problem with term 12
in model.matrix: no columns are assigned</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in model.matrix.default(fixedform, fr, contrasts): the response
appeared on the right-hand side and was dropped</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in model.matrix.default(fixedform, fr, contrasts): problem with term 12
in model.matrix: no columns are assigned</code></pre>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>