---
title: "DVEP Data Analysis"
project: "Effect of Eclipta prostrata (L.) L. (Asteraceae) on bioelectrical impedance phase angle in adults with grade I obesity (DVEP)"
PID: "REDCap 1958"
author: "Gustavo Santos Paiva Laender Moura"
date: "2024-10-22"
output: html_document
---

# FIRST STEPS
## Getting Started with R
```{r, results = 'hide'}
# Clear existing data and graphics
rm(list=ls())
graphics.off()
cat("\014")  # Clear any pending RStudio sessions or temporary files

# Load necessary libraries
library(Hmisc)
library(tidyverse) 

# Set working directory
setwd("/Users/gustavosplmoura/Library/Mobile Documents/com~apple~CloudDocs/Medicina/Biblioteca/Research/Data Science/Data Science/PROJECTS/DVEP")
getwd()
```

## Exporting data from REDCap
1. PID 1958
2. Data Exports, Reports, and Stats
3. Choose "Export Data" from option "A - All data (all records and fields)"
4. Export format: CSV (raw data)
5. De-identification options: "Remove all identifier fields" YES
6. Additional export options: "Export survey identifier field and survey timestamp field(s)?" YES
7. Advanced data formatting options
- "Export gray Form Status fields with blank value"
- comma as default separator
- Use period/full stop (.) as decimal
8. Export file to "/Users/gustavosplmoura/Library/Mobile Documents/com~apple~CloudDocs/Medicina/Biblioteca/Research/Data Science/Data Science/PROJECTS/DVEP"
9. Rename file to "data_dvep.csv"
Note: resulting file must have 780 variables (last variable on column ACZ: "anexos_complete")

## Reading files
1. CSV files (Tidyverse)
```{r}
# Read files: Data and Codebook

data  <- read_csv(
  "data_dvep.csv",
  col_names = TRUE,
  col_types = NULL,
  col_select = NULL,
  id = NULL,
  locale = default_locale(),
  na = c("", "NA", "NI", "UNK", "NASK", "ASKU", "INV"),
  quote = "\"",
  comment = "",
  trim_ws = TRUE,
  skip = 0, # Number of lines to skip before reading data
  n_max = Inf, # Maximum number of lines to read.
  guess_max = 1000,
  name_repair = "unique",
  num_threads = readr_threads(),
  progress = show_progress(),
  show_col_types = TRUE,
  skip_empty_rows = TRUE,
  lazy = should_read_lazy()
)

data_codebook <- read_csv(
  "data_codebook.csv",
  col_names = TRUE,
  col_types = NULL,
  col_select = NULL,
  id = NULL,
  locale = default_locale(),
  na = c("", "NA", "NI", "UNK", "NASK", "ASKU", "INV"),
  quote = "\"",
  comment = "",
  trim_ws = TRUE,
  skip = 0, # Number of lines to skip before reading data
  n_max = Inf, # Maximum number of lines to read.
  guess_max = 1000,
  name_repair = "unique",
  num_threads = readr_threads(),
  progress = show_progress(),
  show_col_types = TRUE,
  skip_empty_rows = TRUE,
  lazy = should_read_lazy()
)

data_structure  <- read_csv(
  "data_structure.csv",
  col_names = TRUE)

data_NCIT  <- read_csv(
  "data_NCIT.csv",
  col_names = TRUE)

# Remove identifying name from record_id
data$record_id <- substr(data$record_id,1,2)
```

2. CSV files (Base R)
```{r}
# Read files: Data and Codebook
data <- read.csv("/Users/gustavosplmoura/Library/Mobile Documents/com~apple~CloudDocs/Medicina/Biblioteca/Research/Data Science/Data Science/PROJECTS/DVEP/data_dvep.csv", header = TRUE)
data_codebook <- read.csv("/Users/gustavosplmoura/Library/Mobile Documents/com~apple~CloudDocs/Medicina/Biblioteca/Research/Data Science/Data Science/PROJECTS/DVEP/Codebook.csv", header = TRUE)

# Remove identifying name from record_id
data$record_id <- substr(data$record_id,1,2)
```

3. Excel file **RETIRED**
```{r, eval = FALSE}
data <- read_excel("/Users/gustavosplmoura/Library/Mobile Documents/com~apple~CloudDocs/Medicina/Biblioteca/Research/Data Science/Data Science/PROJECTS/DVEP/1_Data.xlsx")
data_codebook <- read_excel("/Users/gustavosplmoura/Library/Mobile Documents/com~apple~CloudDocs/Medicina/Biblioteca/Research/Data Science/Data Science/PROJECTS/DVEP/1_Data.xlsx", sheet = "Codebook")

# Remove identifying name from record_id
data$record_id <- substr(data$record_id,1,2)
```

## Renaming variables
```{r}
## Create rename vector
rename_vector <- setNames(object = colnames(data), data_codebook$variable_recoded)
## Apply  rename vector to data
data <- data |>
    rename(!!!rename_vector)

rm(rename_vector)
```

## Assing correct column types
1. Excel formula to convert REDCap field types to Tibble nomenclature
```{excel}
    =IF(
    J2="calc","d",IF(
    J2="radio","f",IF(
    J2="notes","c",IF(
    J2="dropdown","f",IF(
    J2="slider","i",if(
        and(J2="text",N2=""),"c",if(
        and(J2="text",N2="date_dmy"),"D",if(
        and(J2="text",N2="integer"),"i",if(
        and(J2="text",left(N2,6)="number"),"d",if(
        and(J2="text",N2="datetime_dmy"),"T",if(
        and(J2="text",N2="time_mm_ss"),"t",if(
        and(J2="text",N2="time"),"t",""
        ))))))))))))
```

2. Creating R function and mutating columns
```{r}
convert_col_type <- function(column, type) {
  switch(type,
         c = as.character(column),
         d = as.numeric(column),
         i = as.integer(column),
         l = as.logical(column),
         D = as.Date(column, format = "%Y-%m-%d"),
         T = as.POSIXct(column, format = "%Y-%m-%d %H:%M:%S"),
         f = as.factor(column),
         column  # Default (no change)
  )
}

data <- data |>
    mutate(
        across( # apply a function to multiple columns at once
            .cols = # .cols: Specifies which columns you want to change
                all_of(data_codebook$variable_recoded), 
            .fns = # .fns: Defines the function to apply to each column
                ~ convert_col_type(.x, data_codebook$col_types[which(data_codebook$variable_recoded == cur_column())])
))

```

### Checking the type of each column in a tibble in R
If you are using dplyr, you can use glimpse(), which is like str() but optimized for tibbles. It shows a cleaner, more readable summary.
<chr>: Character
<dbl>: Double (floating-point number)
<int>: Integer
<fct>: Factor
<date>: Date
<dttm>: Date-Time (POSIXct)

sapply() (Show all column types)
sapply(data, class)

## Assigning labels to variables
1. In Portuguese (pt):
```{r}
## Loop over the variables and assign labels
for (i in seq_along(data_codebook$variable_recoded)) {
    # Get the variable name in data
    variable_name <- data_codebook$variable_recoded[i]
    
    # Get the corresponding label
    variable_label <- data_codebook$label_pt[i]
    
    # Assign the label to the variable in the data
    label(data[[variable_name]]) <- variable_label
}

# Remove intermediate vectors:
rm(i, variable_name, variable_label)
```

2. In English:
```{r, eval = FALSE}
# eval=FALSE: this code will not run
## Loop over the variables and assign labels
for (i in seq_along(data_codebook$variable_recoded)) {
    # Get the variable name in data
    variable_name <- data_codebook$variable_recoded[i]
    
    # Get the corresponding label
    ## use `label_pt` for portuguese and  `label_en` for english
    variable_label <- data_codebook$label_en[i]
    
    # Assign the label to the variable in the data
    label(data[[variable_name]]) <- variable_label
}

# Remove intermediate vectors:
rm(i, variable_name, variable_label)
```

3. Optional
Check if labels are correctly assigned using describe(data), an Hmisc function to display variable descriptions, including labels
```{r, eval=FALSE}
## Saving the output of describe(data) to a text file
### Write the output to the specified file
writeLines(
    capture.output(describe(data)), 
    "/Users/gustavosplmoura/Library/Mobile Documents/com~apple~CloudDocs/Medicina/Biblioteca/Research/Data Science/Data Science/PROJECTS/DVEP/3_Output/1_Initial_Variables.txt")
```

## (?) Create new factor variables

Observation:
The following variables were not included as factors due to character lenght greater than 4.000
507	c460	        common_previous_medications
495	c459	        common_medications
555	c83023	        abnormal_finding_description
520	c18772	        personal_medical_history
530	c25685	        symptom_specify
668	adverse_event	adverse_event
529	c4876	        symptom_code

```{r, eval = FALSE}
data$event_name.factor = factor(data$event_name,levels=c("eleg_arm_1","1visit_arm_1","2visit_arm_1","3visit_arm_1")) # event_name 116
data$repeat_instrument.factor = factor(data$repeat_instrument,levels=c("sintomas","exame_fsico","exames_laboratoriais","adeso","eventos_adversos","contato_semanal","comorbidades","medicamentos_de_uso_habitual","medicamentos_prvios","antecedentes_pessoais","anexos")) # repeat_instrument 266
data$ubs.factor = factor(data$ubs,levels=c("1","2","3","4","5","6","7","8")) # ubs 76
data$contact_options.factor = factor(data$contact_options,levels=c("1","2","3","4","5")) # contact_options 88
data$contact_hours.factor = factor(data$contact_hours,levels=c("1","2","3","4","5","6")) # contact_hours 88
data$contact_days.factor = factor(data$contact_days,levels=c("1","2","3")) # contact_days 74
data$transport_research_center.factor = factor(data$transport_research_center,levels=c("1","2","3")) # transport_research_center 100
data$research_source_info.factor = factor(data$research_source_info,levels=c("1","2","3","4","5","6")) # research_source_info 102
data$availability_comments_yn.factor = factor(data$availability_comments_yn,levels=c("0","1")) # availability_comments_yn 94
data$sex.factor = factor(data$sex,levels=c("1","0")) # sex 52
data$pregnant_nursing_yn.factor = factor(data$pregnant_nursing_yn,levels=c("0","1")) # pregnant_nursing_yn 84
data$eleg_comorbidity_yn.factor = factor(data$eleg_comorbidity_yn,levels=c("0","1")) # eleg_comorbidity_yn 84
data$drug_use_yn.factor = factor(data$drug_use_yn,levels=c("0","1")) # drug_use_yn 68
data$high_risk_pregnancy_ineffective_contraceptives.factor = factor(data$high_risk_pregnancy_ineffective_contraceptives,levels=c("0","1")) # high_risk_pregnancy_ineffective_contraceptives 138
data$high_risk_pregnancy_inconsistent_contraceptives.factor = factor(data$high_risk_pregnancy_inconsistent_contraceptives,levels=c("0","1")) # high_risk_pregnancy_inconsistent_contraceptives 140
data$high_risk_pregnancy_unprotected_sex.factor = factor(data$high_risk_pregnancy_unprotected_sex,levels=c("0","1")) # high_risk_pregnancy_unprotected_sex 116
data$high_risk_pregnancy_infertility_treatment.factor = factor(data$high_risk_pregnancy_infertility_treatment,levels=c("0","1")) # high_risk_pregnancy_infertility_treatment 128
data$high_risk_pregnancy_postpartum.factor = factor(data$high_risk_pregnancy_postpartum,levels=c("0","1")) # high_risk_pregnancy_postpartum 106
data$high_risk_pregnancy_none.factor = factor(data$high_risk_pregnancy_none,levels=c("0","1")) # high_risk_pregnancy_none 94
data$high_risk_fem_noinfo.factor = factor(data$high_risk_fem_noinfo,levels=c("0","1")) # high_risk_fem_noinfo 86
data$high_risk_fem_unknown.factor = factor(data$high_risk_fem_unknown,levels=c("0","1")) # high_risk_fem_unknown 88
data$high_risk_fem_notasked.factor = factor(data$high_risk_fem_notasked,levels=c("0","1")) # high_risk_fem_notasked 90
data$high_risk_fem_askunknown.factor = factor(data$high_risk_fem_askunknown,levels=c("0","1")) # high_risk_fem_askunknown 94
data$high_risk_fem_invalid.factor = factor(data$high_risk_fem_invalid,levels=c("0","1")) # high_risk_fem_invalid 88
data$high_risk_fem_na.factor = factor(data$high_risk_fem_na,levels=c("0","1")) # high_risk_fem_na 78
data$pregnancy_test_and_contraceptive_agreement.factor = factor(data$pregnancy_test_and_contraceptive_agreement,levels=c("0","1")) # pregnancy_test_and_contraceptive_agreement 130
data$low_risk_pregnancy_effective_contraceptives.factor = factor(data$low_risk_pregnancy_effective_contraceptives,levels=c("0","1")) # low_risk_pregnancy_effective_contraceptives 132
data$menopause.factor = factor(data$menopause,levels=c("0","1")) # menopause 64
data$low_risk_pregnancy_surgical_sterilization.factor = factor(data$low_risk_pregnancy_surgical_sterilization,levels=c("0","1")) # low_risk_pregnancy_surgical_sterilization 128
data$low_risk_pregnancy_no_sex_6_months.factor = factor(data$low_risk_pregnancy_no_sex_6_months,levels=c("0","1")) # low_risk_pregnancy_no_sex_6_months 114
data$low_risk_pregnancy_no_sex.factor = factor(data$low_risk_pregnancy_no_sex,levels=c("0","1")) # low_risk_pregnancy_no_sex 96
data$low_risk_pregnancy_infertility_diagnosis.factor = factor(data$low_risk_pregnancy_infertility_diagnosis,levels=c("0","1")) # low_risk_pregnancy_infertility_diagnosis 126
data$low_risk_pregnancy_exclusive_homo_sexual_behavior.factor = factor(data$low_risk_pregnancy_exclusive_homo_sexual_behavior,levels=c("0","1")) # low_risk_pregnancy_exclusive_homo_sexual_behavior 144
data$low_risk_fem_noinfo.factor = factor(data$low_risk_fem_noinfo,levels=c("0","1")) # low_risk_fem_noinfo 84
data$low_risk_fem_unknown.factor = factor(data$low_risk_fem_unknown,levels=c("0","1")) # low_risk_fem_unknown 86
data$low_risk_fem_notasked.factor = factor(data$low_risk_fem_notasked,levels=c("0","1")) # low_risk_fem_notasked 88
data$low_risk_fem_askunknown.factor = factor(data$low_risk_fem_askunknown,levels=c("0","1")) # low_risk_fem_askunknown 92
data$low_risk_fem_invalid.factor = factor(data$low_risk_fem_invalid,levels=c("0","1")) # low_risk_fem_invalid 86
data$low_risk_fem_na.factor = factor(data$low_risk_fem_na,levels=c("0","1")) # low_risk_fem_na 76
data$contraceptive_continuation_agreement.factor = factor(data$contraceptive_continuation_agreement,levels=c("0","1")) # contraceptive_continuation_agreement 118
data$eleg_lab_location.factor = factor(data$eleg_lab_location,levels=c("1","2","3","4","5","6","7","8","9","10","11")) # eleg_lab_location 118
data$lab_collected_yn.factor = factor(data$lab_collected_yn,levels=c("0","1")) # lab_collected_yn 78
data$lab_checked_yn.factor = factor(data$lab_checked_yn,levels=c("0","1")) # lab_checked_yn 74
data$lab_finding_yn.factor = factor(data$lab_finding_yn,levels=c("0","1")) # lab_finding_yn 74
data$lab_exclusion_yn.factor = factor(data$lab_exclusion_yn,levels=c("0","1")) # lab_exclusion_yn 78
data$bhcg.factor = factor(data$bhcg,levels=c("0","1","99")) # bhcg 59
data$preserved_hormone.factor = factor(data$preserved_hormone,levels=c("0","1")) # preserved_hormone 80
data$contraception_ready_yn.factor = factor(data$contraception_ready_yn,levels=c("0","1")) # contraception_ready_yn 90
data$consent_sent_yn.factor = factor(data$consent_sent_yn,levels=c("0","1")) # consent_sent_yn 76
data$consent_read_yn.factor = factor(data$consent_read_yn,levels=c("0","1")) # consent_read_yn 76
data$consent_questions_yn.factor = factor(data$consent_questions_yn,levels=c("0","1")) # consent_questions_yn 86
data$consent_questions_cleared_yn.factor = factor(data$consent_questions_cleared_yn,levels=c("0","1")) # consent_questions_cleared_yn 102
data$participant_desire_yn.factor = factor(data$participant_desire_yn,levels=c("0","1")) # participant_desire_yn 88
data$sms_consent_yn.factor = factor(data$sms_consent_yn,levels=c("0","1")) # sms_consent_yn 74
data$block_alerts_1st_yn.factor = factor(data$block_alerts_1st_yn,levels=c("0","1")) # block_alerts_1st_yn 84
data$eleg_complete.factor = factor(data$eleg_complete,levels=c("0","1","2")) # eleg_complete 76
data$consent_signed_yn.factor = factor(data$consent_signed_yn,levels=c("0","1")) # consent_signed_yn 80
data$tcle_complete.factor = factor(data$tcle_complete,levels=c("0","1","2")) # tcle_complete 76
data$race.factor = factor(data$race,levels=c("c41260","c41261","c128994","c16352","c17998","c17649")) # race 101
data$marital_status.factor = factor(data$marital_status,levels=c("c51776","c53262","c51773","c51774","c156541","c51775")) # marital_status 121
data$employment_status.factor = factor(data$employment_status,levels=c("c52658","c75563","c75562")) # employment_status 99
data$income_level.factor = factor(data$income_level,levels=c("1","2","3","4","5")) # income_level 82
data$demographic_complete.factor = factor(data$demographic_complete,levels=c("0","1","2")) # demographic_complete 90
data$whoqol_1_quality.factor = factor(data$whoqol_1_quality,levels=c("1","2","3","4","5")) # whoqol_1_quality 90
data$whoqol_2_health.factor = factor(data$whoqol_2_health,levels=c("1","2","3","4","5")) # whoqol_2_health 88
data$whoqol_3_pain.factor = factor(data$whoqol_3_pain,levels=c("1","2","3","4","5")) # whoqol_3_pain 84
data$whoqol_4_treatment.factor = factor(data$whoqol_4_treatment,levels=c("1","2","3","4","5")) # whoqol_4_treatment 94
data$whoqol_5_enjoyment.factor = factor(data$whoqol_5_enjoyment,levels=c("1","2","3","4","5")) # whoqol_5_enjoyment 94
data$whoqol_6_meaning.factor = factor(data$whoqol_6_meaning,levels=c("1","2","3","4","5")) # whoqol_6_meaning 90
data$whoqol_7_concentration.factor = factor(data$whoqol_7_concentration,levels=c("1","2","3","4","5")) # whoqol_7_concentration 102
data$whoqol_8_security.factor = factor(data$whoqol_8_security,levels=c("1","2","3","4","5")) # whoqol_8_security 92
data$whoqol_9_environment.factor = factor(data$whoqol_9_environment,levels=c("1","2","3","4","5")) # whoqol_9_environment 98
data$whoqol_10_energy.factor = factor(data$whoqol_10_energy,levels=c("1","2","3","4","5")) # whoqol_10_energy 90
data$whoqol_11_appearance.factor = factor(data$whoqol_11_appearance,levels=c("1","2","3","4","5")) # whoqol_11_appearance 98
data$whoqol_12_finances.factor = factor(data$whoqol_12_finances,levels=c("1","2","3","4","5")) # whoqol_12_finances 94
data$whoqol_13_information.factor = factor(data$whoqol_13_information,levels=c("1","2","3","4","5")) # whoqol_13_information 100
data$whoqol_14_leisure.factor = factor(data$whoqol_14_leisure,levels=c("1","2","3","4","5")) # whoqol_14_leisure 92
data$whoqol_15_mobility.factor = factor(data$whoqol_15_mobility,levels=c("1","2","3","4","5")) # whoqol_15_mobility 94
data$whoqol_16_sleep.factor = factor(data$whoqol_16_sleep,levels=c("1","2","3","4","5")) # whoqol_16_sleep 88
data$whoqol_17_activities.factor = factor(data$whoqol_17_activities,levels=c("1","2","3","4","5")) # whoqol_17_activities 98
data$whoqol_18_work.factor = factor(data$whoqol_18_work,levels=c("1","2","3","4","5")) # whoqol_18_work 86
data$whoqol_19_selfesteem.factor = factor(data$whoqol_19_selfesteem,levels=c("1","2","3","4","5")) # whoqol_19_selfesteem 98
data$whoqol_20_relationships.factor = factor(data$whoqol_20_relationships,levels=c("1","2","3","4","5")) # whoqol_20_relationships 104
data$whoqol_21_sexual.factor = factor(data$whoqol_21_sexual,levels=c("1","2","3","4","5")) # whoqol_21_sexual 90
data$whoqol_22_support.factor = factor(data$whoqol_22_support,levels=c("1","2","3","4","5")) # whoqol_22_support 92
data$whoqol_23_housing.factor = factor(data$whoqol_23_housing,levels=c("1","2","3","4","5")) # whoqol_23_housing 92
data$whoqol_24_health_services.factor = factor(data$whoqol_24_health_services,levels=c("1","2","3","4","5")) # whoqol_24_health_services 108
data$whoqol_25_transport.factor = factor(data$whoqol_25_transport,levels=c("1","2","3","4","5")) # whoqol_25_transport 96
data$whoqol_26_negativity.factor = factor(data$whoqol_26_negativity,levels=c("1","2","3","4","5")) # whoqol_26_negativity 98
data$whoqol_needed_help.factor = factor(data$whoqol_needed_help,levels=c("0","1","99")) # whoqol_needed_help 87
data$whoqol_complete.factor = factor(data$whoqol_complete,levels=c("0","1","2")) # whoqol_complete 80
data$dass_1_not_calm.factor = factor(data$dass_1_not_calm,levels=c("0","1","2","3")) # dass_1_not_calm 84
data$dass_2_drymouth.factor = factor(data$dass_2_drymouth,levels=c("0","1","2","3")) # dass_2_drymouth 84
data$dass_3_not_positive.factor = factor(data$dass_3_not_positive,levels=c("0","1","2","3")) # dass_3_not_positive 92
data$dass_4_hard_breath.factor = factor(data$dass_4_hard_breath,levels=c("0","1","2","3")) # dass_4_hard_breath 90
data$dass_5_no_initiative.factor = factor(data$dass_5_no_initiative,levels=c("0","1","2","3")) # dass_5_no_initiative 94
data$dass_6_exaggeration.factor = factor(data$dass_6_exaggeration,levels=c("0","1","2","3")) # dass_6_exaggeration 92
data$dass_7_tremor.factor = factor(data$dass_7_tremor,levels=c("0","1","2","3")) # dass_7_tremor 80
data$dass_8_nervous.factor = factor(data$dass_8_nervous,levels=c("0","1","2","3")) # dass_8_nervous 82
data$dass_9_worry.factor = factor(data$dass_9_worry,levels=c("0","1","2","3")) # dass_9_worry 78
data$dass_10_no_desire.factor = factor(data$dass_10_no_desire,levels=c("0","1","2","3")) # dass_10_no_desire 88
data$dass_11_agitation.factor = factor(data$dass_11_agitation,levels=c("0","1","2","3")) # dass_11_agitation 88
data$dass_12_not_relaxed.factor = factor(data$dass_12_not_relaxed,levels=c("0","1","2","3")) # dass_12_not_relaxed 92
data$dass_13_depression.factor = factor(data$dass_13_depression,levels=c("0","1","2","3")) # dass_13_depression 90
data$dass_14_intolerance.factor = factor(data$dass_14_intolerance,levels=c("0","1","2","3")) # dass_14_intolerance 92
data$dass_15_panic.factor = factor(data$dass_15_panic,levels=c("0","1","2","3")) # dass_15_panic 80
data$dass_16_no_enthusiasm.factor = factor(data$dass_16_no_enthusiasm,levels=c("0","1","2","3")) # dass_16_no_enthusiasm 96
data$dass_17_no_selfworth.factor = factor(data$dass_17_no_selfworth,levels=c("0","1","2","3")) # dass_17_no_selfworth 94
data$dass_18_too_emotional.factor = factor(data$dass_18_too_emotional,levels=c("0","1","2","3")) # dass_18_too_emotional 96
data$dass_19_palpitation.factor = factor(data$dass_19_palpitation,levels=c("0","1","2","3")) # dass_19_palpitation 92
data$dass_20_fear.factor = factor(data$dass_20_fear,levels=c("0","1","2","3")) # dass_20_fear 78
data$dass_21_no_meaning.factor = factor(data$dass_21_no_meaning,levels=c("0","1","2","3")) # dass_21_no_meaning 90
data$dass_complete.factor = factor(data$dass_complete,levels=c("0","1","2")) # dass_complete 76
data$ecap1.factor = factor(data$ecap1,levels=c("1","2","3","4")) # ecap1 64
data$ecap2.factor = factor(data$ecap2,levels=c("1","2","3","4")) # ecap2 64
data$ecap3.factor = factor(data$ecap3,levels=c("1","2","3","4")) # ecap3 64
data$ecap4.factor = factor(data$ecap4,levels=c("1","2","3","4")) # ecap4 64
data$ecap5.factor = factor(data$ecap5,levels=c("1","2","3","4")) # ecap5 64
data$ecap6.factor = factor(data$ecap6,levels=c("1","2","3")) # ecap6 60
data$ecap7.factor = factor(data$ecap7,levels=c("1","2","3","4")) # ecap7 64
data$ecap8.factor = factor(data$ecap8,levels=c("1","2","3","4")) # ecap8 64
data$ecap9.factor = factor(data$ecap9,levels=c("1","2","3","4")) # ecap9 64
data$ecap10.factor = factor(data$ecap10,levels=c("1","2","3","4")) # ecap10 66
data$ecap11.factor = factor(data$ecap11,levels=c("1","2","3","4")) # ecap11 66
data$ecap12.factor = factor(data$ecap12,levels=c("1","2","3","4")) # ecap12 66
data$ecap13.factor = factor(data$ecap13,levels=c("1","2","3","4")) # ecap13 66
data$ecap14.factor = factor(data$ecap14,levels=c("1","2","3","4")) # ecap14 66
data$ecap15.factor = factor(data$ecap15,levels=c("1","2","3","4")) # ecap15 66
data$ecap16.factor = factor(data$ecap16,levels=c("1","2","3")) # ecap16 62
data$ecap_complete.factor = factor(data$ecap_complete,levels=c("0","1","2")) # ecap_complete 76
data$bodycount_complete.factor = factor(data$bodycount_complete,levels=c("0","1","2")) # bodycount_complete 86
data$bp_limb_complete.factor = factor(data$bp_limb_complete,levels=c("0","1","2")) # bp_limb_complete 82
data$bp_show_metadata.factor = factor(data$bp_show_metadata,levels=c("0","1")) # bp_show_metadata 78
data$bp_complete.factor = factor(data$bp_complete,levels=c("0","1","2")) # bp_complete 72
data$smoked_24h.factor = factor(data$smoked_24h,levels=c("0","1")) # smoked_24h 66
data$exercised_24h.factor = factor(data$exercised_24h,levels=c("0","1")) # exercised_24h 72
data$alcohol_24h.factor = factor(data$alcohol_24h,levels=c("0","1")) # alcohol_24h 68
data$room_temperature.factor = factor(data$room_temperature,levels=c("0","1")) # room_temperature 78
data$light_clothes.factor = factor(data$light_clothes,levels=c("0","1")) # light_clothes 72
data$removed_objects.factor = factor(data$removed_objects,levels=c("0","1")) # removed_objects 76
data$hairy_limbs.factor = factor(data$hairy_limbs,levels=c("0","1")) # hairy_limbs 68
data$removed_hair.factor = factor(data$removed_hair,levels=c("0","1")) # removed_hair 70
data$cleaned_skin.factor = factor(data$cleaned_skin,levels=c("0","1")) # cleaned_skin 70
data$bed_rest_10min.factor = factor(data$bed_rest_10min,levels=c("0","1")) # bed_rest_10min 74
data$bia_show_metadata.factor = factor(data$bia_show_metadata,levels=c("0","1")) # bia_show_metadata 80
data$bia_complete.factor = factor(data$bia_complete,levels=c("0","1","2")) # bia_complete 74
data$grip_limitations_yn.factor = factor(data$grip_limitations_yn,levels=c("0","1")) # grip_limitations_yn 84
data$grip_rh_limitations.factor = factor(data$grip_rh_limitations,levels=c("0","1","2","3","4","5")) # grip_rh_limitations 100
data$grip_lh_no_limitations.factor = factor(data$grip_lh_no_limitations,levels=c("0","1")) # grip_lh_no_limitations 90
data$grip_lh_paralysis.factor = factor(data$grip_lh_paralysis,levels=c("0","1")) # grip_lh_paralysis 80
data$grip_lh_cast.factor = factor(data$grip_lh_cast,levels=c("0","1")) # grip_lh_cast 70
data$grip_lh_bandaged.factor = factor(data$grip_lh_bandaged,levels=c("0","1")) # grip_lh_bandaged 78
data$grip_lh_missing_thumb.factor = factor(data$grip_lh_missing_thumb,levels=c("0","1")) # grip_lh_missing_thumb 88
data$grip_lh_other_limitations.factor = factor(data$grip_lh_other_limitations,levels=c("0","1")) # grip_lh_other_limitations 96
data$grip_lh_no_info.factor = factor(data$grip_lh_no_info,levels=c("0","1")) # grip_lh_no_info 76
data$grip_lh_unknown.factor = factor(data$grip_lh_unknown,levels=c("0","1")) # grip_lh_unknown 76
data$grip_lh_notasked.factor = factor(data$grip_lh_notasked,levels=c("0","1")) # grip_lh_notasked 78
data$grip_lh_askunknown.factor = factor(data$grip_lh_askunknown,levels=c("0","1")) # grip_lh_askunknown 82
data$grip_lh_invalid.factor = factor(data$grip_lh_invalid,levels=c("0","1")) # grip_lh_invalid 76
data$grip_lh_na.factor = factor(data$grip_lh_na,levels=c("0","1")) # grip_lh_na 66
data$grip_recent_surgery_yn.factor = factor(data$grip_recent_surgery_yn,levels=c("0","1","2")) # grip_recent_surgery_yn 94
data$grip_exclude_test_yn.factor = factor(data$grip_exclude_test_yn,levels=c("0","1","2","3")) # grip_exclude_test_yn 94
data$grip_surgery_history_yn.factor = factor(data$grip_surgery_history_yn,levels=c("0","1","2","3")) # grip_surgery_history_yn 100
data$grip_dominance.factor = factor(data$grip_dominance,levels=c("1","2","3")) # grip_dominance 78
data$grip_pain_last7days_yn.factor = factor(data$grip_pain_last7days_yn,levels=c("0","1","2","3")) # grip_pain_last7days_yn 98
data$grip_rhpain.factor = factor(data$grip_rhpain,levels=c("0","1")) # grip_rhpain 68
data$grip_lhpain.factor = factor(data$grip_lhpain,levels=c("0","1")) # grip_lhpain 68
data$grip_test_procedure_understanding_yn.factor = factor(data$grip_test_procedure_understanding_yn,levels=c("0","1")) # grip_test_procedure_understanding_yn 118
data$grip_see_metadata.factor = factor(data$grip_see_metadata,levels=c("0","1")) # grip_see_metadata 80
data$handgrip_complete.factor = factor(data$handgrip_complete,levels=c("0","1","2")) # handgrip_complete 84
data$frequency_bowel.factor = factor(data$frequency_bowel,levels=c("c25473","c64525","c64528","c118853")) # frequency_bowel 105
data$frequency_solid_stool.factor = factor(data$frequency_solid_stool,levels=c("c70670","c110991","c73116","c70543")) # frequency_solid_stool 117
data$frequency_diarrhea.factor = factor(data$frequency_diarrhea,levels=c("c70543","c73116","c64649","c70670")) # frequency_diarrhea 110
data$contipation_yn.factor = factor(data$contipation_yn,levels=c("c49488","c49487")) # contipation_yn 84
data$frequency_laxative.factor = factor(data$frequency_laxative,levels=c("c70543","c73116","c25473","c67069","c64498")) # frequency_laxative 119
data$urinary_frequency.factor = factor(data$urinary_frequency,levels=c("c102843","c16413","c25640")) # urinary_frequency 100
data$water_consumption.factor = factor(data$water_consumption,levels=c("c102843","c16413","c25640")) # water_consumption 100
data$hair_loss.factor = factor(data$hair_loss,levels=c("c70543","c129476","c129475","c129474","c129473")) # hair_loss 105
data$nutrition_complete.factor = factor(data$nutrition_complete,levels=c("0","1","2")) # nutrition_complete 86
data$food_alergy.factor = factor(data$food_alergy,levels=c("c49488","c49487")) # food_alergy 78
data$peanut_allergy.factor = factor(data$peanut_allergy,levels=c("c49488","c49487")) # peanut_allergy 84
data$nut_allergy.factor = factor(data$nut_allergy,levels=c("c49488","c49487")) # nut_allergy 78
data$seafood_allergy.factor = factor(data$seafood_allergy,levels=c("c49488","c49487")) # seafood_allergy 86
data$egg_allergy.factor = factor(data$egg_allergy,levels=c("c49488","c49487")) # egg_allergy 78
data$lactose_intolerance.factor = factor(data$lactose_intolerance,levels=c("c49488","c49487")) # lactose_intolerance 94
data$gluten_intolerance.factor = factor(data$gluten_intolerance,levels=c("c49488","c49487")) # gluten_intolerance 92
data$soy_allergy.factor = factor(data$soy_allergy,levels=c("c49488","c49487")) # soy_allergy 78
data$fish_allergy.factor = factor(data$fish_allergy,levels=c("c49488","c49487")) # fish_allergy 80
data$allergy_complete.factor = factor(data$allergy_complete,levels=c("0","1","2")) # allergy_complete 82
data$evs_days.factor = factor(data$evs_days,levels=c("0","1","2","3","4","5","6","7")) # evs_days 86
data$evs_time.factor = factor(data$evs_time,levels=c("0","10","20","30","40","50","60","90","120","150")) # evs_time 105
data$exercise_type_1.factor = factor(data$exercise_type_1,levels=c("1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21")) # exercise_type_1 164
data$secondary_physical_activity_yn.factor = factor(data$secondary_physical_activity_yn,levels=c("0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21")) # secondary_physical_activity_yn 198
data$tertiary_physical_activity_yn.factor = factor(data$tertiary_physical_activity_yn,levels=c("0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21")) # tertiary_physical_activity_yn 196
data$evs_complete.factor = factor(data$evs_complete,levels=c("0","1","2")) # evs_complete 74
data$alcohol_frequency.factor = factor(data$alcohol_frequency,levels=c("0","1","3","4","5")) # alcohol_frequency 92
data$alcohol_stopped_years_ago.factor = factor(data$alcohol_stopped_years_ago,levels=c("1","2","3","4","5")) # alcohol_stopped_years_ago 108
data$years_drinks_alcohol.factor = factor(data$years_drinks_alcohol,levels=c("1","2","3","4","5")) # years_drinks_alcohol 98
data$beer_yn.factor = factor(data$beer_yn,levels=c("0","1")) # beer_yn 60
data$wine_yn.factor = factor(data$wine_yn,levels=c("0","1")) # wine_yn 60
data$spirit_yn.factor = factor(data$spirit_yn,levels=c("0","1")) # spirit_yn 64
data$alcohol_type_other.factor = factor(data$alcohol_type_other,levels=c("0","1")) # alcohol_type_other 82
data$alcohol_type_no_info.factor = factor(data$alcohol_type_no_info,levels=c("0","1")) # alcohol_type_no_info 86
data$alcohol_type_unknown.factor = factor(data$alcohol_type_unknown,levels=c("0","1")) # alcohol_type_unknown 86
data$alcohol_type_not_asked.factor = factor(data$alcohol_type_not_asked,levels=c("0","1")) # alcohol_type_not_asked 90
data$alcohol_type_asked_unknown.factor = factor(data$alcohol_type_asked_unknown,levels=c("0","1")) # alcohol_type_asked_unknown 98
data$alcohol_type_invalid.factor = factor(data$alcohol_type_invalid,levels=c("0","1")) # alcohol_type_invalid 86
data$alcohol_type_na.factor = factor(data$alcohol_type_na,levels=c("0","1")) # alcohol_type_na 76
data$alcohol_complete.factor = factor(data$alcohol_complete,levels=c("0","1","2")) # alcohol_complete 82
data$smoke_history.factor = factor(data$smoke_history,levels=c("0","1","2")) # smoke_history 76
data$tobacco_complete.factor = factor(data$tobacco_complete,levels=c("0","1","2")) # tobacco_complete 82
data$diet_recall_complete.factor = factor(data$diet_recall_complete,levels=c("0","1","2")) # diet_recall_complete 90
data$meal_breakfast_yn.factor = factor(data$meal_breakfast_yn,levels=c("0","1")) # meal_breakfast_yn 80
data$meal_morning_snack_yn.factor = factor(data$meal_morning_snack_yn,levels=c("0","1")) # meal_morning_snack_yn 88
data$meal_lunch_yn.factor = factor(data$meal_lunch_yn,levels=c("0","1")) # meal_lunch_yn 72
data$meal_afternoon_snack_yn.factor = factor(data$meal_afternoon_snack_yn,levels=c("0","1")) # meal_afternoon_snack_yn 92
data$meal_dinner_yn.factor = factor(data$meal_dinner_yn,levels=c("0","1")) # meal_dinner_yn 74
data$meal_supper_yn.factor = factor(data$meal_supper_yn,levels=c("0","1")) # meal_supper_yn 74
data$meal_no_info.factor = factor(data$meal_no_info,levels=c("0","1")) # meal_no_info 70
data$meal_unknown.factor = factor(data$meal_unknown,levels=c("0","1")) # meal_unknown 70
data$meal_not_asked.factor = factor(data$meal_not_asked,levels=c("0","1")) # meal_not_asked 74
data$meal_asked_unknown.factor = factor(data$meal_asked_unknown,levels=c("0","1")) # meal_asked_unknown 82
data$meal_invalid.factor = factor(data$meal_invalid,levels=c("0","1")) # meal_invalid 70
data$meal_na.factor = factor(data$meal_na,levels=c("0","1")) # meal_na 60
data$diet_values_complete.factor = factor(data$diet_values_complete,levels=c("0","1","2")) # diet_values_complete 90
data$intervention_capsule_start_yn.factor = factor(data$intervention_capsule_start_yn,levels=c("0","1")) # intervention_capsule_start_yn 104
data$weekly_alert_remove_yn.factor = factor(data$weekly_alert_remove_yn,levels=c("0","1")) # weekly_alert_remove_yn 90
data$dates_complete.factor = factor(data$dates_complete,levels=c("0","1","2")) # dates_complete 78
data$allocation_group.factor = factor(data$allocation_group,levels=c("1","2")) # allocation_group 78
data$allocation_complete.factor = factor(data$allocation_complete,levels=c("0","1","2")) # allocation_complete 88
data$comorbidity_yn.factor = factor(data$comorbidity_yn,levels=c("0","1")) # comorbidity_yn 74
data$comorbidity_additional.factor = factor(data$comorbidity_additional,levels=c("0","1")) # comorbidity_additional 90
data$common_comorbidities.factor = factor(data$common_comorbidities,levels=c("C3390","C6996","C2869","C26696","C35145","C2884","C3318","C28397","C26722","C52593","C9305","C2920","C34449","C26713","C122822","C97162","C4786","C2982","C26747","C2987","C63709","C4922","C26732","C2866","C2965","C3071","C26845","C26781","C113609","C84444","C3138","C3889","C164315","C3199","C80078","C2931","C41830","C3001","C26862","C89715","C3020","C2891","C3243","C9224","C3362","C79821","C50466","C87497","C26780","C26782","C26785","C34650","C98945","C39293","C26792","C37967","C3117","C197871","C3123","C37971","C3961","C84774","C26800","C3014","C50791","C35650","C35158","C28286","C3080","C127822","C3201","C26975","C3434","C3161","C3207","C34797","C26828","C2983","C4345","C3293","C50910","C3298","C128386","C3306","C84637","C35326","C123216","C3336","C26930","C3346","C114476","C113101","C2952","C79532","C27168","C26883","C26900","C61283","C82343","C114667","C35151","C97141","C34423","C97160","C88412","C88411","C3407","C3423","C3108")) # common_comorbidities 1025
data$comorbidities_diagnosis_duration_unit.factor = factor(data$comorbidities_diagnosis_duration_unit,levels=c("1","2","3","4")) # comorbidities_diagnosis_duration_unit 128
data$conditions_complete.factor = factor(data$conditions_complete,levels=c("0","1","2")) # conditions_complete 88
data$medication_current_yn.factor = factor(data$medication_current_yn,levels=c("0","1")) # medication_current_yn 88
data$medication_additional.factor = factor(data$medication_additional,levels=c("0","1")) # medication_additional 88
data$medication_dosage.factor = factor(data$medication_dosage,levels=c("c64576","c64499","c64921","c64595","c154484","c139178","c64922","c125004","c64502","c64527","c64530","c98849","c98855","c139180","c139181","c139182","c64525","c64533","c64534","c71124","c161335","c64526","c118854","c64528","c64531","c85552","c98857","c71127","c64535","c103390","c89788","c116149","c189433","c189434","c64498","c139179","c98859","c98852","c98850","c98856","c64536","c64537","c161336","c89789","c98851","c189435","c161333","c189432","c161334")) # medication_dosage 531
data$drug_duration_use_unit.factor = factor(data$drug_duration_use_unit,levels=c("1","2","3","4")) # drug_duration_use_unit 98
data$drugs_complete.factor = factor(data$drugs_complete,levels=c("0","1","2")) # drugs_complete 78
data$previous_medication_yn.factor = factor(data$previous_medication_yn,levels=c("0","1")) # previous_medication_yn 90
data$previous_medication_additional.factor = factor(data$previous_medication_additional,levels=c("0","1")) # previous_medication_additional 106
data$previous_drug_start_duration_unit.factor = factor(data$previous_drug_start_duration_unit,levels=c("1","2","3","4")) # previous_drug_start_duration_unit 120
data$previous_drug_stop_duration_unit.factor = factor(data$previous_drug_stop_duration_unit,levels=c("1","2","3","4")) # previous_drug_stop_duration_unit 118
data$old.drugs_complete.factor = factor(data$old.drugs_complete,levels=c("0","1","2")) # old.drugs_complete 86
data$medical_history_yn.factor = factor(data$medical_history_yn,levels=c("0","1")) # medical_history_yn 82
data$medical_history_additional.factor = factor(data$medical_history_additional,levels=c("0","1")) # medical_history_additional 98
data$common_medical_history.factor = factor(data$common_medical_history,levels=c("C51679","C51687","C51691","C46088","C157809","C51676","C15209","C51758","C3046","C15236","C51583","C92946","C86589","C34690","C86074","C168249","C15256","C92901","C34753","C15277","C51645","C15284","C114667_2","C83000","C15294","C80430","C15307","C157778","C157839","C164212","C51998","C51605","C91838","C51762","C15342")) # common_medical_history 404
data$medical_history_duration_unit.factor = factor(data$medical_history_duration_unit,levels=c("1","2","3","4")) # medical_history_duration_unit 112
data$old.conditions_complete.factor = factor(data$old.conditions_complete,levels=c("0","1","2")) # old.conditions_complete 96
data$symptoms_yn.factor = factor(data$symptoms_yn,levels=c("0","1")) # symptoms_yn 68
data$symptoms_additional.factor = factor(data$symptoms_additional,levels=c("0","1")) # symptoms_additional 84
data$symptom_onset_unit.factor = factor(data$symptom_onset_unit,levels=c("1","2","3","4")) # symptom_onset_unit 90
data$symptom_current_or_resolved.factor = factor(data$symptom_current_or_resolved,levels=c("0","1")) # symptom_current_or_resolved 100
data$symptom_resolution_duration_unit.factor = factor(data$symptom_resolution_duration_unit,levels=c("1","2","3","4")) # symptom_resolution_duration_unit 118
data$symptom_intervention_causality.factor = factor(data$symptom_intervention_causality,levels=c("0","1","2","3")) # symptom_intervention_causality 114
data$symptoms_complete.factor = factor(data$symptoms_complete,levels=c("0","1","2")) # symptoms_complete 84
data$physical_exam_findings_yn.factor = factor(data$physical_exam_findings_yn,levels=c("0","1")) # physical_exam_findings_yn 96
data$physical_exam_findings_additional.factor = factor(data$physical_exam_findings_additional,levels=c("0","1")) # physical_exam_findings_additional 112
data$system.factor = factor(data$system,levels=c("1","2","3","5","6","7","8")) # system 78
data$general_appearance.factor = factor(data$general_appearance,levels=c("c26740","c50685")) # general_appearance 92
data$oral_cavity_exam.factor = factor(data$oral_cavity_exam,levels=c("c79545","c112199")) # oral_cavity_exam 89
data$skin_exam.factor = factor(data$skin_exam,levels=c("c26687","c2983","c26901")) # skin_exam 82
data$cardiovascular_exam.factor = factor(data$cardiovascular_exam,levels=c("c119203","c2998","c3036","c50591","c167437","c167445")) # cardiovascular_exam 131
data$respiratory_exam.factor = factor(data$respiratory_exam,levels=c("c191568","c119216","c191569","c87116","c78718","c61454","c191616","c191570","c36295")) # respiratory_exam 156
data$abdominal_exam.factor = factor(data$abdominal_exam,levels=c("c168074","c26682","c168075","c168096","c3100","c98700")) # abdominal_exam 122
data$extremities_exam.factor = factor(data$extremities_exam,levels=c("c49488","c168181")) # extremities_exam 89
data$phy.exam_complete.factor = factor(data$phy.exam_complete,levels=c("0","1","2")) # phy.exam_complete 84
data$show_lab_list_yn.factor = factor(data$show_lab_list_yn,levels=c("0","1")) # show_lab_list_yn 78
data$lab_location.factor = factor(data$lab_location,levels=c("1","2","3","4","5","6","7","8","9","10","11")) # lab_location 108
data$beta_hcg.factor = factor(data$beta_hcg,levels=c("0","1")) # beta_hcg 62
data$other_lab_tests_yn.factor = factor(data$other_lab_tests_yn,levels=c("0","1")) # other_lab_tests_yn 82
data$labs_checked_results.factor = factor(data$labs_checked_results,levels=c("0","1")) # labs_checked_results 86
data$labs_complete.factor = factor(data$labs_complete,levels=c("0","1","2")) # labs_complete 76
data$ecg_performed.factor = factor(data$ecg_performed,levels=c("1","0")) # ecg_performed 72
data$amplitude_standard.factor = factor(data$amplitude_standard,levels=c("0","1")) # amplitude_standard 82
data$rhythm.factor = factor(data$rhythm,levels=c("c100076","c111092","c111094","c111101","c111100","c88140","c17649")) # rhythm 118
data$normal_ecg.factor = factor(data$normal_ecg,levels=c("0","1")) # normal_ecg 66
data$ecg_findings_lbbb.factor = factor(data$ecg_findings_lbbb,levels=c("0","1")) # ecg_findings_lbbb 80
data$ecg_findings_rbbb.factor = factor(data$ecg_findings_rbbb,levels=c("0","1")) # ecg_findings_rbbb 80
data$ecg_findings_av_block.factor = factor(data$ecg_findings_av_block,levels=c("0","1")) # ecg_findings_av_block 88
data$ecg_findings_st_changes.factor = factor(data$ecg_findings_st_changes,levels=c("0","1")) # ecg_findings_st_changes 92
data$ecg_findings_abnormal_q_waves.factor = factor(data$ecg_findings_abnormal_q_waves,levels=c("0","1")) # ecg_findings_abnormal_q_waves 104
data$ecg_findings_nonspecific_intraventricular_conduction_delay.factor = factor(data$ecg_findings_nonspecific_intraventricular_conduction_delay,levels=c("0","1")) # ecg_findings_nonspecific_intraventricular_conduction_delay 162
data$ecg_findings_no_info.factor = factor(data$ecg_findings_no_info,levels=c("0","1")) # ecg_findings_no_info 86
data$ecg_findings_unknown.factor = factor(data$ecg_findings_unknown,levels=c("0","1")) # ecg_findings_unknown 86
data$ecg_findings_not_asked.factor = factor(data$ecg_findings_not_asked,levels=c("0","1")) # ecg_findings_not_asked 90
data$ecg_findings_asked_but_unknown.factor = factor(data$ecg_findings_asked_but_unknown,levels=c("0","1")) # ecg_findings_asked_but_unknown 106
data$ecg_findings_invalid.factor = factor(data$ecg_findings_invalid,levels=c("0","1")) # ecg_findings_invalid 86
data$ecg_findings_na.factor = factor(data$ecg_findings_na,levels=c("0","1")) # ecg_findings_na 76
data$ecg_audit_data.factor = factor(data$ecg_audit_data,levels=c("0","1")) # ecg_audit_data 74
data$ecg_technical_quality.factor = factor(data$ecg_technical_quality,levels=c("5","4","3","2","1")) # ecg_technical_quality 100
data$ecg_measurement_checked.factor = factor(data$ecg_measurement_checked,levels=c("0","1")) # ecg_measurement_checked 92
data$show_ecg_metadata_yn.factor = factor(data$show_ecg_metadata_yn,levels=c("0","1")) # show_ecg_metadata_yn 86
data$ecg.factor = factor(data$ecg,levels=c("0","1","2")) # ecg 56
data$taking_as_directed.factor = factor(data$taking_as_directed,levels=c("0","1")) # taking_as_directed 82
data$dosage_schedule.factor = factor(data$dosage_schedule,levels=c("1","2","3","4","5")) # dosage_schedule 88
data$reminder_method.factor = factor(data$reminder_method,levels=c("1","2","3","4")) # reminder_method 84
data$missed_study_medication.factor = factor(data$missed_study_medication,levels=c("0","1")) # missed_study_medication 92
data$missed_dose_count.factor = factor(data$missed_dose_count,levels=c("1","2","3","4","5")) # missed_dose_count 92
data$missed_dose_timing.factor = factor(data$missed_dose_timing,levels=c("1","2","3","4")) # missed_dose_timing 90
data$medication_discontinuation.factor = factor(data$medication_discontinuation,levels=c("0","1")) # medication_discontinuation 98
data$discontinuation_duration.factor = factor(data$discontinuation_duration,levels=c("1","2","3","4","5")) # discontinuation_duration 106
data$discontinuation_reason.factor = factor(data$discontinuation_reason,levels=c("1","2","3","4")) # discontinuation_reason 98
data$ran_out_of_medication.factor = factor(data$ran_out_of_medication,levels=c("0","1")) # ran_out_of_medication 88
data$daily_routine_change_medication_adherence_yn.factor = factor(data$daily_routine_change_medication_adherence_yn,levels=c("0","1")) # daily_routine_change_medication_adherence_yn 134
data$perceived_improvement.factor = factor(data$perceived_improvement,levels=c("0","1")) # perceived_improvement 88
data$challenges_taking_medication.factor = factor(data$challenges_taking_medication,levels=c("0","1")) # challenges_taking_medication 102
data$overall_compliance_rate.factor = factor(data$overall_compliance_rate,levels=c("1","2","3","4")) # overall_compliance_rate 100
data$compliance_complete.factor = factor(data$compliance_complete,levels=c("0","1","2")) # compliance_complete 88
data$adverse_event_this_cycle_yn.factor = factor(data$adverse_event_this_cycle_yn,levels=c("0","1")) # adverse_event_this_cycle_yn 100
data$serious_adverse_event_yn.factor = factor(data$serious_adverse_event_yn,levels=c("0","1")) # serious_adverse_event_yn 94
data$adverse_event_classification.factor = factor(data$adverse_event_classification,levels=c("2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30")) # adverse_event_classification 231
data$adverse_event_grade.factor = factor(data$adverse_event_grade,levels=c("1","2","3","4","5")) # adverse_event_grade 96
data$adverse_event_attribution.factor = factor(data$adverse_event_attribution,levels=c("1","2","3","4","5")) # adverse_event_attribution 108
data$adverse_event_action_taken.factor = factor(data$adverse_event_action_taken,levels=c("1","2","3","4")) # adverse_event_action_taken 106
data$adverse_event_followup.factor = factor(data$adverse_event_followup,levels=c("1","2","3","4")) # adverse_event_followup 98
data$additional_adverse_events_yn.factor = factor(data$additional_adverse_events_yn,levels=c("0","1")) # additional_adverse_events_yn 102
data$adverse_complete.factor = factor(data$adverse_complete,levels=c("0","1","2")) # adverse_complete 82
data$diuretic_use.factor = factor(data$diuretic_use,levels=c("0","1")) # diuretic_use 70
data$diuretic_dose_change.factor = factor(data$diuretic_dose_change,levels=c("0","1")) # diuretic_dose_change 86
data$menses.factor = factor(data$menses,levels=c("0","1")) # menses 58
data$regular_cycle.factor = factor(data$regular_cycle,levels=c("0","1")) # regular_cycle 72
data$drugs_dose_change.factor = factor(data$drugs_dose_change,levels=c("0","1")) # drugs_dose_change 80
data$show_lab_yn.factor = factor(data$show_lab_yn,levels=c("0","1")) # show_lab_yn 68
data$lab_tests_yn.factor = factor(data$lab_tests_yn,levels=c("0","1")) # lab_tests_yn 70
data$lab_tests_checked_yn.factor = factor(data$lab_tests_checked_yn,levels=c("0","1")) # lab_tests_checked_yn 86
data$abnormal_labs.factor = factor(data$abnormal_labs,levels=c("0","1")) # abnormal_labs 72
data$intervention_prevention_reason_yn.factor = factor(data$intervention_prevention_reason_yn,levels=c("0","1")) # intervention_prevention_reason_yn 112
data$intervention_delivered_yn.factor = factor(data$intervention_delivered_yn,levels=c("0","1")) # intervention_delivered_yn 96
data$explained_dosage.factor = factor(data$explained_dosage,levels=c("0","1")) # explained_dosage 78
data$intervention_comprehension_yn.factor = factor(data$intervention_comprehension_yn,levels=c("0","1")) # intervention_comprehension_yn 104
data$start_after_lab.factor = factor(data$start_after_lab,levels=c("0","1")) # start_after_lab 76
data$additional_notes_actions_yn.factor = factor(data$additional_notes_actions_yn,levels=c("0","1")) # additional_notes_actions_yn 100
data$medical_complete.factor = factor(data$medical_complete,levels=c("0","1","2")) # medical_complete 82
data$first_contact_successful_yn.factor = factor(data$first_contact_successful_yn,levels=c("0","1")) # first_contact_successful_yn 100
data$second_contact_successful_yn.factor = factor(data$second_contact_successful_yn,levels=c("0","1")) # second_contact_successful_yn 102
data$third_contact_successful_yn.factor = factor(data$third_contact_successful_yn,levels=c("0","1")) # third_contact_successful_yn 100
data$fourth_contact_successful_yn.factor = factor(data$fourth_contact_successful_yn,levels=c("0","1")) # fourth_contact_successful_yn 102
data$fifth_contact_successful_yn.factor = factor(data$fifth_contact_successful_yn,levels=c("0","1")) # fifth_contact_successful_yn 100
data$sixth_contact_successful_yn.factor = factor(data$sixth_contact_successful_yn,levels=c("0","1")) # sixth_contact_successful_yn 100
data$seventh_contact_successful_yn.factor = factor(data$seventh_contact_successful_yn,levels=c("0","1")) # seventh_contact_successful_yn 104
data$eighth_contact_successful_yn.factor = factor(data$eighth_contact_successful_yn,levels=c("0","1")) # eighth_contact_successful_yn 102
data$ninth_contact_successful_yn.factor = factor(data$ninth_contact_successful_yn,levels=c("0","1")) # ninth_contact_successful_yn 100
data$tenth_contact_successful_yn.factor = factor(data$tenth_contact_successful_yn,levels=c("0","1")) # tenth_contact_successful_yn 100
data$symptoms_since_treatment.factor = factor(data$symptoms_since_treatment,levels=c("0","1")) # symptoms_since_treatment 94
data$symptoms_resolved.factor = factor(data$symptoms_resolved,levels=c("0","1")) # symptoms_resolved 80
data$capsules_compliance.factor = factor(data$capsules_compliance,levels=c("0","1")) # capsules_compliance 84
data$missed_dose_last_week.factor = factor(data$missed_dose_last_week,levels=c("0","1","2","5")) # missed_dose_last_week 96
data$questions_yn.factor = factor(data$questions_yn,levels=c("0","1")) # questions_yn 70
data$questions_resolved_yn.factor = factor(data$questions_resolved_yn,levels=c("0","1")) # questions_resolved_yn 88
data$followup_complete.factor = factor(data$followup_complete,levels=c("0","1","2")) # followup_complete 84
data$completed_intervention.factor = factor(data$completed_intervention,levels=c("0","1","99")) # completed_intervention 95
data$non_completion_reason.factor = factor(data$non_completion_reason,levels=c("c41331","c28554","c139236","c48226","c176343","c48227","c150884","c156551","c49631","c161411","c191340","c48250","c191656","c35571","c50996","c142185","c142349","c191339","c49628","c166074","c161410","c49632","c49633","c49634","c176342","c17649")) # non_completion_reason 327
data$conclusion_info_view_yn.factor = factor(data$conclusion_info_view_yn,levels=c("0","1")) # conclusion_info_view_yn 92
data$ethical_additional_measures_yn.factor = factor(data$ethical_additional_measures_yn,levels=c("0","1","2")) # ethical_additional_measures_yn 110
data$conclusion_complete.factor = factor(data$conclusion_complete,levels=c("0","1","2")) # conclusion_complete 88
data$attachment_type.factor = factor(data$attachment_type,levels=c("1","2","3","4","5","6","7","8","9","10","11","12","13")) # attachment_type 124
data$attachment_complete_yn.factor = factor(data$attachment_complete_yn,levels=c("0","1","2")) # attachment_complete_yn 94
```

## (?) Assign labels to factor levels
```{r, eval = FALSE}
levels(data$event_name.factor)=c("Eleg","1visit","2visit","3visit") # event_name 67
levels(data$repeat_instrument.factor)=c("Sintomas","Exame fsico","Exames Laboratoriais","Adeso","Eventos Adversos","CONTATO SEMANAL","Comorbidades","Medicamentos De Uso Habitual","Medicamentos Prvios","Antecedentes Pessoais","ANEXOS") # repeat_instrument 237
levels(data$ubs.factor)=c("Vila Reis - ESF I Gilberto Rinaldi, UBS I Dr Pedro Saud","Bom Jesus - ESF II Nelson Pereira Lima","Ilha Grande - ESF III Joo Pegoraro","Juruce - ESF/UBS IV Sarandy","Vila Paulista - ESF V Joao Augusto dos Reis","Morumbi - ESF VI Antonio Jacomini","Doutor Francisco Xavier Toda Filho - ESF VII","Santa Julia - UBS Ruth Rodrigues de Pereira") # ubs 368
levels(data$contact_options.factor)=c("Ligao regular (operadora)","WhatsApp: mensagem","WhatsApp: mensagem, ligao udio","WhatsApp: mensagem, ligao udio/vdeo","Todos") # contact_options 175
levels(data$contact_hours.factor)=c("Manh","Manh e tarde","Tarde","Noite","Tarde e noite","Qualquer horrio") # contact_hours 111
levels(data$contact_days.factor)=c("Dias da semana","Final de semana","Qualquer dia") # contact_days 85
levels(data$transport_research_center.factor)=c("Depende exclusivamente do transporte oferecido","Se necessrio pode ir por meios prprios","Em todas as avaliaes pode ir por meios prprios") # transport_research_center 192
levels(data$research_source_info.factor)=c("Anncio pblico na UBS (poster, vdeo)","Divulgao por meio da equipe de enfermagem da UBS","Divulgao por meio do Mdico da UBS","Referncia de outro participante","Busca ativa por voluntrios","Outros") # research_source_info 250
levels(data$availability_comments_yn.factor)=c("No","Sim") # availability_comments_yn 59
levels(data$sex.factor)=c("Feminino","Masculino") # sex 49
levels(data$pregnant_nursing_yn.factor)=c("No","Sim") # pregnant_nursing_yn 54
levels(data$eleg_comorbidity_yn.factor)=c("No","Sim") # eleg_comorbidity_yn 54
levels(data$drug_use_yn.factor)=c("No","Sim") # drug_use_yn 46
levels(data$high_risk_pregnancy_ineffective_contraceptives.factor)=c("Unchecked","Checked") # high_risk_pregnancy_ineffective_contraceptives 91
levels(data$high_risk_pregnancy_inconsistent_contraceptives.factor)=c("Unchecked","Checked") # high_risk_pregnancy_inconsistent_contraceptives 92
levels(data$high_risk_pregnancy_unprotected_sex.factor)=c("Unchecked","Checked") # high_risk_pregnancy_unprotected_sex 80
levels(data$high_risk_pregnancy_infertility_treatment.factor)=c("Unchecked","Checked") # high_risk_pregnancy_infertility_treatment 86
levels(data$high_risk_pregnancy_postpartum.factor)=c("Unchecked","Checked") # high_risk_pregnancy_postpartum 75
levels(data$high_risk_pregnancy_none.factor)=c("Unchecked","Checked") # high_risk_pregnancy_none 69
levels(data$high_risk_fem_noinfo.factor)=c("Unchecked","Checked") # high_risk_fem_noinfo 65
levels(data$high_risk_fem_unknown.factor)=c("Unchecked","Checked") # high_risk_fem_unknown 66
levels(data$high_risk_fem_notasked.factor)=c("Unchecked","Checked") # high_risk_fem_notasked 67
levels(data$high_risk_fem_askunknown.factor)=c("Unchecked","Checked") # high_risk_fem_askunknown 69
levels(data$high_risk_fem_invalid.factor)=c("Unchecked","Checked") # high_risk_fem_invalid 66
levels(data$high_risk_fem_na.factor)=c("Unchecked","Checked") # high_risk_fem_na 61
levels(data$pregnancy_test_and_contraceptive_agreement.factor)=c("No","Sim") # pregnancy_test_and_contraceptive_agreement 77
levels(data$low_risk_pregnancy_effective_contraceptives.factor)=c("Unchecked","Checked") # low_risk_pregnancy_effective_contraceptives 88
levels(data$menopause.factor)=c("Unchecked","Checked") # menopause 54
levels(data$low_risk_pregnancy_surgical_sterilization.factor)=c("Unchecked","Checked") # low_risk_pregnancy_surgical_sterilization 86
levels(data$low_risk_pregnancy_no_sex_6_months.factor)=c("Unchecked","Checked") # low_risk_pregnancy_no_sex_6_months 79
levels(data$low_risk_pregnancy_no_sex.factor)=c("Unchecked","Checked") # low_risk_pregnancy_no_sex 70
levels(data$low_risk_pregnancy_infertility_diagnosis.factor)=c("Unchecked","Checked") # low_risk_pregnancy_infertility_diagnosis 85
levels(data$low_risk_pregnancy_exclusive_homo_sexual_behavior.factor)=c("Unchecked","Checked") # low_risk_pregnancy_exclusive_homo_sexual_behavior 94
levels(data$low_risk_fem_noinfo.factor)=c("Unchecked","Checked") # low_risk_fem_noinfo 64
levels(data$low_risk_fem_unknown.factor)=c("Unchecked","Checked") # low_risk_fem_unknown 65
levels(data$low_risk_fem_notasked.factor)=c("Unchecked","Checked") # low_risk_fem_notasked 66
levels(data$low_risk_fem_askunknown.factor)=c("Unchecked","Checked") # low_risk_fem_askunknown 68
levels(data$low_risk_fem_invalid.factor)=c("Unchecked","Checked") # low_risk_fem_invalid 65
levels(data$low_risk_fem_na.factor)=c("Unchecked","Checked") # low_risk_fem_na 60
levels(data$contraceptive_continuation_agreement.factor)=c("No","Sim") # contraceptive_continuation_agreement 71
levels(data$eleg_lab_location.factor)=c("ESF I - VILA REIS (Gilberto Rinaldi)","ESF II - BOM JESUS (Nelson Pereira Lima)","ESF III - ILHA GRANDE (Joo Pegoraro)","ESF IV - JURUC (Sarandy)","ESF V - VILA PAULISTA (Joao Augusto dos Reis)","ESF VI - MORUMBI (Antonio Jacomini)","ESF VII - CESAR CAPATO (Doutor Francisco Xavier Toda Filho)","UBS - SANTA JULIA (Ruth Rodrigues de Pereira)","UBS - VILA REIS (Dr Pedro Saud)","UBS - MORUMBI","CENTRO DE SADE") # eleg_lab_location 454
levels(data$lab_collected_yn.factor)=c("No","Sim") # lab_collected_yn 51
levels(data$lab_checked_yn.factor)=c("No","Sim") # lab_checked_yn 49
levels(data$lab_finding_yn.factor)=c("No","Sim") # lab_finding_yn 49
levels(data$lab_exclusion_yn.factor)=c("No","Sim") # lab_exclusion_yn 51
levels(data$bhcg.factor)=c("Negativo","Positivo","No realizado") # bhcg 65
levels(data$preserved_hormone.factor)=c("No","Sim") # preserved_hormone 52
levels(data$contraception_ready_yn.factor)=c("No","Sim") # contraception_ready_yn 57
levels(data$consent_sent_yn.factor)=c("No","Sim") # consent_sent_yn 50
levels(data$consent_read_yn.factor)=c("No","Sim") # consent_read_yn 50
levels(data$consent_questions_yn.factor)=c("No","Sim") # consent_questions_yn 55
levels(data$consent_questions_cleared_yn.factor)=c("No","Sim") # consent_questions_cleared_yn 63
levels(data$participant_desire_yn.factor)=c("No","Sim") # participant_desire_yn 56
levels(data$sms_consent_yn.factor)=c("No","Sim") # sms_consent_yn 49
levels(data$block_alerts_1st_yn.factor)=c("No","Yes") # block_alerts_1st_yn 53
levels(data$eleg_complete.factor)=c("Incomplete","Unverified","Complete") # eleg_complete 73
levels(data$consent_signed_yn.factor)=c("No","Sim") # consent_signed_yn 52
levels(data$tcle_complete.factor)=c("Incomplete","Unverified","Complete") # tcle_complete 73
levels(data$race.factor)=c("Asitico (Asian: C41260)","Branco (White, C41261) Denotes a person with European, Middle Eastern, or North African ancestral origin who identifies, or is identified, as White. (FDA)","Branco, Amrica do Sul (White South American, C128994) A person having origins in the original peoples of Europe, the Middle East, or North Africa, and South America.","Negro (Black, C16352)","Desconhecido (Unknown, C17998): Not known, not observed, not recorded, or refused.","Outro (Other, C17649) {race_other}") # race 526
levels(data$marital_status.factor)=c("divorciado (divorced: C51776)","Amasiado (domestic partner: C53262)","Casado (married: C51773)","Solteiro (never married: C51774)","Separado (separated: C156541)","Vivo (widowed: C51775)") # marital_status 227
levels(data$employment_status.factor)=c("Tempo integral (Full-Time: C52658)","Desempregado (Not Employed: C75563)","Tempo parcial (Part-Time: C75562)") # employment_status 151
levels(data$income_level.factor)=c("At R$1.000","R$1.001 - R$3.000","R$3.001 - R$5.000","R$5.000 - R$10.000","Acima de R$10.000") # income_level 130
levels(data$demographic_complete.factor)=c("Incomplete","Unverified","Complete") # demographic_complete 80
levels(data$whoqol_1_quality.factor)=c("Muito ruim","Ruim","Nem ruim nem boa","Boa","Muito boa") # whoqol_1_quality 96
levels(data$whoqol_2_health.factor)=c("Muito insatisfeito","Insatisfeito","Nem satisfeito nem insatisfeito","Satisfeito","Muito satisfeito") # whoqol_2_health 140
levels(data$whoqol_3_pain.factor)=c("Nada","Muito pouco","Mais ou menos","Bastante","Extremamente") # whoqol_3_pain 99
levels(data$whoqol_4_treatment.factor)=c("Nada","Muito pouco","Mais ou menos","Bastante","Extremamente") # whoqol_4_treatment 104
levels(data$whoqol_5_enjoyment.factor)=c("Nada","Muito pouco","Mais ou menos","Bastante","Extremamente") # whoqol_5_enjoyment 104
levels(data$whoqol_6_meaning.factor)=c("Nada","Muito pouco","Mais ou menos","Bastante","Extremamente") # whoqol_6_meaning 102
levels(data$whoqol_7_concentration.factor)=c("Nada","Muito pouco","Mais ou menos","Bastante","Extremamente") # whoqol_7_concentration 108
levels(data$whoqol_8_security.factor)=c("Nada","Muito pouco","Mais ou menos","Bastante","Extremamente") # whoqol_8_security 103
levels(data$whoqol_9_environment.factor)=c("Nada","Muito pouco","Mais ou menos","Bastante","Extremamente") # whoqol_9_environment 106
levels(data$whoqol_10_energy.factor)=c("Nada","Muito pouco","Mdio","Muito","Completamente") # whoqol_10_energy 92
levels(data$whoqol_11_appearance.factor)=c("Nada","Muito pouco","Mdio","Muito","Completamente") # whoqol_11_appearance 96
levels(data$whoqol_12_finances.factor)=c("Nada","Muito pouco","Mdio","Muito","Completamente") # whoqol_12_finances 94
levels(data$whoqol_13_information.factor)=c("Nada","Muito pouco","Mdio","Muito","Completamente") # whoqol_13_information 97
levels(data$whoqol_14_leisure.factor)=c("Nada","Muito pouco","Mdio","Muito","Completamente") # whoqol_14_leisure 93
levels(data$whoqol_15_mobility.factor)=c("Muito ruim","Ruim","Nem ruim nem boa","Boa","Muito boa") # whoqol_15_mobility 98
levels(data$whoqol_16_sleep.factor)=c("Muito ruim","Ruim","Nem ruim nem boa","Boa","Muito boa") # whoqol_16_sleep 95
levels(data$whoqol_17_activities.factor)=c("Muito ruim","Ruim","Nem ruim nem boa","Boa","Muito boa") # whoqol_17_activities 100
levels(data$whoqol_18_work.factor)=c("Muito ruim","Ruim","Nem ruim nem boa","Boa","Muito boa") # whoqol_18_work 94
levels(data$whoqol_19_selfesteem.factor)=c("Muito ruim","Ruim","Nem ruim nem boa","Boa","Muito boa") # whoqol_19_selfesteem 100
levels(data$whoqol_20_relationships.factor)=c("Muito ruim","Ruim","Nem ruim nem boa","Boa","Muito boa") # whoqol_20_relationships 103
levels(data$whoqol_21_sexual.factor)=c("Muito ruim","Ruim","Nem ruim nem boa","Boa","Muito boa") # whoqol_21_sexual 96
levels(data$whoqol_22_support.factor)=c("Muito ruim","Ruim","Nem ruim nem boa","Boa","Muito boa") # whoqol_22_support 97
levels(data$whoqol_23_housing.factor)=c("Muito ruim","Ruim","Nem ruim nem boa","Boa","Muito boa") # whoqol_23_housing 97
levels(data$whoqol_24_health_services.factor)=c("Muito ruim","Ruim","Nem ruim nem boa","Boa","Muito boa") # whoqol_24_health_services 105
levels(data$whoqol_25_transport.factor)=c("Muito ruim","Ruim","Nem ruim nem boa","Boa","Muito boa") # whoqol_25_transport 99
levels(data$whoqol_26_negativity.factor)=c("Nunca","Algumas vezes","Frequentemente","Muito frequentemente","Sempre") # whoqol_26_negativity 116
levels(data$whoqol_needed_help.factor)=c("No precisei de ajuda","Um pesquisador me ajudou relendo alguma pergunta que eu no entendi","O questionrio foi administrado por um pesquisador") # whoqol_needed_help 188
levels(data$whoqol_complete.factor)=c("Incomplete","Unverified","Complete") # whoqol_complete 75
levels(data$dass_1_not_calm.factor)=c("No se aplicou de maneira alguma","Aplicou-se em algum grau, ou por pouco de tempo","Aplicou-se em um grau considervel, ou por uma boa parte do tempo","Aplicou-se muito, ou na maioria do tempo") # dass_1_not_calm 234
levels(data$dass_2_drymouth.factor)=c("No se aplicou de maneira alguma","Aplicou-se em algum grau, ou por pouco de tempo","Aplicou-se em um grau considervel, ou por uma boa parte do tempo","Aplicou-se muito, ou na maioria do tempo") # dass_2_drymouth 234
levels(data$dass_3_not_positive.factor)=c("No se aplicou de maneira alguma","Aplicou-se em algum grau, ou por pouco de tempo","Aplicou-se em um grau considervel, ou por uma boa parte do tempo","Aplicou-se muito, ou na maioria do tempo") # dass_3_not_positive 238
levels(data$dass_4_hard_breath.factor)=c("No se aplicou de maneira alguma","Aplicou-se em algum grau, ou por pouco de tempo","Aplicou-se em um grau considervel, ou por uma boa parte do tempo","Aplicou-se muito, ou na maioria do tempo") # dass_4_hard_breath 237
levels(data$dass_5_no_initiative.factor)=c("No se aplicou de maneira alguma","Aplicou-se em algum grau, ou por pouco de tempo","Aplicou-se em um grau considervel, ou por uma boa parte do tempo","Aplicou-se muito, ou na maioria do tempo") # dass_5_no_initiative 239
levels(data$dass_6_exaggeration.factor)=c("No se aplicou de maneira alguma","Aplicou-se em algum grau, ou por pouco de tempo","Aplicou-se em um grau considervel, ou por uma boa parte do tempo","Aplicou-se muito, ou na maioria do tempo") # dass_6_exaggeration 238
levels(data$dass_7_tremor.factor)=c("No se aplicou de maneira alguma","Aplicou-se em algum grau, ou por pouco de tempo","Aplicou-se em um grau considervel, ou por uma boa parte do tempo","Aplicou-se muito, ou na maioria do tempo") # dass_7_tremor 232
levels(data$dass_8_nervous.factor)=c("No se aplicou de maneira alguma","Aplicou-se em algum grau, ou por pouco de tempo","Aplicou-se em um grau considervel, ou por uma boa parte do tempo","Aplicou-se muito, ou na maioria do tempo") # dass_8_nervous 233
levels(data$dass_9_worry.factor)=c("No se aplicou de maneira alguma","Aplicou-se em algum grau, ou por pouco de tempo","Aplicou-se em um grau considervel, ou por uma boa parte do tempo","Aplicou-se muito, ou na maioria do tempo") # dass_9_worry 231
levels(data$dass_10_no_desire.factor)=c("No se aplicou de maneira alguma","Aplicou-se em algum grau, ou por pouco de tempo","Aplicou-se em um grau considervel, ou por uma boa parte do tempo","Aplicou-se muito, ou na maioria do tempo") # dass_10_no_desire 236
levels(data$dass_11_agitation.factor)=c("No se aplicou de maneira alguma","Aplicou-se em algum grau, ou por pouco de tempo","Aplicou-se em um grau considervel, ou por uma boa parte do tempo","Aplicou-se muito, ou na maioria do tempo") # dass_11_agitation 236
levels(data$dass_12_not_relaxed.factor)=c("No se aplicou de maneira alguma","Aplicou-se em algum grau, ou por pouco de tempo","Aplicou-se em um grau considervel, ou por uma boa parte do tempo","Aplicou-se muito, ou na maioria do tempo") # dass_12_not_relaxed 238
levels(data$dass_13_depression.factor)=c("No se aplicou de maneira alguma","Aplicou-se em algum grau, ou por pouco de tempo","Aplicou-se em um grau considervel, ou por uma boa parte do tempo","Aplicou-se muito, ou na maioria do tempo") # dass_13_depression 237
levels(data$dass_14_intolerance.factor)=c("No se aplicou de maneira alguma","Aplicou-se em algum grau, ou por pouco de tempo","Aplicou-se em um grau considervel, ou por uma boa parte do tempo","Aplicou-se muito, ou na maioria do tempo") # dass_14_intolerance 238
levels(data$dass_15_panic.factor)=c("No se aplicou de maneira alguma","Aplicou-se em algum grau, ou por pouco de tempo","Aplicou-se em um grau considervel, ou por uma boa parte do tempo","Aplicou-se muito, ou na maioria do tempo") # dass_15_panic 232
levels(data$dass_16_no_enthusiasm.factor)=c("No se aplicou de maneira alguma","Aplicou-se em algum grau, ou por pouco de tempo","Aplicou-se em um grau considervel, ou por uma boa parte do tempo","Aplicou-se muito, ou na maioria do tempo") # dass_16_no_enthusiasm 240
levels(data$dass_17_no_selfworth.factor)=c("No se aplicou de maneira alguma","Aplicou-se em algum grau, ou por pouco de tempo","Aplicou-se em um grau considervel, ou por uma boa parte do tempo","Aplicou-se muito, ou na maioria do tempo") # dass_17_no_selfworth 239
levels(data$dass_18_too_emotional.factor)=c("No se aplicou de maneira alguma","Aplicou-se em algum grau, ou por pouco de tempo","Aplicou-se em um grau considervel, ou por uma boa parte do tempo","Aplicou-se muito, ou na maioria do tempo") # dass_18_too_emotional 240
levels(data$dass_19_palpitation.factor)=c("No se aplicou de maneira alguma","Aplicou-se em algum grau, ou por pouco de tempo","Aplicou-se em um grau considervel, ou por uma boa parte do tempo","Aplicou-se muito, ou na maioria do tempo") # dass_19_palpitation 238
levels(data$dass_20_fear.factor)=c("No se aplicou de maneira alguma","Aplicou-se em algum grau, ou por pouco de tempo","Aplicou-se em um grau considervel, ou por uma boa parte do tempo","Aplicou-se muito, ou na maioria do tempo") # dass_20_fear 231
levels(data$dass_21_no_meaning.factor)=c("No se aplicou de maneira alguma","Aplicou-se em algum grau, ou por pouco de tempo","Aplicou-se em um grau considervel, ou por uma boa parte do tempo","Aplicou-se muito, ou na maioria do tempo") # dass_21_no_meaning 237
levels(data$dass_complete.factor)=c("Incomplete","Unverified","Complete") # dass_complete 73
levels(data$ecap1.factor)=c("Eu no me sinto constrangido(a) com o meu peso ou o tamanho do meu corpo quando estou com outras pessoas.","Eu me sinto preocupado(a) em como pareo para os outros, mas isto, normalmente, no me faz sentir desapontado(a) comigo mesmo(a).","Eu fico mesmo constrangido(a) com a minha aparncia e o meu peso, o que me faz sentir desapontado(a) comigo mesmo(a).","Eu me sinto muito constrangido(a) com o meu peso e, freqentemente, sinto muita vergonha e desprezo por mim mesmo(a). Tento evitar contatos sociais por causa desse constrangimento.") # ecap1 571
levels(data$ecap2.factor)=c("Eu no tenho nenhuma dificuldade para comer devagar, de maneira","Embora parea que eu devore os alimentos, no acabo me sentindo empanturrado(a) por comer demais.","s vezes tendo a comer rapidamente, sentindo-me ento desconfortavelmente cheio(a) depois.","Eu tenho o hbito de engolir minha comida sem realmente mastig- la. Quando isto acontece, em geral me sinto desconfortavelmente empanturrado(a) por ter comido demais.") # ecap2 457
levels(data$ecap3.factor)=c("Eu me sinto capaz de controlar meus impulsos para comer, quando eu quero.","Eu sinto que tenho falhado em controlar meu comportamento alimentar mais do que a mdia das pessoas.","Eu me sinto totalmente incapaz de controlar meus impulsos para comer.","Por me sentir to incapaz de controlar meu comportamento alimentar, entro em desespero tentando manter o controle.") # ecap3 396
levels(data$ecap4.factor)=c("Eu no tenho o hbito de comer quando estou chateado(a).","s vezes eu como quando estou chateado(a) mas, freqentemente, sou capaz de me ocupar e afastar minha mente da comida.","Eu tenho o hbito regular de comer quando estou chateado(a) mas, de vez em quando, posso usar alguma outra atividade para afastar minha mente da comida","Eu tenho o forte hbito de comer quando estou chateado(a). Nada parece me ajudar a parar com esse hbito") # ecap4 469
levels(data$ecap5.factor)=c("Normalmente quando como alguma coisa  porque estou fisicamente com fome.","De vez em quando como alguma coisa por impulso, mesmo quando no estou realmente com fome.","Eu tenho o hbito regular de comer alimentos que realmente no aprecio para satisfazer uma sensao de fome, mesmo que fisicamente eu no necessite de comida.","Mesmo que no esteja fisicamente com fome, tenho uma sensao de fome em minha boca que somente parece ser satisfeita quando eu como um alimento, tipo um sanduche, que enche a minha boca. s vezes, quando eu como o alimento para satisfazer minha fome na boca, em seguida eu o cuspo, assim no ganharei peso.") # ecap5 669
levels(data$ecap6.factor)=c("Eu no sinto qualquer culpa ou dio de mim mesmo(a) depois de comer demais.","De vez em quando sinto culpa ou dio de mim mesmo(a) depois de comer demais.","Quase o tempo todo sinto muita culpa ou dio de mim mesmo(a) depois de comer demais.") # ecap6 272
levels(data$ecap7.factor)=c("Eu no perco o controle total da minha alimentao quando estou em dieta, mesmo aps perodos em que como demais.","s vezes, quando estou em dieta e como um alimento proibido, sinto como se tivesse estragado tudo e como ainda mais.","Freqentemente, quando como demais durante uma dieta, tenho o hbito de dizer para mim mesmo(a): agora que estraguei tudo, porque no irei at o fim. Quando isto acontece, eu como ainda mais.","Eu tenho o hbito regular de comear dietas rigorosas por mim mesmo(a), mas quebro as dietas entrando numa compulso alimentar. Minha vida parece ser uma festa ou um morrer de fome.") # ecap7 641
levels(data$ecap8.factor)=c("Eu raramente como tanta comida a ponto de me sentir desconfortavelmente empanturrado(a) depois.","Normalmente, cerca de uma vez por ms, como uma tal quantidade de comida que acabo me sentindo muito empanturrado(a).","Eu tenho perodos regulares durante o ms, quando como grandes quantidades de comida, seja na hora das refeies, seja nos lanches.","Eu como tanta comida que, regularmente, me sinto bastante desconfortvel depois de comer e, algumas vezes, um pouco enjoado(a).") # ecap8 510
levels(data$ecap9.factor)=c("Em geral, minha ingesta calrica no sobe a nveis muito altos, nem desce a nveis muito baixos.","s vezes, depois de comer demais, tento reduzir minha ingesta calrica para quase nada, para compensar o excesso de calorias que ingeri.","Eu tenho o hbito regular de comer demais durante a noite. Parece que a minha rotina no  estar com fome de manh, mas comer demais  noite.","Na minha vida adulta tenho tido perodos, que duram semanas, nos quais praticamente me mato de fome. Isto se segue a perodos em que como demais. Parece que vivo uma vida de festa ou de morrer de fome.") # ecap9 614
levels(data$ecap10.factor)=c("Normalmente eu sou capaz de parar de comer quando quero. Eu sei quando j chega.","De vez em quando, eu tenho uma compulso para comer que parece que no posso controlar.","Freqentemente tenho fortes impulsos para comer que parece que no sou capaz de controlar, mas, em outras ocasies, posso controlar meus impulsos para comer.","Eu me sinto incapaz de controlar impulsos para comer. Eu tenho medo de no ser capaz de parar de comer por vontade prpria.") # ecap10 488
levels(data$ecap11.factor)=c("Eu no tenho problema algum para parar de comer quando me sinto cheio(a).","Eu, normalmente, posso parar de comer quando me sinto cheio(a) mas, de vez em quando, comer demais me deixa desconfortavelmente empanturrado(a).","Eu tenho um problema para parar de comer uma vez que eu tenha comeado e, normalmente, sinto-me desconfortavelmente empanturrado(a) depois que fao uma refeio.","Por eu ter o problema de no ser capaz de parar de comer quando quero, s vezes tenho que provocar o vmito, usar laxativos e/ou diurticos para aliviar minha sensao de empanturramento.") # ecap11 606
levels(data$ecap12.factor)=c("Parece que eu como tanto quando estou com os outros (reunies familiares, sociais), como quando estou sozinho(a).","s vezes, quando eu estou com outras pessoas, no como tanto quanto eu quero comer porque me sinto constrangido(a) com o meu comportamento alimentar.","Freqentemente eu como s uma pequena quantidade de comida quando outros esto presentes, pois me sinto muito embaraado(a) com o meu comportamento alimentar.","Eu me sinto to envergonhado(a) por comer demais que escolho horas para comer demais quando sei que ningum me ver. Eu me sinto como uma pessoa que se esconde para comer.") # ecap12 632
levels(data$ecap13.factor)=c("Eu fao trs refeies ao dia com apenas um lanche ocasional entre as refeies.","Eu fao trs refeies ao dia mas, normalmente, tambm lancho entre as refeies.","Quando eu fao lanches pesados, tenho o hbito de pular as refeies regulares.","H perodos regulares em que parece que eu estou continuamente comendo, sem refeies planejadas.") # ecap13 378
levels(data$ecap14.factor)=c("Eu no penso muito em tentar controlar impulsos indesejveis para comer.","Pelo menos, em algum momento, sinto que meus pensamentos esto pr-ocupados com tentar controlar meus impulsos para comer.","Freqentemente, sinto que gasto muito tempo pensando no quanto comi ou tentando no comer mais.","Parece, para mim, que a maior parte das horas que passo acordado(a) esto pr-ocupadas por pensamentos sobre comer ou no comer. Sinto como se eu estivesse constantemente lutando para no comer.") # ecap14 524
levels(data$ecap15.factor)=c("Eu no penso muito sobre comida.","Eu tenho fortes desejos por comida, mas eles s duram curtos perodos de tempo.","H dias em que parece que eu no posso pensar em mais nada a no ser comida.","Na maioria dos dias, meus pensamentos parecem estar pr-ocupados com comida. Sinto como se eu vivesse para comer.") # ecap15 341
levels(data$ecap16.factor)=c("Eu normalmente sei se estou ou no fisicamente com fome. Eu como a poro certa de comida para me satisfazer.","De vez em quando eu me sinto em dvida para saber se estou ou no fisicamente com fome. Nessas ocasies  difcil saber quanto eu deveria comer para me satisfazer.","Mesmo que se eu pudesse saber quantas calorias eu deveria ingerir, no teria idia alguma de qual seria a quantidade normal de comida para mim.") # ecap16 453
levels(data$ecap_complete.factor)=c("Incomplete","Unverified","Complete") # ecap_complete 73
levels(data$bodycount_complete.factor)=c("Incomplete","Unverified","Complete") # bodycount_complete 78
levels(data$bp_limb_complete.factor)=c("Incomplete","Unverified","Complete") # bp_limb_complete 76
levels(data$bp_show_metadata.factor)=c("No","Sim") # bp_show_metadata 51
levels(data$bp_complete.factor)=c("Incomplete","Unverified","Complete") # bp_complete 71
levels(data$smoked_24h.factor)=c("N","S") # smoked_24h 41
levels(data$exercised_24h.factor)=c("N","S") # exercised_24h 44
levels(data$alcohol_24h.factor)=c("N","S") # alcohol_24h 42
levels(data$room_temperature.factor)=c("N","S") # room_temperature 47
levels(data$light_clothes.factor)=c("N","S") # light_clothes 44
levels(data$removed_objects.factor)=c("N","S") # removed_objects 46
levels(data$hairy_limbs.factor)=c("N","S") # hairy_limbs 42
levels(data$removed_hair.factor)=c("N","S") # removed_hair 43
levels(data$cleaned_skin.factor)=c("N","S") # cleaned_skin 43
levels(data$bed_rest_10min.factor)=c("N","S") # bed_rest_10min 45
levels(data$bia_show_metadata.factor)=c("No","Sim") # bia_show_metadata 52
levels(data$bia_complete.factor)=c("Incomplete","Unverified","Complete") # bia_complete 72
levels(data$grip_limitations_yn.factor)=c("No","Sim") # grip_limitations_yn 54
levels(data$grip_rh_limitations.factor)=c("Nenhuma","Paralisia da mo","Usando gesso no pulso ou na mo","A maior parte da mo coberta por bandagens","Ausncia do polegar ou dedos quebrados","Outra limitao significativa {grip_rhlimitother}") # grip_rh_limitations 243
levels(data$grip_lh_no_limitations.factor)=c("Unchecked","Checked") # grip_lh_no_limitations 67
levels(data$grip_lh_paralysis.factor)=c("Unchecked","Checked") # grip_lh_paralysis 62
levels(data$grip_lh_cast.factor)=c("Unchecked","Checked") # grip_lh_cast 57
levels(data$grip_lh_bandaged.factor)=c("Unchecked","Checked") # grip_lh_bandaged 61
levels(data$grip_lh_missing_thumb.factor)=c("Unchecked","Checked") # grip_lh_missing_thumb 66
levels(data$grip_lh_other_limitations.factor)=c("Unchecked","Checked") # grip_lh_other_limitations 70
levels(data$grip_lh_no_info.factor)=c("Unchecked","Checked") # grip_lh_no_info 60
levels(data$grip_lh_unknown.factor)=c("Unchecked","Checked") # grip_lh_unknown 60
levels(data$grip_lh_notasked.factor)=c("Unchecked","Checked") # grip_lh_notasked 61
levels(data$grip_lh_askunknown.factor)=c("Unchecked","Checked") # grip_lh_askunknown 63
levels(data$grip_lh_invalid.factor)=c("Unchecked","Checked") # grip_lh_invalid 60
levels(data$grip_lh_na.factor)=c("Unchecked","Checked") # grip_lh_na 55
levels(data$grip_recent_surgery_yn.factor)=c("No","Sim,  direita","Sim,  esquerda") # grip_recent_surgery_yn 86
levels(data$grip_exclude_test_yn.factor)=c("No","Sim, no deveria testar a mo direita","Sim, no deveria testar a mo esquerda","Sim, no deveria testar ambas as mos") # grip_exclude_test_yn 170
levels(data$grip_surgery_history_yn.factor)=c("No","Sim, na mo ou pulso direito","Sim, na mo ou pulso esquerdo","Sim, em ambas as mos") # grip_surgery_history_yn 139
levels(data$grip_dominance.factor)=c("Destro","Canhoto","Ambidestro") # grip_dominance 69
levels(data$grip_pain_last7days_yn.factor)=c("No","Sim, na mo direita","Sim, na mo esquerda","Sim, em ambas as mos") # grip_pain_last7days_yn 120
levels(data$grip_rhpain.factor)=c("No","Sim") # grip_rhpain 46
levels(data$grip_lhpain.factor)=c("No","Sim") # grip_lhpain 46
levels(data$grip_test_procedure_understanding_yn.factor)=c("No","Sim") # grip_test_procedure_understanding_yn 71
levels(data$grip_see_metadata.factor)=c("No","Sim") # grip_see_metadata 52
levels(data$handgrip_complete.factor)=c("Incomplete","Unverified","Complete") # handgrip_complete 77
levels(data$frequency_bowel.factor)=c("Diariamente","A cada dois dias","Trs vezes por semana","Menos de trs vezes por semana") # frequency_bowel 128
levels(data$frequency_solid_stool.factor)=c("Sempre","Na maioria das vezes","Raramente","Nunca") # frequency_solid_stool 96
levels(data$frequency_diarrhea.factor)=c("Nunca","Raramente","Com frequncia","Sempre") # frequency_diarrhea 87
levels(data$contipation_yn.factor)=c("Sim","No") # contipation_yn 49
levels(data$frequency_laxative.factor)=c("Nunca","Raramente","Diariamente","Semanalmente","Mensalmente") # frequency_laxative 104
levels(data$urinary_frequency.factor)=c("Habitual","Aumentada","Diminuda") # urinary_frequency 75
levels(data$water_consumption.factor)=c("Habitual","Aumentada","Diminuda") # water_consumption 75
levels(data$hair_loss.factor)=c("Nunca","Leve","Moderada","Intensa","Muito intensa") # hair_loss 84
levels(data$nutrition_complete.factor)=c("Incomplete","Unverified","Complete") # nutrition_complete 78
levels(data$food_alergy.factor)=c("Sim","No") # food_alergy 46
levels(data$peanut_allergy.factor)=c("Sim","No") # peanut_allergy 49
levels(data$nut_allergy.factor)=c("Sim","No") # nut_allergy 46
levels(data$seafood_allergy.factor)=c("Sim","No") # seafood_allergy 50
levels(data$egg_allergy.factor)=c("Sim","No") # egg_allergy 46
levels(data$lactose_intolerance.factor)=c("Sim","No") # lactose_intolerance 54
levels(data$gluten_intolerance.factor)=c("Sim","No") # gluten_intolerance 53
levels(data$soy_allergy.factor)=c("Sim","No") # soy_allergy 46
levels(data$fish_allergy.factor)=c("Sim","No") # fish_allergy 47
levels(data$allergy_complete.factor)=c("Incomplete","Unverified","Complete") # allergy_complete 76
levels(data$evs_days.factor)=c("0","1","2","3","4","5","6","7") # evs_days 63
levels(data$evs_time.factor)=c("0","10","20","30","40","50","60","90","120","150") # evs_time 82
levels(data$exercise_type_1.factor)=c("Alongamento (Stretching; NCIT: C154225)","Aquecimento (Warm-Up; NCIT: C122029)","Atividade da Vida Diria (Activity of Daily Living; NCIT: C53291)","Atividade de Lazer (Leisure Activity; NCIT: C104103)","Boliche (Bowling; NCIT: C172270)","Calistenia (Calisthenics; NCIT: C94739)","Caminhada (Walking) (Walking; NCIT: C73554)","Ciclismo (Bicicleta) (Bicycling; NCIT: C85401)","Corrida leve (Jogging; NCIT: C85398)","Corrida vigorosa (Running; NCIT: C94737)","Dana (Dancing; NCIT: C172269)","Escalada (Climbing; NCIT: C81002)","Levantamento de Peso (Lifting; NCIT: C86567)","Natao (Swimming; NCIT: C94738)","Operao de Mquinas Pesadas (Operation of Heavy Machinery; NCIT: C168795)","Permanecer Fora da Cama (Stay Out of Bed; NCIT: C95543)","Realizar Tarefas de rua (ir ao mercado, pagar contas) (Run Errand; NCIT: C95549)","Remada (Seated Row; NCIT: C122031)","Trabalho Leve (Light Work; NCIT: C95545)","Trabalho Pesado (Hard Work; NCIT: C95547)","Treinamento com Resistncia (Resistance Training; NCIT: C154219)") # exercise_type_1 1056
levels(data$secondary_physical_activity_yn.factor)=c("No","Alongamento (Stretching; NCIT: C154225)","Aquecimento (Warm-Up; NCIT: C122029)","Atividade da Vida Diria (Activity of Daily Living; NCIT: C53291)","Atividade de Lazer (Leisure Activity; NCIT: C104103)","Boliche (Bowling; NCIT: C172270)","Calistenia (Calisthenics; NCIT: C94739)","Caminhada (Walking) (Walking; NCIT: C73554)","Ciclismo (Bicicleta) (Bicycling; NCIT: C85401)","Corrida leve (Jogging; NCIT: C85398)","Corrida vigorosa (Running; NCIT: C94737)","Dana (Dancing; NCIT: C172269)","Escalada (Climbing; NCIT: C81002)","Levantamento de Peso (Lifting; NCIT: C86567)","Natao (Swimming; NCIT: C94738)","Operao de Mquinas Pesadas (Operation of Heavy Machinery; NCIT: C168795)","Permanecer Fora da Cama (Stay Out of Bed; NCIT: C95543)","Realizar Tarefas de rua (ir ao mercado, pagar contas) (Run Errand; NCIT: C95549)","Remada (Seated Row; NCIT: C122031)","Trabalho Leve (Light Work; NCIT: C95545)","Trabalho Pesado (Hard Work; NCIT: C95547)","Treinamento com Resistncia (Resistance Training; NCIT: C154219)") # secondary_physical_activity_yn 1077
levels(data$tertiary_physical_activity_yn.factor)=c("No","Alongamento (Stretching; NCIT: C154225)","Aquecimento (Warm-Up; NCIT: C122029)","Atividade da Vida Diria (Activity of Daily Living; NCIT: C53291)","Atividade de Lazer (Leisure Activity; NCIT: C104103)","Boliche (Bowling; NCIT: C172270)","Calistenia (Calisthenics; NCIT: C94739)","Caminhada (Walking) (Walking; NCIT: C73554)","Ciclismo (Bicicleta) (Bicycling; NCIT: C85401)","Corrida leve (Jogging; NCIT: C85398)","Corrida vigorosa (Running; NCIT: C94737)","Dana (Dancing; NCIT: C172269)","Escalada (Climbing; NCIT: C81002)","Levantamento de Peso (Lifting; NCIT: C86567)","Natao (Swimming; NCIT: C94738)","Operao de Mquinas Pesadas (Operation of Heavy Machinery; NCIT: C168795)","Permanecer Fora da Cama (Stay Out of Bed; NCIT: C95543)","Realizar Tarefas de rua (ir ao mercado, pagar contas) (Run Errand; NCIT: C95549)","Remada (Seated Row; NCIT: C122031)","Trabalho Leve (Light Work; NCIT: C95545)","Trabalho Pesado (Hard Work; NCIT: C95547)","Treinamento com Resistncia (Resistance Training; NCIT: C154219)") # tertiary_physical_activity_yn 1076
levels(data$evs_complete.factor)=c("Incomplete","Unverified","Complete") # evs_complete 72
levels(data$alcohol_frequency.factor)=c("Nunca: No consome bebidas alcolicas","Ocasionalmente: Consumo espordico, em ocasies especiais","Regularmente: Consumo em uma base consistente, mas no diariamente","Diariamente: Consumo de lcool todos os dias","Ex-etilista") # alcohol_frequency 270
levels(data$alcohol_stopped_years_ago.factor)=c("Menos de 1 ano","1 a 5 anos","5 a 10 anos","10 a 20 anos","Mais de 20 anos") # alcohol_stopped_years_ago 125
levels(data$years_drinks_alcohol.factor)=c("Menos de 2 anos","2 a 5 anos","5 a 10 anos","10 a 20 anos","Mais de 20 anos") # years_drinks_alcohol 121
levels(data$beer_yn.factor)=c("Unchecked","Checked") # beer_yn 52
levels(data$wine_yn.factor)=c("Unchecked","Checked") # wine_yn 52
levels(data$spirit_yn.factor)=c("Unchecked","Checked") # spirit_yn 54
levels(data$alcohol_type_other.factor)=c("Unchecked","Checked") # alcohol_type_other 63
levels(data$alcohol_type_no_info.factor)=c("Unchecked","Checked") # alcohol_type_no_info 65
levels(data$alcohol_type_unknown.factor)=c("Unchecked","Checked") # alcohol_type_unknown 65
levels(data$alcohol_type_not_asked.factor)=c("Unchecked","Checked") # alcohol_type_not_asked 67
levels(data$alcohol_type_asked_unknown.factor)=c("Unchecked","Checked") # alcohol_type_asked_unknown 71
levels(data$alcohol_type_invalid.factor)=c("Unchecked","Checked") # alcohol_type_invalid 65
levels(data$alcohol_type_na.factor)=c("Unchecked","Checked") # alcohol_type_na 60
levels(data$alcohol_complete.factor)=c("Incomplete","Unverified","Complete") # alcohol_complete 76
levels(data$smoke_history.factor)=c("No","Sim, e continua fumando","Sim, mas parou") # smoke_history 85
levels(data$tobacco_complete.factor)=c("Incomplete","Unverified","Complete") # tobacco_complete 76
levels(data$diet_recall_complete.factor)=c("Incomplete","Unverified","Complete") # diet_recall_complete 80
levels(data$meal_breakfast_yn.factor)=c("Unchecked","Checked") # meal_breakfast_yn 62
levels(data$meal_morning_snack_yn.factor)=c("Unchecked","Checked") # meal_morning_snack_yn 66
levels(data$meal_lunch_yn.factor)=c("Unchecked","Checked") # meal_lunch_yn 58
levels(data$meal_afternoon_snack_yn.factor)=c("Unchecked","Checked") # meal_afternoon_snack_yn 68
levels(data$meal_dinner_yn.factor)=c("Unchecked","Checked") # meal_dinner_yn 59
levels(data$meal_supper_yn.factor)=c("Unchecked","Checked") # meal_supper_yn 59
levels(data$meal_no_info.factor)=c("Unchecked","Checked") # meal_no_info 57
levels(data$meal_unknown.factor)=c("Unchecked","Checked") # meal_unknown 57
levels(data$meal_not_asked.factor)=c("Unchecked","Checked") # meal_not_asked 59
levels(data$meal_asked_unknown.factor)=c("Unchecked","Checked") # meal_asked_unknown 63
levels(data$meal_invalid.factor)=c("Unchecked","Checked") # meal_invalid 57
levels(data$meal_na.factor)=c("Unchecked","Checked") # meal_na 52
levels(data$diet_values_complete.factor)=c("Incomplete","Unverified","Complete") # diet_values_complete 80
levels(data$intervention_capsule_start_yn.factor)=c("No","Sim") # intervention_capsule_start_yn 64
levels(data$weekly_alert_remove_yn.factor)=c("No","Sim") # weekly_alert_remove_yn 57
levels(data$dates_complete.factor)=c("Incomplete","Unverified","Complete") # dates_complete 74
levels(data$allocation_group.factor)=c("Grupo A","Grupo B") # allocation_group 59
levels(data$allocation_complete.factor)=c("Incomplete","Unverified","Complete") # allocation_complete 79
levels(data$comorbidity_yn.factor)=c("No","Sim") # comorbidity_yn 49
levels(data$comorbidity_additional.factor)=c("No","Sim") # comorbidity_additional 57
levels(data$common_comorbidities.factor)=c("C3390 - Acidente vascular cerebral","C6996 - Adenomiose","C2869 - Anemia","C26696 - Ansiedade","C35145 - Apendicite","C2884 - Artrite reumatoide","C3318 - lcera pptica","C28397 - Asma","C26722 - Bronquite crnica","C52593 - Crie dentria","C9305 - Cncer","C2920 - Cncer de pele","C34449 - Cardiomiopatia hipertrfica","C26713 - Catarata","C122822 - Colelitase","C97162 - Compulso alimentar","C4786 - Demncia","C2982 - Depresso","C26747 - Diabetes mellitus tipo 2","C2987 - Diarreia","C63709 - Disfuno temporomandibular","C4922 - Diverticulose","C26732 - Doena arterial coronariana","C2866 - Doena de Alzheimer","C2965 - Doena de Crohn","C3071 - Doena de Graves","C26845 - Doena de Parkinson","C26781 - Doena do refluxo gastroesofgico","C113609 - Doena heptica crnica","C84444 - Doena heptica gordurosa no alcolica, Esteatose","C3138 - Doena inflamatria intestinal","C3889 - Doena inflamatria plvica","C164315 - Doena pulmonar intersticial","C3199 - Doena pulmonar obstrutiva crnica","C80078 - Doena renal crnica","C2931 - Doenas cardiovascular","C41830 - Dor nas costas","C3001 - Eczema","C26862 - Endometriose","C89715 - Enxaqueca","C3020 - Epilepsia","C2891 - Esfago de Barrett","C3243 - Esclerose mltipla","C9224 - Esofagite","C3362 - Esquizofrenia","C79821 - Estenose uretral","C50466 - Fibrilao atrial","C87497 - Fibromialgia","C26780 - Gastrite crnica","C26782 - Glaucoma","C26785 - Goiter (Bcio)","C34650 - Gota","C98945 - Hrnia de Hiato","C39293 - Helicobacter Pylori Infection (Infeco por H. pylori)","C26792 - Hepatite","C37967 - Hipercolesterolemia (LDL  130 ou no-HDL  160 ou CT  190 mg/dl)","C3117 - Hipertenso","C197871 - Hipertenso pulmonar tromboemblica crnica","C3123 - Hipertiroidismo","C37971 - Hipertrigliceridemia (TAG  150 mg/dl)","C3961 - Hiperuricemia","C84774 - Hipoalfalipoproteinemia (HDL H < 40 mg/dl / M < 50 mg/dl)","C26800 - Hipotireoidismo","C3014 - Incontinncia urinria","C50791 - Infeces do trato urinrio","C35650 - Infeces respiratrias alta","C35158 - Infeces respiratrias baixa","C28286 - Insnia","C3080 - Insuficincia cardaca congestiva","C127822 - Insuficincia venosa crnica","C3201 - Lpus eritematoso sistmico","C26975 - Laringite crnica","C3434 - Leiomioma uterino","C3161 - Leucemia","C3207 - Linfedema crnico","C34797 - Malria","C26828 - Meningite","C2983 - Nefrolitase","C4345 - Neoplasias mieloproliferativas","C3293 - Osteoartrite","C50910 - Osteopenia","C3298 - Osteoporose","C128386 - Otite mdia supurativa crnica","C3306 - Pancreatite","C84637 - Pancreatite crnica","C35326 - Periodontite crnica","C123216 - Pielonefrite crnica","C3336 - Policitemia vera","C26930 - Prostatite crnica","C3346 - Psorase","C114476 - Reao alrgica","C113101 - Resistncia  insulina (pr-diabetes)","C2952 - Retocolite ulcerativa","C79532 - Rinite alrgica","C27168 - Sndrome da apneia obstrutiva do sono","C26883 - Sndrome de Sjgren","C26900 - Sndrome de Turner","C61283 - Sndrome do Anticorpo Anti-Fosfolpide (SAAF)","C82343 - Sndrome do intestino irritvel","C114667 - Sndrome dos ovrios policsticos","C35151 - Sinusite crnica","C97141 - Tendinopatia","C34423 - Transtorno bipolar","C97160 - Transtorno do dficit de ateno e hiperatividade","C88412 - Transtorno do espectro autista","C88411 - Transtorno Obsessivo Compulsivo (TOC)","C3407 - Trombocitemia essencial","C3423 - Tuberculose","C3108 - VIH/SIDA") # common_comorbidities 3480
levels(data$comorbidities_diagnosis_duration_unit.factor)=c("Ano(s)","Dia(s)","Ms(es)","Semana(s)") # comorbidities_diagnosis_duration_unit 100
levels(data$conditions_complete.factor)=c("Incomplete","Unverified","Complete") # conditions_complete 79
levels(data$medication_current_yn.factor)=c("No","Sim") # medication_current_yn 56
levels(data$medication_additional.factor)=c("No","Sim") # medication_additional 56
levels(data$medication_dosage.factor)=c("dose nica","Se necessrio","Ao acordar","Todas as manhs","Todos as tardes","Todas as noites","Antes de dormir","1 vez por dia","2 vezes por dia","3 vezes por dia","4 vezes por dia","5 vezes por dia","6 vezes por dia","7 vezes por dia","8 vezes por dia","9 vezes por dia","A cada 2 dias","A cada 3 dias","A cada 4 dias","A cada 5 dias","A cada 6 dias","1 vez por semana","2 a 3 vezes por semana","3 vezes por semana","4 vezes por semana","5 vezes por semana","6 vezes por semana","A cada 2 semanas","A cada 3 semanas","A cada 5 semanas","A cada 6 semanas","A cada 7 semanas","A cada 10 semanas","A cada 13 semanas","1 vez por ms","10 dias por ms","3 vezes por ms","4 vezes por ms","5 vezes por ms","6 vezes por ms","A cada 2 meses","A cada 3 meses","A cada 4 meses","A cada 6 meses","5 vezes por ano","A cada 10 anos","A cada 3 anos","A cada 4 anos","A cada 5 anos") # medication_dosage 914
levels(data$drug_duration_use_unit.factor)=c("Ano(s)","Dia(s)","Ms(es)","Semana(s)") # drug_duration_use_unit 85
levels(data$drugs_complete.factor)=c("Incomplete","Unverified","Complete") # drugs_complete 74
levels(data$previous_medication_yn.factor)=c("No","Sim") # previous_medication_yn 57
levels(data$previous_medication_additional.factor)=c("No","Sim") # previous_medication_additional 65
levels(data$previous_drug_start_duration_unit.factor)=c("Ano(s)","Dia(s)","Ms(es)","Semana(s)") # previous_drug_start_duration_unit 96
levels(data$previous_drug_stop_duration_unit.factor)=c("Ano(s)","Dia(s)","Ms(es)","Semana(s)") # previous_drug_stop_duration_unit 95
levels(data$old.drugs_complete.factor)=c("Incomplete","Unverified","Complete") # old.drugs_complete 78
levels(data$medical_history_yn.factor)=c("No","Sim") # medical_history_yn 53
levels(data$medical_history_additional.factor)=c("No","Sim") # medical_history_additional 61
levels(data$common_medical_history.factor)=c("C51679 - Amigdalectomia","C51687 - Apendicectomia","C51691 - Artroplastia","C46088 - Cesariana","C157809 - Cirurgia de Catarata","C51676 - Colecistectomia","C15209 - Colectomia","C51758 - Derivao Gastrojejunal","C3046 - Fratura","C15236 - Gastrectomia","C51583 - Gastrectomia Subtotal","C92946 - Gravidez tubria","C86589 - Hbito de vida sedentrio","C34690 - Hrnia Inguinal","C86074 - Hemicolectomia","C168249 - Herniorrafia","C15256 - Histerectomia","C92901 - Laqueadura tubria","C34753 - Leso no joelho","C15277 - Mastectomia","C51645 - Miomectomia uterina","C15284 - Nefrectomia","C114667_2 - Nefrolitase","C83000 - Objeto metlico","C15294 - Pancreatectomia","C80430 - Procedimento Cardaco","C15307 - Prostatectomia","C157778 - Reparo de Aneurisma Abdominal Aberto","C157839 - Reparo de Aneurisma Endovascular","C164212 - Resseco de Tumor","C51998 - Revascularizao do Miocrdio","C51605 - Salpingectomia","C91838 - Sigmoidectomia","C51762 - Tiroidectomia total","C15342 - Transplante") # common_medical_history 1048
levels(data$medical_history_duration_unit.factor)=c("Ano(s)","Dia(s)","Ms(es)","Semana(s)") # medical_history_duration_unit 92
levels(data$old.conditions_complete.factor)=c("Incomplete","Unverified","Complete") # old.conditions_complete 83
levels(data$symptoms_yn.factor)=c("No","Sim") # symptoms_yn 46
levels(data$symptoms_additional.factor)=c("No","Sim") # symptoms_additional 54
levels(data$symptom_onset_unit.factor)=c("Year","Day","Month","Week") # symptom_onset_unit 69
levels(data$symptom_current_or_resolved.factor)=c("Resolved","Current") # symptom_current_or_resolved 71
levels(data$symptom_resolution_duration_unit.factor)=c("Year","Day","Month","Week") # symptom_resolution_duration_unit 83
levels(data$symptom_intervention_causality.factor)=c("Not related","Unlikely related","Possibly related","Related") # symptom_intervention_causality 115
levels(data$symptoms_complete.factor)=c("Incomplete","Unverified","Complete") # symptoms_complete 77
levels(data$physical_exam_findings_yn.factor)=c("No","Sim") # physical_exam_findings_yn 60
levels(data$physical_exam_findings_additional.factor)=c("No","Sim") # physical_exam_findings_additional 68
levels(data$system.factor)=c("General Appearance (NCIT: c87079)","Oral Examination (NCIT: c163004)","Skin Examination (NCIT: c168436)","Cardiovascular Examination (NCIT: c122008)","Respiratory System Examination (NCIT: c198356)","Abdominal Examination (NCIT: c167415)","Examination of Extremities (NCIT: c168189)") # system 314
levels(data$general_appearance.factor)=c("Dehydration","Pallor") # general_appearance 64
levels(data$oral_cavity_exam.factor)=c("Cheilitis","Glossitis") # oral_cavity_exam 63
levels(data$skin_exam.factor)=c("Acanthosis Nigricans","Dermatitis","Erythema") # skin_exam 79
levels(data$cardiovascular_exam.factor)=c("Decreased exercise tolerance","Dyspnea (on exertion, at rest, orthopnea, or paroxysmal nocturnal dyspnea)","Fatigue (unusual tiredness and inability to perform usual activities)","Volume overload","Systolic Heart Murmur","Diastolic Heart Murmur") # cardiovascular_exam 289
levels(data$respiratory_exam.factor)=c("Lungs Clear on Auscultation","Rales","Decreased Breath Sounds","Rhonchi","Wheezing","Basilar Rales / crackel","Pleural Friction Rub","Absent Breath Sounds","Other") # respiratory_exam 204
levels(data$abdominal_exam.factor)=c("Abdominal Auscultation Finding","Abdominal Pain","Abdominal Palpation Finding","Abdominal Visual Inspection","Hepatomegaly","Abdominal Hernia") # abdominal_exam 181
levels(data$extremities_exam.factor)=c("Edema","Delayed Capillary Refill Time") # extremities_exam 79
levels(data$phy.exam_complete.factor)=c("Incomplete","Unverified","Complete") # phy.exam_complete 77
levels(data$show_lab_list_yn.factor)=c("No","Sim") # show_lab_list_yn 51
levels(data$lab_location.factor)=c("ESF I - VILA REIS (Gilberto Rinaldi)","ESF II - BOM JESUS (Nelson Pereira Lima)","ESF III - ILHA GRANDE (Joo Pegoraro)","ESF IV - JURUC (Sarandy)","ESF V - VILA PAULISTA (Joao Augusto dos Reis)","ESF VI - MORUMBI (Antonio Jacomini)","ESF VII - CESAR CAPATO (Doutor Francisco Xavier Toda Filho)","UBS - SANTA JULIA (Ruth Rodrigues de Pereira)","UBS - VILA REIS (Dr Pedro Saud)","UBS - MORUMBI","CENTRO DE SADE") # lab_location 449
levels(data$beta_hcg.factor)=c("Negativo","Positivo") # beta_hcg 53
levels(data$other_lab_tests_yn.factor)=c("No","Sim") # other_lab_tests_yn 53
levels(data$labs_checked_results.factor)=c("No","Sim") # labs_checked_results 55
levels(data$labs_complete.factor)=c("Incomplete","Unverified","Complete") # labs_complete 73
levels(data$ecg_performed.factor)=c("Sim","No") # ecg_performed 48
levels(data$amplitude_standard.factor)=c("No","Sim") # amplitude_standard 53
levels(data$rhythm.factor)=c("Sinus Rhythm","Atrial fibrilation","Atrial flutter","Ventricular arrhythmia","Supraventricular tachycardia","Paced rhythm","Other") # rhythm 161
levels(data$normal_ecg.factor)=c("Unchecked","Checked") # normal_ecg 55
levels(data$ecg_findings_lbbb.factor)=c("Unchecked","Checked") # ecg_findings_lbbb 62
levels(data$ecg_findings_rbbb.factor)=c("Unchecked","Checked") # ecg_findings_rbbb 62
levels(data$ecg_findings_av_block.factor)=c("Unchecked","Checked") # ecg_findings_av_block 66
levels(data$ecg_findings_st_changes.factor)=c("Unchecked","Checked") # ecg_findings_st_changes 68
levels(data$ecg_findings_abnormal_q_waves.factor)=c("Unchecked","Checked") # ecg_findings_abnormal_q_waves 74
levels(data$ecg_findings_nonspecific_intraventricular_conduction_delay.factor)=c("Unchecked","Checked") # ecg_findings_nonspecific_intraventricular_conduction_delay 103
levels(data$ecg_findings_no_info.factor)=c("Unchecked","Checked") # ecg_findings_no_info 65
levels(data$ecg_findings_unknown.factor)=c("Unchecked","Checked") # ecg_findings_unknown 65
levels(data$ecg_findings_not_asked.factor)=c("Unchecked","Checked") # ecg_findings_not_asked 67
levels(data$ecg_findings_asked_but_unknown.factor)=c("Unchecked","Checked") # ecg_findings_asked_but_unknown 75
levels(data$ecg_findings_invalid.factor)=c("Unchecked","Checked") # ecg_findings_invalid 65
levels(data$ecg_findings_na.factor)=c("Unchecked","Checked") # ecg_findings_na 60
levels(data$ecg_audit_data.factor)=c("No","Sim") # ecg_audit_data 49
levels(data$ecg_technical_quality.factor)=c("Excellent Quality: ECG traces in this category exhibit optimal technical quality with clear and well-defined waveforms. These are free from artifacts and noise, making them easy to interpret.","Good Quality: ECG traces in this category are generally clear and mostly free from artifacts. While there may be minor noise or interference, it does not significantly affect the interpretation.","Fair Quality: ECG traces in this category may have some noticeable artifacts or noise, but the primary waveform components (P-waves, QRS complexes, and T-waves) are still distinguishable, allowing for reasonable interpretation.","Marginal Quality: ECG traces in this category have significant artifacts or interference that can obscure important waveforms. Interpretation may be challenging, and further testing or adjustments may be necessary to obtain a clearer signal.","Poor Quality: ECG traces in this category are severely degraded by artifacts, noise, or technical issues. The primary waveforms are nearly or entirely obscured, making interpretation difficult or impossible.") # ecg_technical_quality 1119
levels(data$ecg_measurement_checked.factor)=c("No","Yes") # ecg_measurement_checked 57
levels(data$show_ecg_metadata_yn.factor)=c("No","Sim") # show_ecg_metadata_yn 55
levels(data$ecg.factor)=c("Incomplete","Unverified","Complete") # ecg 63
levels(data$taking_as_directed.factor)=c("No","Sim") # taking_as_directed 53
levels(data$dosage_schedule.factor)=c("6 cpsulas ao dia (2 cpsulas com caf da manh, 2 com almoo e 2 com o jantar)","6 cpsulas ao dia, em outros horrios","3 cpsulas ao dia (1 cpsula com caf da manh, 1 com almoo e 1 com o jantar)","3 cpsulas ao dia, em outros horrios","Outros (especifique)") # dosage_schedule 304
levels(data$reminder_method.factor)=c("Alarme no celular","Caixa de remdios com divisrias para cada horrio","Lembrete escrito em um calendrio","Outro (especificar)") # reminder_method 169
levels(data$missed_study_medication.factor)=c("No","Sim") # missed_study_medication 58
levels(data$missed_dose_count.factor)=c("1 vez","2 vezes","3 a 5 vezes","5 a 10 vezes","mais de 10 vezes") # missed_dose_count 106
levels(data$missed_dose_timing.factor)=c("Com o caf da manh","Com o almoo","Com o jantar","Outro (especificar)") # missed_dose_timing 115
levels(data$medication_discontinuation.factor)=c("No","Sim") # medication_discontinuation 61
levels(data$discontinuation_duration.factor)=c("1 dia","2 dias","3 a 5 dias","5 a 10 dias","mais de 10 dias") # discontinuation_duration 109
levels(data$discontinuation_reason.factor)=c("Efeito colateral","Esquecimento","Dificuldade em seguir horrios","Outro (especificar)") # discontinuation_reason 134
levels(data$ran_out_of_medication.factor)=c("No","Sim") # ran_out_of_medication 56
levels(data$daily_routine_change_medication_adherence_yn.factor)=c("No","Sim") # daily_routine_change_medication_adherence_yn 79
levels(data$perceived_improvement.factor)=c("No","Sim") # perceived_improvement 56
levels(data$challenges_taking_medication.factor)=c("No","Sim") # challenges_taking_medication 63
levels(data$overall_compliance_rate.factor)=c("Ruim","Regular","Boa","Excelente") # overall_compliance_rate 81
levels(data$compliance_complete.factor)=c("Incomplete","Unverified","Complete") # compliance_complete 79
levels(data$adverse_event_this_cycle_yn.factor)=c("No","Sim") # adverse_event_this_cycle_yn 62
levels(data$serious_adverse_event_yn.factor)=c("No","Sim") # serious_adverse_event_yn 59
levels(data$adverse_event_classification.factor)=c("Alergia/Imunologia","Auditivo/Ouvido","Sangue/Medula ssea","Arritmia Cardaca","Cardaco Geral","Coagulao","Sintomas Constitucionais","bito/Morte","Dermatologia/Pele","Endcrino","Gastrointestinal","Crescimento e Desenvolvimento","Hemorragia/Sangramento","Hepatobiliar/Pncreas","Infeco","Linfticos","Metablico/Laboratorial","Musculoesqueltico/Tecido Conjuntivo","Neurologia","Ocular/Visual","Dor","Pulmonar/Trato Respiratrio Superior","Renal/Geniturinrio","Neoplasia Secundria","Funo Sexual/Reprodutiva","Sndromes","Vascular","Psiquitrico","Outros") # adverse_event_classification 618
levels(data$adverse_event_grade.factor)=c("1 Mild AE","2 Moderate AE","3 Severe AE","4 Life-threatening or disabling AE","5 Death related to AE") # adverse_event_grade 145
levels(data$adverse_event_attribution.factor)=c("No Relacionado","Improvvel","Possvel","Provvel","Definitivo") # adverse_event_attribution 114
levels(data$adverse_event_action_taken.factor)=c("Nenhuma","Dose Reduzida","Terapia Interrompida","Excludo do estudo") # adverse_event_action_taken 119
levels(data$adverse_event_followup.factor)=c("1. Resolvido","2. Resolvido com sequela","3. No resolvido","4. Disfuno") # adverse_event_followup 121
levels(data$additional_adverse_events_yn.factor)=c("No","Sim") # additional_adverse_events_yn 63
levels(data$adverse_complete.factor)=c("Incomplete","Unverified","Complete") # adverse_complete 76
levels(data$diuretic_use.factor)=c("No","Sim") # diuretic_use 47
levels(data$diuretic_dose_change.factor)=c("No","Sim") # diuretic_dose_change 55
levels(data$menses.factor)=c("N","S") # menses 37
levels(data$regular_cycle.factor)=c("N","S") # regular_cycle 44
levels(data$drugs_dose_change.factor)=c("No","Sim") # drugs_dose_change 52
levels(data$show_lab_yn.factor)=c("No","Sim") # show_lab_yn 46
levels(data$lab_tests_yn.factor)=c("No","Sim") # lab_tests_yn 47
levels(data$lab_tests_checked_yn.factor)=c("No","Sim") # lab_tests_checked_yn 55
levels(data$abnormal_labs.factor)=c("No","Sim") # abnormal_labs 48
levels(data$intervention_prevention_reason_yn.factor)=c("No","Sim") # intervention_prevention_reason_yn 68
levels(data$intervention_delivered_yn.factor)=c("No","Sim") # intervention_delivered_yn 60
levels(data$explained_dosage.factor)=c("No","Sim") # explained_dosage 51
levels(data$intervention_comprehension_yn.factor)=c("No","Sim") # intervention_comprehension_yn 64
levels(data$start_after_lab.factor)=c("No","Sim") # start_after_lab 50
levels(data$additional_notes_actions_yn.factor)=c("No","Sim") # additional_notes_actions_yn 62
levels(data$medical_complete.factor)=c("Incomplete","Unverified","Complete") # medical_complete 76
levels(data$first_contact_successful_yn.factor)=c("No","Sim") # first_contact_successful_yn 62
levels(data$second_contact_successful_yn.factor)=c("No","Sim") # second_contact_successful_yn 63
levels(data$third_contact_successful_yn.factor)=c("No","Sim") # third_contact_successful_yn 62
levels(data$fourth_contact_successful_yn.factor)=c("No","Sim") # fourth_contact_successful_yn 63
levels(data$fifth_contact_successful_yn.factor)=c("No","Sim") # fifth_contact_successful_yn 62
levels(data$sixth_contact_successful_yn.factor)=c("No","Sim") # sixth_contact_successful_yn 62
levels(data$seventh_contact_successful_yn.factor)=c("No","Sim") # seventh_contact_successful_yn 64
levels(data$eighth_contact_successful_yn.factor)=c("No","Sim") # eighth_contact_successful_yn 63
levels(data$ninth_contact_successful_yn.factor)=c("No","Sim") # ninth_contact_successful_yn 62
levels(data$tenth_contact_successful_yn.factor)=c("No","Sim") # tenth_contact_successful_yn 62
levels(data$symptoms_since_treatment.factor)=c("No","Sim") # symptoms_since_treatment 59
levels(data$symptoms_resolved.factor)=c("No tenho mais os sintomas","Ainda tenho os sintomas") # symptoms_resolved 95
levels(data$capsules_compliance.factor)=c("No","Sim") # capsules_compliance 54
levels(data$missed_dose_last_week.factor)=c("No","Sim, esqueci 1 dose","Sim, esqueci entre 2 a 4 doses","Sim, esqueci 5 ou mais doses") # missed_dose_last_week 136
levels(data$questions_yn.factor)=c("No","Sim") # questions_yn 47
levels(data$questions_resolved_yn.factor)=c("No","Sim") # questions_resolved_yn 56
levels(data$followup_complete.factor)=c("Incomplete","Unverified","Complete") # followup_complete 77
levels(data$completed_intervention.factor)=c("No","Sim","Ainda no") # completed_intervention 69
levels(data$non_completion_reason.factor)=c("Evento adverso","bito","Falha em atender aos critrios de continuao","Falta de eficcia","Problema logstico com o estudo clnico","Perda de seguimento","Participante atendeu aos critrios de elegibilidade, mas no era mais necessrio","No est se beneficiando clinicamente","Baixa adeso ao medicamento em estudo","Baixa adeso ao cronograma do estudo","Gravidez do parceiro","Deciso mdica","Participante grvida","Progresso de doena","Desvio do protocolo","Violao do protocolo","Participante atendeu a critrio de excluso","Participante necesside deee medicao excludente","Falha na triagem do estudo","Triagem no concluda","Participante removido a pedido do patrocinador","Estudo encerrado pelo patrocinador","Problema tcnico","Retirada pelo participante","Consentimento do estudo retirado","Outro") # non_completion_reason 862
levels(data$conclusion_info_view_yn.factor)=c("No","Sim") # conclusion_info_view_yn 58
levels(data$ethical_additional_measures_yn.factor)=c("No","Sim,  necessrio informar ao CEP","Sim,  necessrio informar o Comit de Monitoramento Externo") # ethical_additional_measures_yn 158
levels(data$conclusion_complete.factor)=c("Incomplete","Unverified","Complete") # conclusion_complete 79
levels(data$attachment_type.factor)=c("Consentimento informado","Documentos de identificao","Registros mdicos e de sade","Questionrios e formulrios preenchidos","Dirios de sintomas ou registros pessoais feitos pelos participantes","Resultados de exames laboratoriais","Fotografias e imagens mdicas","Recibos ou comprovantes de reembolsos","Eventos adversos e relatrios de reaes: Registros de eventos adversos, reaes ou efeitos colaterais relatados pelos participantes durante o estudo.","Comunicaes com os pesquisadores (e-mails, mensagens ou outros registros de comunicao)","Autorizaes adicionais","Questionrios de follow-up (aps a concluso do estudo)","Outros") # attachment_type 685
levels(data$attachment_complete_yn.factor)=c("Incomplete","Unverified","Complete") # attachment_complete_yn 82
```

## (?)Saving the output of describe(data) 
```{r, eval = FALSE}
## Saving the output of describe(data) to a text file
writeLines(capture.output(describe(data)), "/Users/gustavosplmoura/Library/Mobile Documents/com~apple~CloudDocs/Medicina/Biblioteca/Research/Data Science/Data Science/PROJECTS/DVEP/3_Output/2_New_Variables.txt")
```

## (?) Saving variable names to a text file
1. Without numbered index
```{r, eval = FALSE}
writeLines(
    names(data), 
    "/Users/gustavosplmoura/Library/Mobile Documents/com~apple~CloudDocs/Medicina/Biblioteca/Research/Data Science/Data Science/PROJECTS/DVEP/3_Output/3_Variables.txt")
```
2. With numbered index
```{r, eval=FALSE}
writeLines(
    paste(seq_along(names(data)), names(data), sep = ". "), 
    "/Users/gustavosplmoura/Library/Mobile Documents/com~apple~CloudDocs/Medicina/Biblioteca/Research/Data Science/Data Science/PROJECTS/DVEP/3_Output/3_Variables.txt")

# seq_along(names(data) generates a sequence of numbers from 1 to the number of columns in the data frame
# paste() combines the index numbers with the variable names
# The sep = ". " argument specifies that a period and space should be used to separate the index from the variable name
```


# DATA WRANGLING

## (?) Create separate dfs for each event containing all variables from each event
```{r}
#Elegibility
eleg_variables <- data_codebook |> 
  filter(eleg_arm_1 == 1)  |>
  pull(variable_recoded)

eleg  <- data  |>
    filter(event_name == "eleg_arm_1") |> 
    select(all_of(eleg_variables))

rm(eleg_variables)


# First visit
V1_variables <- data_codebook |> 
  filter(X1visit_arm_1 == 1)  |> 
  pull(variable_recoded)

V1 <- data  |>
    filter(event_name == "1visit_arm_1") |> 
    select(all_of(V1_variables))

rm(V1_variables)


# Second Visit
V2_variables <- data_codebook |> 
  filter(X2visit_arm_1 == 1)  |> 
  pull(variable_recoded)

V2 <- data  |>
    filter(event_name == "2visit_arm_1") |> 
    select(all_of(V2_variables))

rm(V2_variables)


# Third visit
V3_variables <- data_codebook |> 
  filter(X3visit_arm_1 == 1)  |> 
  pull(variable_recoded)

V3 <- data  |>
    filter(event_name == "3visit_arm_1") |> 
    select(all_of(V3_variables))

rm(V3_variables)

```

## Create separate dfs for each event containing only selected variables from each event
```{r}
#Elegibility
eleg_variables <- data_codebook |> 
  filter(eleg_arm_1 == 1 & included == 1)  |>
  pull(variable_recoded)

V0  <- data  |>
    filter(event_name == "eleg_arm_1") |> 
    select(all_of(eleg_variables))

rm(eleg_variables)


# First visit
V1_variables <- data_codebook |> 
  filter(X1visit_arm_1 == 1 & included == 1)  |> 
  pull(variable_recoded)

V1 <- data  |>
    filter(event_name == "1visit_arm_1") |> 
    select(all_of(V1_variables))

rm(V1_variables)


# Second Visit
V2_variables <- data_codebook |> 
  filter(X2visit_arm_1 == 1 & included == 1)  |> 
  pull(variable_recoded)

V2 <- data  |>
    filter(event_name == "2visit_arm_1") |> 
    select(all_of(V2_variables))

rm(V2_variables)


# Third visit
V3_variables <- data_codebook |> 
  filter(X3visit_arm_1 == 1 & included == 1)  |> 
  pull(variable_recoded)

V3 <- data  |>
    filter(event_name == "3visit_arm_1") |> 
    select(all_of(V3_variables))

rm(V3_variables)

```


## Select variables relevant for the analysis
In the column `included` (data_codebook), relevant variables that were chosen to be included in the analysis DF are coded as 1.
The following code will extract the relevant variables from the `data_codebook`, store it in a vector, and use this vector to create a new DF.

```{r}
library(dplyr)

selected_variables <- data_codebook |> 
  filter(included == 1)  |> # Filters the data_codebook to include only the selected variables
  pull(variable_recoded)  # Extract the variable names into a vector

data_filtered <- data  |> # The new DF containing the selected variables is names data_filtered
  select(all_of(selected_variables))  # all_of ensures compatibility with character vectors

rm(selected_variables)
write.csv(data_filtered, file = "data_filtered.csv", row.names = FALSE)

```


##  First visit 
```{r}
eleg_variables <- data_codebook |> 
  filter(included == 1 & eleg_arm_1 == 1)  |> 
  pull(variable_recoded)

X1_variables <- data_codebook |> 
  filter(included == 1 & X1_visit_arm_1 == 1)  |> 
  pull(variable_recoded)

X1V <- data  |>
  select(all_of(eleg_variables))  |> 
  filter(event_name == "eleg_arm_1" & repeat_instrument == "")
  

```


## First visit (no repeating)
```{r}

V0NR  <- V0  |> 
    filter(repeat_instrument == "")

V1NR  <-  V1  |> 
    filter(repeat_instrument == "")

V0V1  <- V0NR  |> 
    left_join(V1NR, join_by(record_id))  |> 
    mutate(event_name.x == 1)

```

# REDCapTidieR
REDCapR and REDCapTidieR packages
CRAN: https://cran.r-project.org/web/packages/REDCapTidieR/index.html
Docs: https://cran.r-project.org/web/packages/REDCapTidieR/REDCapTidieR.pdf


```{r}
install.packages("REDCapTidieR")
```

read_redcap(
    redcap_uri,
    token,
    raw_or_label = "label",
    forms = NULL,
    export_survey_fields = NULL,
    export_data_access_groups = NULL,
    suppress_redcapr_messages = TRUE,
    guess_max = Inf,
    allow_mixed_structure = getOption("redcaptidier.allow.mixed.structure", FALSE)
)

```{r}

# Clear all objects from R environment
rm(list = ls())

# Clear plots
graphics.off()

# Clear any pending RStudio sessions or temporary files
cat("\014")  # This simulates pressing Ctrl + L in RStudio



library("REDCapTidieR")
rm(list=ls())
graphics.off()

data <- read_redcap(
    redcap_uri = "https://redcap.fmrp.usp.br/api/",
    token = "674AF11C79CB50158263381971E68211",
    raw_or_label = "raw",
    forms = NULL,
    export_survey_fields = NULL,
    export_data_access_groups = NULL,
    suppress_redcapr_messages = TRUE,
    guess_max = Inf,
    allow_mixed_structure = TRUE
)

```

# TIDYVERSE

## (?) Create list of REDCap instruments and associated variables
```{r}
instruments <- list(
    I01_elegibility = c("record_id", "event_name", "date_birth", "age", "ubs", "contact_options", "contact_hours", "contact_days", "transport_research_center", "research_source_info", "availability_comments_yn", "availability_comments", "sex", "pregnant_nursing_yn", "eleg_height", "eleg_weight", "bmi_reported", "eleg_comorbidity_yn", "comorbidity_list", "drug_use_yn", "drug_list", "high_risk_pregnancy_ineffective_contraceptives", "high_risk_pregnancy_inconsistent_contraceptives", "high_risk_pregnancy_unprotected_sex", "high_risk_pregnancy_infertility_treatment", "high_risk_pregnancy_postpartum", "high_risk_pregnancy_none", "high_risk_fem_noinfo", "high_risk_fem_unknown", "high_risk_fem_notasked", "high_risk_fem_askunknown", "high_risk_fem_invalid", "high_risk_fem_na", "pregnancy_test_and_contraceptive_agreement", "low_risk_pregnancy_effective_contraceptives", "menopause", "low_risk_pregnancy_surgical_sterilization", "low_risk_pregnancy_no_sex_6_months", "low_risk_pregnancy_no_sex", "low_risk_pregnancy_infertility_diagnosis", "low_risk_pregnancy_exclusive_homo_sexual_behavior", "low_risk_fem_noinfo", "low_risk_fem_unknown", "low_risk_fem_notasked", "low_risk_fem_askunknown", "low_risk_fem_invalid", "low_risk_fem_na", "contraceptive_continuation_agreement", "lab_notes", "consultation_schedule_date", "eleg_lab_request_date", "lab_schedule_date", "eleg_lab_location", "lab_collected_yn", "lab_checked_yn", "lab_finding_yn", "lab_exclusion_yn", "bhcg", "contraception", "preserved_hormone", "contraception_ready_yn", "contraception_ineligibility", "consent_sent_yn", "consent_read_yn", "consent_questions_yn", "consent_questions_2_yn", "consent_questions_cleared_yn", "participant_desire_yn", "first_visit_date", "sms_consent_yn", "block_alerts_1st_yn", "interview_datetime", "eleg_interviewer", "eleg_complete"),
    I02_tcle = c("record_id","event_name", "consent_signed_yn", "consent_date", "consent_upload", "tcle_complete"),
    I03_demographic = c("record_id","event_name", "race", "race_other", "marital_status", "education_years", "employment_status", "household_size", "income_level", "demographic_metadata", "demographic_complete"),
    I04_whoqol = c("record_id","event_name", "whoqol_timestamp", "whoqol_1_quality", "whoqol_2_health", "whoqol_3_pain", "whoqol_4_treatment", "whoqol_5_enjoyment", "whoqol_6_meaning", "whoqol_7_concentration", "whoqol_8_security", "whoqol_9_environment", "whoqol_10_energy", "whoqol_11_appearance", "whoqol_12_finances", "whoqol_13_information", "whoqol_14_leisure", "whoqol_15_mobility", "whoqol_16_sleep", "whoqol_17_activities", "whoqol_18_work", "whoqol_19_selfesteem", "whoqol_20_relationships", "whoqol_21_sexual", "whoqol_22_support", "whoqol_23_housing", "whoqol_24_health_services", "whoqol_25_transport", "whoqol_26_negativity", "whoqol_needed_help", "whoqol_comment", "whoqol_score_overall", "whoqol_score_health", "whoqol_score_physical", "whoqol_score_psychological", "whoqol_score_social", "whoqol_score_environment", "pdf_upload_wb", "whoqol_complete"),
    I05_dass = c("record_id","event_name", "dass_timestamp", "dass_1_not_calm", "dass_2_drymouth", "dass_3_not_positive", "dass_4_hard_breath", "dass_5_no_initiative", "dass_6_exaggeration", "dass_7_tremor", "dass_8_nervous", "dass_9_worry", "dass_10_no_desire", "dass_11_agitation", "dass_12_not_relaxed", "dass_13_depression", "dass_14_intolerance", "dass_15_panic", "dass_16_no_enthusiasm", "dass_17_no_selfworth", "dass_18_too_emotional", "dass_19_palpitation", "dass_20_fear", "dass_21_no_meaning", "dass_score_depression", "dass_score_anxiety", "dass_score_stress", "dass21_upload", "dass_complete"),
    I06_ecap = c("record_id","event_name", "ecap_timestamp", "ecap1", "ecap2", "ecap3", "ecap4", "ecap5", "ecap6", "ecap7", "ecap8", "ecap9", "ecap10", "ecap11", "ecap12", "ecap13", "ecap14", "ecap15", "ecap16", "ecap_response_date", "ecap_1_body_image", "ecap_2_eating_speed", "ecap_3_impulse", "ecap_4_emotional_eating", "ecap_5_hunger", "ecap_6_guilt", "ecap_7_diet_failure", "ecap_8_binge_quantity", "ecap_9_compensate", "ecap_10_control", "ecap_11_fullness", "ecap_12_social_eating", "ecap_13_meal_frequency", "ecap_14_worry", "ecap_15_food_thoughts", "ecap_16_hunger_awareness", "ecap_score", "ecap_pdf_upload", "ecap_complete"),
    I07_bodycount = c("record_id","event_name", "height", "height_checked_cm", "weight", "weight_checked_kg", "abdomen", "abdominal_circ_checked_cm", "arm", "arm_circ_checked_cm", "anthro_check_error", "anthro_check", "bmi", "weight_maxideal", "weight_adjusted", "kcal_kg20", "kcal_kg22", "diet_energy", "weight_loss_kg", "weight_loss_percent", "abdomen_loss_kg", "abdomen_loss_percent", "bmi_loss_absolute", "bmi_loss_percent", "bodycount_complete"),
    I08_bp_limb = c("record_id","event_name", "bpbia_form_open_date", "bpbia_examiner", "bpbia_r_sw", "cuff_size", "reference_systolic_right", "reference_diastolic_right", "reference_mean_right", "reference_systolic_left", "reference_diastolic_left", "reference_mean_left", "reference_member", "bp_limb_complete"),
    I09_bp = c("record_id","event_name", "bp_form_open_date", "bp_examiner", "bp_start_sw", "heart_rate", "oxigen_saturation", "systolic_1", "diastolic_1", "bp_mean_1", "bp_first_measurement_sw", "systolic_2", "bp_r21s_checked", "diastolic_2", "bp_r22d_checked", "bp_mean_2", "bp_second_measurement_sw", "systolic_3", "bp_r31s_checked", "diastolic_3", "bp_r32d_checked", "bp_mean_3", "bp_sys_diff", "bp_third_measurement_sw", "systolic_4", "bp_r41s_checked", "diastolic_4", "bp_r42d_checked", "bp_mean_4", "systolic_mean", "systolic_stdev", "diastolic_mean", "diastolic_stdev", "mean_bp_mean", "mean_bp_stdev", "bp_show_metadata", "bp_complete"),
    I10_bia = c("record_id","event_name", "bia_raw_files", "bia_form_open_date", "bia_examiner", "smoked_24h", "exercised_24h", "alcohol_24h", "room_temperature", "axillary_temperature", "light_clothes", "removed_objects", "hairy_limbs", "removed_hair", "cleaned_skin", "last_meal_time", "last_liquid_time", "bed_rest_10min", "bia_timestamp", "time_fasted_food", "time_fasted_liquid", "resistance", "resistance_checked", "reactance", "reactance_checked", "phase_angle", "phase_angle_checked", "bia_show_metadata", "bia_complete"),
    I11_handgrip = c("record_id","event_name", "grip_limitations_yn", "grip_rh_limitations", "grip_lh_no_limitations", "grip_lh_paralysis", "grip_lh_cast", "grip_lh_bandaged", "grip_lh_missing_thumb", "grip_lh_other_limitations", "grip_lh_no_info", "grip_lh_unknown", "grip_lh_notasked", "grip_lh_askunknown", "grip_lh_invalid", "grip_lh_na", "grip_recent_surgery_yn", "grip_exclude_test_yn", "grip_surgery_history_yn", "grip_dominance", "grip_pain_last7days_yn", "grip_rhpain", "grip_lhpain", "grip_test_procedure_understanding_yn", "handgrip_right_1", "grip_rh_validation1", "grip_rh_stopwatch1", "handgrip_left_1", "grip_lh_validation1", "grip_lh_stopwatch1", "handgrip_right_2", "grip_rh_validation2", "grip_rh_stopwatch2", "handgrip_left_2", "grip_lh_validation2", "grip_lh_stopwatch2", "handgrip_right_3", "grip_rh_validation3", "handgrip_left_3", "grip_lh_validation3", "handgrip_right_mean", "handgrip_right_stdev", "handgrip_left_mean", "handgrip_left_stdev", "grip_see_metadata", "handgrip_complete"),
    I12_nutrition = c("record_id","event_name", "frequency_bowel", "frequency_solid_stool", "frequency_diarrhea", "contipation_yn", "frequency_laxative", "urinary_frequency", "water_consumption", "hair_loss", "nutrition_complete"),
    I13_food_allergy = c("record_id","event_name", "food_alergy", "peanut_allergy", "nut_allergy", "seafood_allergy", "egg_allergy", "lactose_intolerance", "gluten_intolerance", "soy_allergy", "fish_allergy", "allergy_complete"),
    I14_evs = c("record_id","event_name", "evs_days", "evs_time", "evs_score", "exercise_type_1", "secondary_physical_activity_yn", "tertiary_physical_activity_yn", "evs_complete"),
    I15_alcohol = c("record_id","event_name", "alcohol_frequency", "alcohol_stopped_years_ago", "years_drinks_alcohol", "beer_yn", "wine_yn", "spirit_yn", "alcohol_type_other", "alcohol_type_no_info", "alcohol_type_unknown", "alcohol_type_not_asked", "alcohol_type_asked_unknown", "alcohol_type_invalid", "alcohol_type_na", "beer_per_week", "beer_dose", "wine_ml_per_week", "wine_dose", "distilled_ml_per_week", "spirit_dose", "alcohol_type_other_specify", "alcohol_other_doses_per_week", "alcohol_dose", "alcohol_significant", "alcohol_complete"),
    I16_tobacco = c("record_id","event_name", "smoke_history", "age_started_smoking", "smoked_years", "daily_cigarettes", "pack_years", "age_quit_smoking", "tobacco_complete"),
    I17_diet_recall = c("record_id","event_name", "time_1", "time_2", "time_3", "time_4", "time_5", "time_6", "food_1", "food_2", "food_3", "food_4", "food_5", "food_6", "observations_1", "observations_2", "observations_4", "observations_3", "observations_5", "observations_6", "pdf_upload_recordatorio", "diet_recall_complete", "meal_breakfast_yn", "meal_morning_snack_yn", "meal_lunch_yn", "meal_afternoon_snack_yn", "meal_dinner_yn", "meal_supper_yn", "meal_no_info", "meal_unknown", "meal_not_asked", "meal_asked_unknown", "meal_invalid", "meal_na"),
    I18_diet_values = c("record_id","event_name", "total_energy", "carbs_grams", "carbs_kcal", "protein_kcal", "fat_kcal", "protein_grams", "fat_grams", "carbs_morning_g", "protein_morning_g", "fat_morning_g", "fat_morning_snack_g", "carbs_morning_snack_g", "protein_morning_snack_g", "carbs_lunch_g", "fat_lunch_g", "protein_lunch_g", "carbs_afternoon_snack_g", "fat_afternoon_snack_g", "protein_afternoon_snack_g", "fat_dinner_g", "protein_dinner_g", "carbs_dinner_g", "carbs_night_snack_g", "fat_night_snack_g", "protein_night_snack_g", "carbs_cal_morning", "protein_cal_morning", "fat_cal_morning", "total_cal_morning", "carbs_cal_morning_snack", "fat_cal_morning_snack", "protein_cal_morning_snack", "total_cal_morning_snack", "total_cal_lunch", "carbs_cal_lunch", "fat_cal_lunch", "protein_cal_lunch", "carbs_cal_afternoon_snack", "fat_cal_afternoon_snack", "protein_cal_afternoon_snack", "total_cal_afternoon_snack", "carbs_cal_dinner", "protein_cal_dinner", "fat_cal_dinner", "total_cal_dinner", "carbs_cal_night_snack", "protein_cal_night_snack", "fat_cal_night_snack", "total_cal_night_snack", "nutr_pdf_upload", "diet_values_complete"),
    I19_dates = c("record_id","event_name", "intervention_capsule_start_yn", "visit1_schedule_date", "weekly_alert_remove_yn", "intervention_start_date", "date_45d_complete", "visit2_schedule_date", "date_90d_complete", "visit3_schedule_date", "important_dates_link_hidden", "dates_complete"),
    I20_allocation = c("record_id","event_name", "participant_id", "allocation_group", "allocation_complete"),
    I21_conditions_R = c("record_id","event_name", "repeat_instrument", "repeat_instance", "comorbidity_yn", "comorbidity_additional", "common_comorbidities", "comorbidities_diagnosis_duration", "comorbidities_diagnosis_duration_unit", "comorbidities_listed_concat", "comorbidities_metadata", "conditions_complete"),
    I22_drugs_R = c("record_id","event_name", "repeat_instrument", "repeat_instance", "medication_current_yn", "medication_additional", "common_medications", "medication_dosage", "drug_duration_use", "drug_duration_use_unit", "drug_units_per_dose", "drug_dosage_units", "medication_list_concat", "other_medication_use_yn", "medications_metadata", "drugs_complete"),
    I23_old_drugs_R = c("record_id","event_name", "repeat_instrument", "repeat_instance", "previous_medication_yn", "previous_medication_additional", "common_previous_medications", "previous_drug_start_info", "previous_drug_start_duration", "previous_drug_start_duration_unit", "previous_drug_stop_info", "previous_drug_stop_duration", "previous_drug_stop_duration_unit", "previous_medications_listed_concat", "other_medications", "old.drugs_complete"),
    I24_old_conditions_R = c("record_id","event_name", "repeat_instrument", "repeat_instance", "medical_history_yn", "medical_history_additional", "common_medical_history", "personal_medical_history", "personal_medical_history_notes", "medical_history_duration", "medical_history_duration_unit", "medical_history_listed_concat", "old.conditions_complete"),
    I25_symptoms_R = c("record_id","event_name", "repeat_instrument", "repeat_instance", "symptoms_yn", "symptoms_additional", "symptom_instance_number", "symptom_code", "symptom_specify", "symptom_note", "symptom_onset", "symptom_onset_code", "symptom_onset_unit", "symptom_severity", "symptom_severity_scale", "symptom_current", "symptom_current_or_resolved", "symptom_resolution_date", "symptom_resolution_duration_unit", "symptom_causality_assessment", "symptom_intervention_causality", "symptoms_concat", "symptoms_complete"),
    I26_phy_exam_R = c("record_id","event_name", "repeat_instrument", "repeat_instance", "physical_exam_findings_yn", "physical_exam_findings_additional", "system", "general_appearance", "oral_cavity_exam", "skin_exam", "cardiovascular_exam", "respiratory_exam", "abdominal_exam", "extremities_exam", "abnormal_finding_description", "abnormal_finding_nonindexed_description", "previous_instance_phyexam_concat", "current_instance_phyexam_concat2", "phy.exam_complete"),
    I27_labs_R = c("record_id","event_name", "repeat_instrument", "repeat_instance", "show_lab_list_yn", "lab_request_signed_pdf", "lab_protocol_request_pdf", "medical_consultation_schedule_date", "lab_request_date", "lab_scheduled_date", "lab_location", "labs_date", "c_reactive_protein", "ast", "alt", "gamma_gt", "alkaline_phosphatase", "total_bilirubin", "direct_bilirubin", "indirect_bilirubin", "amylase", "total_proteins", "albumin", "urea", "creatinine", "glomerular_filtration_rate", "cpk", "uric_acid", "sodium", "potassium", "calcium_ionic", "total_cholesterol", "ldl", "hba1c", "triglycerides", "hdl", "fasting_glucose", "insulin", "homa_ir", "quick_index", "beta_hcg", "hemoglobin", "hematocrit", "leukocytes", "platelets", "tsh", "t4_free", "lab_exam_pdf", "other_lab_tests_yn", "labs_notes", "labs_checked_results", "lab_metadata", "labs_complete"),
    I28_ecg = c("record_id","event_name", "ecg_timestamp", "ecg_performed", "reason_not_performed_ecg", "ecg_pdf_upload", "amplitude_standard", "heart_rate_bpm", "sample_time_s", "qrs_interval_ms", "pr_interval_ms", "qt_interval_ms", "qtc_interval_ms", "qrs_axis_degrees", "rhythm", "normal_ecg", "ecg_findings_lbbb", "ecg_findings_rbbb", "ecg_findings_av_block", "ecg_findings_st_changes", "ecg_findings_abnormal_q_waves", "ecg_findings_nonspecific_intraventricular_conduction_delay", "ecg_findings_no_info", "ecg_findings_unknown", "ecg_findings_not_asked", "ecg_findings_asked_but_unknown", "ecg_findings_invalid", "ecg_findings_na", "ecg_text_prompt", "ecg_audit_data", "ecg_technical_quality", "ecg_measurement_checked", "show_ecg_metadata_yn", "ecg"),
    I29_compliance_R = c("record_id","event_name", "repeat_instrument", "repeat_instance", "taking_as_directed", "dosage_schedule", "alternative_schedule", "reminder_method", "alternative_reminder", "missed_study_medication", "missed_dose_count", "missed_dose_timing", "missed_dose_timing_other", "medication_discontinuation", "discontinuation_duration", "discontinuation_reason", "discontinuation_reason_other", "ran_out_of_medication", "ran_out_reason", "daily_routine_change_medication_adherence_yn", "daily_routine_change_specify", "perceived_improvement", "improvements_reported", "challenges_taking_medication", "specify_challenges_medication_adherence", "medication_confidence_scale", "overall_compliance_rate", "compliance_complete"),
    I30_adverse_event_R = c("record_id","event_name", "repeat_instrument", "repeat_instance", "adverse_event_evaluation_date", "adverse_event_this_cycle_yn", "serious_adverse_event_yn", "adverse_event", "adverse_event_description", "adverse_event_classification", "adverse_event_grade", "adverse_event_start_date", "adverse_event_end_date", "adverse_event_attribution", "adverse_event_action_taken", "adverse_event_followup", "additional_adverse_events_yn", "adverse_event_concat", "adverse_complete"),
    I31_medical = c("record_id","event_name", "evaluation_date", "pipe_comorbidities", "diuretic_use", "diuretic_dose_change", "pipe_current_medications", "pipe_previous_medications", "pipe_medical_history", "menses", "regular_cycle", "cycle_duration", "last_menses", "ovulation_days_after_lmp", "next_ovulation_date", "next_menses_date", "cycle_phase", "drugs_dose_change", "drugs_dose_change_notes", "pipe_symptoms_1st_visit", "pipe_symptoms_2nd_visit", "pipe_symptoms_3rd_visit", "phy_exam_1st_concat", "phy_exam_2nd_concat", "phy_exam_3rd_concat", "show_lab_yn", "lab_tests_yn", "lab_tests_not_performed_reason", "lab_tests_checked_yn", "abnormal_labs", "abnormal_labs_conduct", "intervention_prevention_reason_yn", "specify_intervention_prevention_reasons", "intervention_delivered_yn", "explain_intervention_not_delivered", "date_delivery", "explained_dosage", "intervention_comprehension_yn", "intervention_comprehension_notes", "expected_start_date", "expected_start_date_capsules", "start_after_lab", "additional_notes_actions_yn", "medical_conduct", "medical_complete"),
    I32_followup_R = c("record_id","event_name", "repeat_instrument", "repeat_instance", "weekly_followup_timestamp", "is_data_entry_form_yn", "interviewer_followup", "first_contact_attempt_datetime", "first_contact_successful_yn", "second_contact_attempt_datetime", "second_contact_successful_yn", "third_contact_attempt_datetime", "third_contact_successful_yn", "fourth_contact_attempt_datetime", "fourth_contact_successful_yn", "fifth_contact_attempt_datetime", "fifth_contact_successful_yn", "sixth_contact_attempt_datetime", "sixth_contact_successful_yn", "seventh_contact_attempt_datetime", "seventh_contact_successful_yn", "eighth_contact_attempt_datetime", "eighth_contact_successful_yn", "ninth_contact_attempt_datetime", "ninth_contact_successful_yn", "tenth_contact_attempt_datetime", "tenth_contact_successful_yn", "symptoms_since_treatment", "symptoms_description", "contact_info_start_days", "onset_days", "contact_info_severity", "severity_scale", "symptoms_resolved", "contact_info_duration_days", "resolved_days", "capsules_compliance", "missed_dose_last_week", "reason_not_compliant", "questions_yn", "question_notes", "questions_resolved_yn", "pdf_survey_upload", "followup_complete"),
    I33_conclusion = c("record_id","event_name", "completed_intervention", "conclusion_date", "non_completion_reason", "conclusion_info_view_yn", "ethical_additional_measures_details", "ethical_additional_measures_yn", "ethical_additional_measures_info", "conclusion_complete"),
    I34_annex_R = c("record_id","event_name", "repeat_instrument", "repeat_instance", "attachment_insertion_date", "attachment_type", "attachment_file_date", "attachment_other_specify", "attachment_file_upload", "attachment_notes", "attachment_complete_yn")
)
```
### (?) Saving list to text file
```{r, eval = FALSE}
writeLines(
    capture.output(
        print(instruments)
        ), 
    "/Users/gustavosplmoura/Library/Mobile Documents/com~apple~CloudDocs/Medicina/Biblioteca/Research/Data Science/Data Science/PROJECTS/DVEP/3_Output/4_Instruments.txt")
```

## Create individual tibbles (one for each instrument)
```{r}
# Pacote necessrio para manipulao de dados
library(dplyr)

# Estas variveis no devem ser consideradas na verificao de dados faltantes (NA) porque sempre contm informaes.
always_present_vars <- c("record_id", "event_name", "repeat_instrument", "repeat_instance")

# Criar uma lista de tibbles separadas para cada instrumento, excluindo linhas que contenham apenas NAs
instrument_tibbles <- lapply(names(instruments), function(instr_name) {
  
  # `instr_name`  o nome atual do instrumento sendo processado, por exemplo, "elegibility".
  
  # Seleciona a lista de variveis associadas ao instrumento atual
  selected_vars <- instruments[[instr_name]]
  
  # Remove as variveis da lista que esto em `always_present_vars` (que sempre possuem valores).
  # `setdiff()` retorna apenas as variveis exclusivas (aquelas que no esto em `always_present_vars`).
  vars_to_check <- setdiff(selected_vars, always_present_vars)
  
  # Filtrar os dados para o instrumento atual
  filtered_tibble <- data  |> 
    # Seleciona as colunas correspondentes s variveis do instrumento atual
    select(all_of(selected_vars))  |> 
    
    # Filtra as linhas onde pelo menos uma das variveis relevantes (no constantes) no  NA
    filter(
      rowSums(
        !is.na(
          select(cur_data(), all_of(vars_to_check)) # Seleciona apenas as colunas relevantes para a verificao de NA
        )
      ) > 0 # `rowSums()` conta quantas colunas no so NA por linha. Mantemos linhas onde este total  maior que 0.
    )
  
  # Retorna a tibble filtrada com as variveis e linhas relevantes para o instrumento atual
  return(filtered_tibble)
})

# Nomeia os elementos da lista `instrument_tibbles` com os nomes correspondentes dos instrumentos.
# Por exemplo, o primeiro elemento da lista ser nomeado "redcap", o segundo "elegibility", e assim por diante.
names(instrument_tibbles) <- names(instruments)

# Opcional: Salvar cada tibble no ambiente global como um objeto independente.
# `list2env()` converte cada elemento da lista `instrument_tibbles` em um objeto no ambiente global,
# com o nome correspondente ao instrumento.
list2env(instrument_tibbles, .GlobalEnv)

# Resultado:
# - Cada tibble criada contm apenas as variveis e linhas relevantes para o instrumento atual.
# - As linhas onde todas as variveis relevantes so NA foram excludas.

```

## Corrigindo a lgica de excluso de linhas com apenas NAs
```{r}
I20_allocation  <- I20_allocation  |> 
    filter(
        event_name == "eleg_arm_1"
    )
```

## Super tibble
```{r}
library(dplyr)
library(tidyr)

# Define always present variables
always_present_vars <- c("record_id", "event_name", "repeat_instrument", "repeat_instance")

# Create a nested tibble containing all instruments
super_tibble <- tibble(
  instrument_name = names(instruments),  # Name of each instrument
  data = lapply(names(instruments), function(instr_name) {
    # Select variables for the instrument
    selected_vars <- instruments[[instr_name]]
    vars_to_check <- setdiff(selected_vars, always_present_vars)
    
    # Filter the data for the instrument
    data |>
      select(all_of(selected_vars)) |>
      filter(rowSums(!is.na(select(., all_of(vars_to_check)))) > 0)
  })
) |>
  unnest(data)  # Unnesting for easier visualization

# Print structure of the super tibble
print(super_tibble)

```

## CREATING DATAFRAME
```{r}
library(dplyr)
# Non-repeating instruments

# Step 1: Filter relevant variables for each visit from `data_codebook`
eleg_vars <- data_codebook  |> 
  filter(eleg_arm_1 == 1 & included == 1 & repeating_instrument == "NA")  |>  # Variables for Visit 1
  pull(variable_recoded)

visit_1_vars <- data_codebook  |> 
  filter((eleg_arm_1 == 1 | V1 == 1) & included == 1)  |>  # Variables for Visit 1
  pull(variable_recoded)

# Step 2: Subset the `data` frame for each visit
visit_1_data <- data 
  select(record_id, all_of(visit_1_vars)) |>
  mutate(visit = 1) # Add visit identifier


visit_2_vars <- data_codebook |>
  filter(V2 == 1 & included == 1) |> # Variables for Visit 2
  pull(variable_recoded)

visit_3_vars <- data_codebook |>
  filter(V3 == 1 & included == 1) |> # Variables for Visit 3
  pull(variable_recoded)



visit_2_data <- data |>
  select(record_id, all_of(visit_2_vars)) |>
  mutate(visit = 2) # Add visit identifier

visit_3_data <- data |>
  select(record_id, all_of(visit_3_vars)) |>
  mutate(visit = 3) # Add visit identifier

# Step 3: Combine all visits into a single tibble
final_tibble <- bind_rows(visit_1_data, visit_2_data, visit_3_data)

# View the final tibble
print(final_tibble)

```

### Selecting relevant variables from nonrepeating instruments
```{r}
## Eleg_arm_1
eleg_vars <- data_codebook  |> 
  filter(eleg_arm_1 == 1 & included == 1 & repeating_instrument == 0)  |>
  pull(variable_recoded)

  # > eleg_vars
  #  [1] "record_id"              "event_name"             "repeat_instrument"     
  #  [4] "repeat_instance"        "date_birth"             "age"                   
  #  [7] "sex"                    "menopause"              "preserved_hormone"     
  # [10] "allocation_group"       "completed_intervention" "conclusion_date"       
  # [13] "non_completion_reason" 

## 1visit_arm_1
v1_vars <- data_codebook  |> 
  filter(V1 == 1 & included == 1 & repeating_instrument == 0)  |>
  pull(variable_recoded)

  # > v1_vars
  #  [1] "record_id"                  "event_name"                 "repeat_instrument"         
  #  [4] "repeat_instance"            "race"                       "marital_status"            
  #  [7] "education_years"            "employment_status"          "household_size"            
  # [10] "income_level"               "whoqol_score_overall"       "whoqol_score_health"       
  # [13] "whoqol_score_physical"      "whoqol_score_psychological" "whoqol_score_social"       
  # [16] "whoqol_score_environment"   "dass_score_depression"      "dass_score_anxiety"        
  # [19] "dass_score_stress"          "ecap_score"                 "height"                    
  # [22] "weight"                     "abdomen"                    "arm"                       
  # [25] "bmi"                        "weight_maxideal"            "weight_adjusted"           
  # [28] "kcal_kg20"                  "kcal_kg22"                  "diet_energy"               
  # [31] "weight_loss_kg"             "weight_loss_percent"        "abdomen_loss_kg"           
  # [34] "abdomen_loss_percent"       "bmi_loss_absolute"          "bmi_loss_percent"          
  # [37] "systolic_mean"              "systolic_stdev"             "diastolic_mean"            
  # [40] "diastolic_stdev"            "mean_bp_mean"               "mean_bp_stdev"             
  # [43] "smoked_24h"                 "exercised_24h"              "alcohol_24h"               
  # [46] "light_clothes"              "time_fasted_food"           "time_fasted_liquid"        
  # [49] "resistance"                 "reactance"                  "phase_angle"               
  # [52] "bia_complete"               "handgrip_right_mean"        "handgrip_right_stdev"      
  # [55] "handgrip_left_mean"         "handgrip_left_stdev"        "frequency_bowel"           
  # [58] "frequency_solid_stool"      "frequency_diarrhea"         "contipation_yn"            
  # [61] "frequency_laxative"         "urinary_frequency"          "water_consumption"         
  # [64] "hair_loss"                  "evs_days"                   "evs_time"                  
  # [67] "evs_score"                  "alcohol_frequency"          "years_drinks_alcohol"      
  # [70] "alcohol_dose"               "alcohol_significant"        "smoke_history"             
  # [73] "age_started_smoking"        "smoked_years"               "daily_cigarettes"          
  # [76] "pack_years"                 "age_quit_smoking"           "total_energy"              
  # [79] "carbs_kcal"                 "protein_kcal"               "fat_kcal"                  
  # [82] "evaluation_date"            "diuretic_use"               "diuretic_dose_change"      
  # [85] "menses"                     "regular_cycle"              "cycle_duration"            
  # [88] "last_menses"                "cycle_phase"                "drugs_dose_change"         
  # [91] "drugs_dose_change_notes"    "abnormal_labs"              "abnormal_labs_conduct"     
  # [94] "date_delivery"              "explained_dosage"           "expected_start_date"       
  # [97] "start_after_lab"            "medical_conduct"           

## 2visit_arm_1
v2_vars <- data_codebook  |> 
  filter(V2 == 1 & included == 1 & repeating_instrument == 0)  |>
  pull(variable_recoded)
  
  # >v2_vars
  #  [1] "record_id"               "event_name"              "repeat_instrument"      
  #  [4] "repeat_instance"         "height"                  "weight"                 
  #  [7] "abdomen"                 "arm"                     "bmi"                    
  # [10] "weight_maxideal"         "weight_adjusted"         "kcal_kg20"              
  # [13] "kcal_kg22"               "diet_energy"             "weight_loss_kg"         
  # [16] "weight_loss_percent"     "abdomen_loss_kg"         "abdomen_loss_percent"   
  # [19] "bmi_loss_absolute"       "bmi_loss_percent"        "systolic_mean"          
  # [22] "systolic_stdev"          "diastolic_mean"          "diastolic_stdev"        
  # [25] "mean_bp_mean"            "mean_bp_stdev"           "frequency_bowel"        
  # [28] "frequency_solid_stool"   "frequency_diarrhea"      "contipation_yn"         
  # [31] "frequency_laxative"      "urinary_frequency"       "water_consumption"      
  # [34] "hair_loss"               "evs_days"                "evs_time"               
  # [37] "evs_score"               "evaluation_date"         "diuretic_use"           
  # [40] "diuretic_dose_change"    "menses"                  "regular_cycle"          
  # [43] "cycle_duration"          "last_menses"             "cycle_phase"            
  # [46] "drugs_dose_change"       "drugs_dose_change_notes" "abnormal_labs"          
  # [49] "abnormal_labs_conduct"   "date_delivery"           "explained_dosage"       
  # [52] "expected_start_date"     "start_after_lab"         "medical_conduct" 
  
## 3visit_arm_1
v3_vars <- data_codebook  |> 
  filter(V3 == 1 & included == 1 & repeating_instrument == 0)  |>
  pull(variable_recoded)

  # v3_vars
  #  [1] "record_id"                  "event_name"                 "repeat_instrument"         
  #  [4] "repeat_instance"            "whoqol_score_overall"       "whoqol_score_health"       
  #  [7] "whoqol_score_physical"      "whoqol_score_psychological" "whoqol_score_social"       
  # [10] "whoqol_score_environment"   "dass_score_depression"      "dass_score_anxiety"        
  # [13] "dass_score_stress"          "ecap_score"                 "height"                    
  # [16] "weight"                     "abdomen"                    "arm"                       
  # [19] "bmi"                        "weight_maxideal"            "weight_adjusted"           
  # [22] "kcal_kg20"                  "kcal_kg22"                  "diet_energy"               
  # [25] "weight_loss_kg"             "weight_loss_percent"        "abdomen_loss_kg"           
  # [28] "abdomen_loss_percent"       "bmi_loss_absolute"          "bmi_loss_percent"          
  # [31] "systolic_mean"              "systolic_stdev"             "diastolic_mean"            
  # [34] "diastolic_stdev"            "mean_bp_mean"               "mean_bp_stdev"             
  # [37] "smoked_24h"                 "exercised_24h"              "alcohol_24h"               
  # [40] "light_clothes"              "time_fasted_food"           "time_fasted_liquid"        
  # [43] "resistance"                 "reactance"                  "phase_angle"               
  # [46] "bia_complete"               "handgrip_right_mean"        "handgrip_right_stdev"      
  # [49] "handgrip_left_mean"         "handgrip_left_stdev"        "frequency_bowel"           
  # [52] "frequency_solid_stool"      "frequency_diarrhea"         "contipation_yn"            
  # [55] "frequency_laxative"         "urinary_frequency"          "water_consumption"         
  # [58] "hair_loss"                  "evs_days"                   "evs_time"                  
  # [61] "evs_score"                  "alcohol_frequency"          "years_drinks_alcohol"      
  # [64] "alcohol_dose"               "alcohol_significant"        "smoke_history"             
  # [67] "age_started_smoking"        "smoked_years"               "daily_cigarettes"          
  # [70] "pack_years"                 "age_quit_smoking"           "total_energy"              
  # [73] "carbs_kcal"                 "protein_kcal"               "fat_kcal"                  
  # [76] "evaluation_date"            "diuretic_use"               "diuretic_dose_change"      
  # [79] "menses"                     "regular_cycle"              "cycle_duration"            
  # [82] "last_menses"                "cycle_phase"                "drugs_dose_change"         
  # [85] "drugs_dose_change_notes"    "abnormal_labs"              "abnormal_labs_conduct"     
  # [88] "date_delivery"              "explained_dosage"           "expected_start_date"       
  # [91] "start_after_lab"            "medical_conduct"           

```

### Creating dataframes

#### 1 visit (1st try)
```{r}
data_eleg <- data  |> 
  filter(event_name == "eleg_arm_1" & is.na(repeat_instrument)) |> 
  select(setdiff(eleg_vars, c("event_name", "repeat_instrument", "repeat_instance")))  |> 
  mutate(visit = 1) |> 
  relocate(record_id, visit, allocation_group, age, sex)

data_v1 <- data  |> 
  filter(event_name == "1visit_arm_1" & is.na(repeat_instrument)) |> 
  select(setdiff(v1_vars, c("event_name", "repeat_instrument", "repeat_instance")))

V1  <- data_eleg  |> 
  left_join(data_v1)

```

#### 1 visit (2nd try)
```{r}
V1 <- data  |> 
  filter(event_name == "eleg_arm_1" & is.na(repeat_instrument)) |> 
  select(setdiff(eleg_vars, c("event_name", "repeat_instrument", "repeat_instance")))  |> 
  mutate(visit = 1) |> 
  relocate(record_id, visit, allocation_group, age, sex)  |> 
  left_join(
    data  |>
      filter(event_name == "1visit_arm_1" & is.na(repeat_instrument)) |> 
      select(setdiff(v1_vars, c("event_name", "repeat_instrument", "repeat_instance"))),
    by = join_by(record_id) # or simply: by = "record_id"
  )
```

#### 2 & 3 visit
```{r}
V2 <- data  |> 
  filter(event_name == "2visit_arm_1" & is.na(repeat_instrument)) |> 
  select(setdiff(v2_vars, c("event_name", "repeat_instrument", "repeat_instance")))  |> 
  mutate(visit = 2) |> 
  relocate(visit, .after = 1)  

V3 <- data  |> 
  filter(event_name == "3visit_arm_1" & is.na(repeat_instrument)) |> 
  select(setdiff(v3_vars, c("event_name", "repeat_instrument", "repeat_instance")))  |> 
  mutate(visit = 3) |> 
  relocate(visit, .after = 1)  

```

#### Merge
```{r}
data_filtered  <- bind_rows(V1, V2, V3)  |> 
  arrange(record_id, visit) |>
  group_by(record_id) |>
  fill(
    allocation_group, age, sex, date_birth, menopause, preserved_hormone, completed_intervention, conclusion_date, non_completion_reason, race, marital_status, education_years, employment_status, household_size, income_level,
  .direction = "down") |>
  ungroup()
```

#### Dissonant variables
```{r}
vars_diff  <- tibble(
  V1 = c("record_id", "visit", "allocation_group", "age", "sex", "date_birth", "menopause", "preserved_hormone", "completed_intervention", "conclusion_date", "non_completion_reason", "race", "marital_status", "education_years", "employment_status", "household_size", "income_level", "whoqol_score_overall", "whoqol_score_health", "whoqol_score_physical", "whoqol_score_psychological", "whoqol_score_social", "whoqol_score_environment", "dass_score_depression", "dass_score_anxiety", "dass_score_stress", "ecap_score", "height", "weight", "abdomen", "arm", "bmi", "weight_maxideal", "weight_adjusted", "kcal_kg20", "kcal_kg22", "diet_energy", "weight_loss_kg", "weight_loss_percent", "abdomen_loss_kg", "abdomen_loss_percent", "bmi_loss_absolute", "bmi_loss_percent", "systolic_mean", "systolic_stdev", "diastolic_mean", "diastolic_stdev", "mean_bp_mean", "mean_bp_stdev", "smoked_24h", "exercised_24h", "alcohol_24h", "light_clothes", "time_fasted_food", "time_fasted_liquid", "resistance", "reactance", "phase_angle", "bia_complete", "handgrip_right_mean", "handgrip_right_stdev", "handgrip_left_mean", "handgrip_left_stdev", "frequency_bowel", "frequency_solid_stool", "frequency_diarrhea", "contipation_yn", "frequency_laxative", "urinary_frequency", "water_consumption", "hair_loss", "evs_days", "evs_time", "evs_score", "alcohol_frequency", "years_drinks_alcohol", "alcohol_dose", "alcohol_significant", "smoke_history", "age_started_smoking", "smoked_years", "daily_cigarettes", "pack_years", "age_quit_smoking", "total_energy", "carbs_kcal", "protein_kcal", "fat_kcal", "evaluation_date", "diuretic_use", "diuretic_dose_change", "menses", "regular_cycle", "cycle_duration", "last_menses", "cycle_phase", "drugs_dose_change", "drugs_dose_change_notes", "abnormal_labs", "abnormal_labs_conduct", "date_delivery", "explained_dosage", "expected_start_date", "start_after_lab", "medical_conduct"),
  V2 = c("record_id", "visit", "NA", "NA", "NA", "NA", "NA", "NA", "NA", "NA", "NA", "NA", "NA", "NA", "NA", "NA", "NA", "NA", "NA", "NA", "NA", "NA", "NA", "NA", "NA", "NA", "NA", "height", "weight", "abdomen", "arm", "bmi", "weight_maxideal", "weight_adjusted", "kcal_kg20", "kcal_kg22", "diet_energy", "weight_loss_kg", "weight_loss_percent", "abdomen_loss_kg", "abdomen_loss_percent", "bmi_loss_absolute", "bmi_loss_percent", "systolic_mean", "systolic_stdev", "diastolic_mean", "diastolic_stdev", "mean_bp_mean", "mean_bp_stdev", "NA", "NA", "NA", "NA", "NA", "NA", "NA", "NA", "NA", "NA", "NA", "NA", "NA", "NA", "frequency_bowel", "frequency_solid_stool", "frequency_diarrhea", "contipation_yn", "frequency_laxative", "urinary_frequency", "water_consumption", "hair_loss", "evs_days", "evs_time", "evs_score", "NA", "NA", "NA", "NA", "NA", "NA", "NA", "NA", "NA", "NA", "NA", "NA", "NA", "NA", "evaluation_date", "diuretic_use", "diuretic_dose_change", "menses", "regular_cycle", "cycle_duration", "last_menses", "cycle_phase", "drugs_dose_change", "drugs_dose_change_notes", "abnormal_labs", "abnormal_labs_conduct", "date_delivery", "explained_dosage", "expected_start_date", "start_after_lab", "medical_conduct"),
  V3 = c("record_id", "visit", "NA", "NA", "NA", "NA", "NA", "NA", "NA", "NA", "NA", "NA", "NA", "NA", "NA", "NA", "NA", "whoqol_score_overall", "whoqol_score_health", "whoqol_score_physical", "whoqol_score_psychological", "whoqol_score_social", "whoqol_score_environment", "dass_score_depression", "dass_score_anxiety", "dass_score_stress", "ecap_score", "height", "weight", "abdomen", "arm", "bmi", "weight_maxideal", "weight_adjusted", "kcal_kg20", "kcal_kg22", "diet_energy", "weight_loss_kg", "weight_loss_percent", "abdomen_loss_kg", "abdomen_loss_percent", "bmi_loss_absolute", "bmi_loss_percent", "systolic_mean", "systolic_stdev", "diastolic_mean", "diastolic_stdev", "mean_bp_mean", "mean_bp_stdev", "smoked_24h", "exercised_24h", "alcohol_24h", "light_clothes", "time_fasted_food", "time_fasted_liquid", "resistance", "reactance", "phase_angle", "bia_complete", "handgrip_right_mean", "handgrip_right_stdev", "handgrip_left_mean", "handgrip_left_stdev", "frequency_bowel", "frequency_solid_stool", "frequency_diarrhea", "contipation_yn", "frequency_laxative", "urinary_frequency", "water_consumption", "hair_loss", "evs_days", "evs_time", "evs_score", "alcohol_frequency", "years_drinks_alcohol", "alcohol_dose", "alcohol_significant", "smoke_history", "age_started_smoking", "smoked_years", "daily_cigarettes", "pack_years", "age_quit_smoking", "total_energy", "carbs_kcal", "protein_kcal", "fat_kcal", "evaluation_date", "diuretic_use", "diuretic_dose_change", "menses", "regular_cycle", "cycle_duration", "last_menses", "cycle_phase", "drugs_dose_change", "drugs_dose_change_notes", "abnormal_labs", "abnormal_labs_conduct", "date_delivery", "explained_dosage", "expected_start_date", "start_after_lab", "medical_conduct") 
)
```

### Assign labels to data_filtered
```{r}
# Load Hmisc for `label()` function
library(Hmisc)

# Get the variable names from the data_filtered dataframe
variable_names <- colnames(data_filtered)

# Loop over each variable name in data_filtered
for (variable_name in variable_names) {
    # Check if the variable name exists in the data_codebook$variable_recoded
    if (variable_name %in% data_codebook$variable_recoded) {
        # Get the corresponding label for the variable
        variable_label <- data_codebook$label_pt[data_codebook$variable_recoded == variable_name]
        
        # Assign the label to the variable in data_filtered
        label(data_filtered[[variable_name]]) <- variable_label
    }
}

# Remove intermediate variables
rm(variable_name, variable_label)
```

#### Save data_filtered as csv
```{r}
write_csv(data_filtered, "/Users/gustavosplmoura/Library/Mobile Documents/com~apple~CloudDocs/Medicina/Biblioteca/Research/Data Science/Data Science/PROJECTS/DVEP/data_filtered.csv", na = "")
```

# Adding labels to raw cell values
To apply the labels only to the variables present in colnames(data_filtered), you can filter the data_codebook to include only those variables.
Steps for Selected Variables
1. Filter data_codebook for variables present in colnames(data_filtered).
2. Parse the choices column for these variables only.
3. Create lookup tables for the selected variables.
4. Apply the mappings to replace raw values with their corresponding labels in data_filtered.

```{r}
library(dplyr)
library(tidyr)
library(stringr)
library(purrr)

# 1. Filter `data_codebook` for variables in `data_filtered` and with `col_types` == "f"
selected_codebook <- data_codebook  |> 
  filter(
    variable_recoded %in% colnames(data_filtered) &  # Variables in data_filtered
      col_types == "f"                              # Only those with col_types == "f"
  )

# 2. Parse the `choices` column
parsed_choices <- selected_codebook |>
  rowwise() |>
  mutate(
    parsed = list(
      str_split(choices, " \\| ") |>  # Split the choices by "|"
        unlist() |>
        map(~ str_split_fixed(.x, ", ", 2) |>  # Split by ", " into two columns
          as_tibble()  |> 
          setNames(c("raw_value", "label"))    # Explicitly name columns
        ) |>
        bind_rows()  # Combine into a tibble
    )
  ) |>
  select(variable_recoded, parsed) |>
  unnest(parsed)  # Expand the parsed choices into rows


# 3. Create lookup tables for selected variables
lookup_tables <- parsed_choices %>%
  group_by(variable_recoded) %>%
  summarize(
    lookup = list(setNames(label, raw_value)), .groups = "drop"
  ) %>%
  deframe()

# 4. Replace raw values with labels for selected variables

data_filtered_labels <- data_filtered
for (column_name in names(lookup_tables)) { # Iterate through each column in lookup_tables
  if (column_name %in% colnames(data_filtered_labels)) { # Ensure the column exists in data_filtered
    data_filtered_labels[[column_name]] <- recode( # Apply recode using the lookup table for this column
      data_filtered_labels[[column_name]],
      !!!lookup_tables[[column_name]]
    )
  }
}
```